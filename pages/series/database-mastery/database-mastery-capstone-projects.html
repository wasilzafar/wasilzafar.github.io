<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Database Mastery Part 15: Capstone Projects | Wasil Zafar</title>
    <meta name="description" content="Apply your database mastery with portfolio-ready capstone projects. Build an e-commerce system, real-time analytics pipeline, multi-tenant SaaS platform, and global distributed database—complete implementations for your portfolio.">
    <meta name="keywords" content="database projects, capstone project, e-commerce database, analytics pipeline, multi-tenant database, distributed database, portfolio project, database design project">
    <meta name="author" content="Wasil Zafar">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Complete Database Mastery Part 15: Capstone Projects">
    <meta property="og:description" content="Apply your database mastery with portfolio-ready capstone projects. Build complete database implementations for your portfolio.">
    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2026-01-31">
    <meta property="article:author" content="Wasil Zafar">
    <meta property="article:section" content="Technology">
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="../../../images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../images/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="../../../images/favicon_io/site.webmanifest">

    <!-- Google Consent Mode v2 -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied',
            'region': ['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE']
        });
        
        gtag('consent', 'default', {
            'ad_storage': 'granted',
            'ad_user_data': 'granted',
            'ad_personalization': 'granted',
            'analytics_storage': 'granted'
        });
        
        gtag('set', 'url_passthrough', true);
    </script>

    <!-- Google Tag Manager -->
    <script>
        (function(w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-PBS8M2JR');
    </script>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet" />

    <!-- Custom Styles -->
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" />
    
    <!-- Prism.js Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" id="prism-theme" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" id="prism-default" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-dark.min.css" id="prism-dark" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-twilight.min.css" id="prism-twilight" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" id="prism-okaidia" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-solarizedlight.min.css" id="prism-solarizedlight" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" />
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBS8M2JR" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>

    <!-- GDPR Cookie Consent Banner -->
    <div id="cookieBanner" class="light display-bottom" style="display: none;">
        <div id="closeIcon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                <path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"></path>
            </svg>
        </div>
        
        <div class="content-wrap">
            <div class="msg-wrap">
                <div class="title-wrap">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="20" height="20">
                        <path fill="#3B9797" d="M510.52 255.82c-69.97-.85-126.47-57.69-126.47-127.86-70.17 0-127-56.49-127.86-126.45-27.26-4.14-55.13.3-79.72 12.82l-69.13 35.22a132.221 132.221 0 0 0-57.79 57.81l-35.1 68.88a132.645 132.645 0 0 0-12.82 80.95l12.08 76.27a132.521 132.521 0 0 0 37.16 70.37l54.64 54.64a132.036 132.036 0 0 0 70.37 37.16l76.27 12.15c27.51 4.36 55.7-.11 80.95-12.8l68.88-35.08a132.166 132.166 0 0 0 57.79-57.81l35.1-68.88c12.56-24.64 17.01-52.58 12.91-79.91zM176 368c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm32-160c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm160 128c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z"></path>
                    </svg>
                    <h4 style="margin: 0; font-size: 18px; color: var(--color-navy); font-weight: 700;">Cookie Consent</h4>
                </div>
                <p style="font-size: 14px; line-height: 1.6; color: var(--color-navy); margin-bottom: 15px;">
                    We use cookies to enhance your browsing experience, serve personalized content, and analyze our traffic. 
                    By clicking "Accept All", you consent to our use of cookies. See our 
                    <a href="/privacy-policy.html" style="color: var(--color-teal); border-bottom: 1px dotted var(--color-teal);">Privacy Policy</a> 
                    for more information.
                </p>
                
                <div id="cookieSettings" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="14" height="14">
                        <path fill="currentColor" d="M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"></path>
                    </svg>
                    <span style="margin-left: 5px; font-size: 12px; font-weight: 600; color: var(--color-navy);">Customize Settings</span>
                </div>
                
                <div id="cookieTypes" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(59, 151, 151, 0.2);">
                    <h5 style="font-size: 12px; font-weight: 700; color: var(--color-navy); margin-bottom: 10px; text-transform: uppercase;">Cookie Preferences</h5>
                    
                    <div style="margin-bottom: 12px;">
                        <label style="display: flex; align-items: start; cursor: pointer;">
                            <input type="checkbox" checked disabled style="margin-top: 2px; margin-right: 8px; cursor: not-allowed;">
                            <div>
                                <strong style="font-size: 13px; color: var(--color-navy); display: block; margin-bottom: 2px;">Essential Cookies (Required)</strong>
                                <span style="font-size: 12px; color: #666;">Necessary for the website to function properly.</span>
                            </div>
                        </label>
                    </div>
                    
                    <div style="margin-bottom: 12px;">
                        <label style="display: flex; align-items: start; cursor: pointer;">
                            <input type="checkbox" id="analyticsCookies" checked style="margin-top: 2px; margin-right: 8px;">
                            <div>
                                <strong style="font-size: 13px; color: var(--color-navy); display: block; margin-bottom: 2px;">Analytics Cookies</strong>
                                <span style="font-size: 12px; color: #666;">Help us understand how you interact with the website.</span>
                            </div>
                        </label>
                    </div>
                    
                    <div style="margin-bottom: 12px;">
                        <label style="display: flex; align-items: start; cursor: pointer;">
                            <input type="checkbox" id="marketingCookies" style="margin-top: 2px; margin-right: 8px;">
                            <div>
                                <strong style="font-size: 13px; color: var(--color-navy); display: block; margin-bottom: 2px;">Marketing Cookies</strong>
                                <span style="font-size: 12px; color: #666;">Used to deliver relevant advertisements.</span>
                            </div>
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="btn-wrap">
                <button id="cookieAccept" style="background: var(--color-teal); color: white; font-weight: 600;">Accept All</button>
                <button id="cookieReject" style="background: transparent; color: var(--color-navy); border: 2px solid var(--color-teal); font-weight: 600;">Reject All</button>
                <button id="cookieSave" style="background: var(--color-blue); color: white; font-weight: 600; display: none;">Save Preferences</button>
            </div>
        </div>
    </div>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/">
                <span class="gradient-text">Wasil Zafar</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#skills">Skills</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#certifications">Certifications</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#interests">Interests</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="blog-hero">
        <div class="container py-5">
            <div class="blog-header">
                <a href="/pages/categories/technology.html" class="back-link"><i class="fas fa-arrow-left me-2"></i>Back to Technology</a>
                <h1 class="display-4 fw-bold mb-3">Complete Database Mastery Part 15: Capstone Projects</h1>
                <div class="blog-meta">
                    <span><i class="fas fa-calendar me-2"></i>January 31, 2026</span>
                    <span><i class="fas fa-user me-2"></i>Wasil Zafar</span>
                    <span class="reading-time"><i class="fas fa-clock me-1"></i>50 min read</span>
                    <button onclick="window.print()" class="print-btn" title="Print this article"><i class="fas fa-print"></i> Print</button>
                </div>
                <p class="lead">Apply your database mastery with portfolio-ready capstone projects. Build an e-commerce system, real-time analytics pipeline, multi-tenant SaaS platform, and global distributed database—complete implementations showcasing production-grade skills.</p>
            </div>
        </div>
    </section>

    <!-- Table of Contents Toggle Button -->
    <button class="toc-toggle-btn" onclick="openNav()" title="Table of Contents" aria-label="Open Table of Contents">
        <i class="fas fa-list"></i>
    </button>

    <!-- Side Navigation Overlay -->
    <div id="tocSidenav" class="sidenav-toc">
        <div class="toc-header">
            <h3><i class="fas fa-list me-2"></i>Table of Contents</h3>
            <button class="closebtn" onclick="closeNav()" aria-label="Close Table of Contents">&times;</button>
        </div>
        <ol>
            <li>
                <a href="#introduction" onclick="closeNav()">Introduction</a>
                <ul>
                    <li><a href="#introduction" onclick="closeNav()">Capstone Overview</a></li>
                    <li><a href="#series-nav" onclick="closeNav()">Series Navigation</a></li>
                </ul>
            </li>
            <li>
                <a href="#project-1" onclick="closeNav()">Project 1: E-Commerce Platform</a>
                <ul>
                    <li><a href="#ecommerce-requirements" onclick="closeNav()">Requirements</a></li>
                    <li><a href="#ecommerce-schema" onclick="closeNav()">Schema Design</a></li>
                    <li><a href="#ecommerce-implementation" onclick="closeNav()">Implementation</a></li>
                </ul>
            </li>
            <li>
                <a href="#project-2" onclick="closeNav()">Project 2: Real-Time Analytics</a>
                <ul>
                    <li><a href="#analytics-requirements" onclick="closeNav()">Requirements</a></li>
                    <li><a href="#analytics-architecture" onclick="closeNav()">Architecture</a></li>
                    <li><a href="#analytics-implementation" onclick="closeNav()">Implementation</a></li>
                </ul>
            </li>
            <li>
                <a href="#project-3" onclick="closeNav()">Project 3: Multi-Tenant SaaS</a>
                <ul>
                    <li><a href="#saas-requirements" onclick="closeNav()">Requirements</a></li>
                    <li><a href="#saas-tenancy" onclick="closeNav()">Tenancy Models</a></li>
                    <li><a href="#saas-implementation" onclick="closeNav()">Implementation</a></li>
                </ul>
            </li>
            <li>
                <a href="#project-4" onclick="closeNav()">Project 4: Global Distributed DB</a>
                <ul>
                    <li><a href="#distributed-requirements" onclick="closeNav()">Requirements</a></li>
                    <li><a href="#distributed-design" onclick="closeNav()">Design</a></li>
                    <li><a href="#distributed-implementation" onclick="closeNav()">Implementation</a></li>
                </ul>
            </li>
            <li><a href="#portfolio" onclick="closeNav()">Building Your Portfolio</a></li>
            <li><a href="#conclusion" onclick="closeNav()">Series Conclusion</a></li>
        </ol>
    </div>

    <!-- Overlay Backdrop -->
    <div id="tocOverlay" class="sidenav-overlay" onclick="closeNav()"></div>

    <!-- Main Content -->
    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">

                <!-- Introduction -->
                <div id="introduction" class="blog-content">
                    <h2><i class="fas fa-trophy me-2 text-teal"></i>Introduction: Capstone Overview</h2>
                    
                    <p><strong>Capstone projects</strong> are your opportunity to synthesize everything you've learned across this series. These four projects demonstrate real-world database design, implementation, and optimization skills that impress employers and clients.</p>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-sitemap me-2"></i>
                        <strong>Series Finale:</strong> This is <strong>Part 15 of 15</strong> in the Complete Database Mastery series. We're bringing together all the concepts from SQL to distributed systems into portfolio-ready implementations.
                    </div>

                    <div class="experiment-card" id="series-nav">
                        <h4><i class="fas fa-map-signs me-2"></i>Complete Series Navigation</h4>
                        <div class="meta mb-2">
                            <span class="badge bg-teal me-2">15-Part Series</span>
                            <span class="badge bg-crimson">Database Mastery</span>
                        </div>
                        <div class="content">
                            <ol>
                                <li><a href="database-mastery-sql-fundamentals.html"><strong>Part 1:</strong> SQL Fundamentals & Syntax</a> — Database basics, CRUD operations, joins, constraints</li>
                                <li><a href="database-mastery-advanced-sql.html"><strong>Part 2:</strong> Advanced SQL & Query Mastery</a> — CTEs, window functions, stored procedures</li>
                                <li><a href="database-mastery-postgresql.html"><strong>Part 3:</strong> PostgreSQL Deep Dive</a> — Advanced types, indexing, extensions, tuning</li>
                                <li><a href="database-mastery-mysql-mariadb.html"><strong>Part 4:</strong> MySQL & MariaDB</a> — Storage engines, replication, optimization</li>
                                <li><a href="database-mastery-transactions-concurrency.html"><strong>Part 5:</strong> Transactions & Concurrency</a> — ACID, isolation levels, locking, MVCC</li>
                                <li><a href="database-mastery-query-optimization.html"><strong>Part 6:</strong> Query Optimization & Indexing</a> — EXPLAIN plans, index design, performance</li>
                                <li><a href="database-mastery-data-modeling.html"><strong>Part 7:</strong> Data Modeling & Normalization</a> — ERDs, normal forms, schema design</li>
                                <li><a href="database-mastery-mongodb-nosql.html"><strong>Part 8:</strong> MongoDB & Document Databases</a> — NoSQL, aggregation, sharding</li>
                                <li><a href="database-mastery-redis-caching.html"><strong>Part 9:</strong> Redis & Caching Strategies</a> — Data structures, caching patterns, pub/sub</li>
                                <li><a href="database-mastery-administration-migrations.html"><strong>Part 10:</strong> Database Administration & Migrations</a> — Backup, versioning, maintenance</li>
                                <li><a href="database-mastery-scaling-distributed.html"><strong>Part 11:</strong> Scaling & Distributed Systems</a> — Replication, sharding, CAP theorem</li>
                                <li><a href="database-mastery-cloud-databases.html"><strong>Part 12:</strong> Cloud Databases & Managed Services</a> — AWS, Azure, GCP database offerings</li>
                                <li><a href="database-mastery-security-governance.html"><strong>Part 13:</strong> Database Security & Governance</a> — Encryption, access control, compliance</li>
                                <li><a href="database-mastery-warehousing-analytics.html"><strong>Part 14:</strong> Data Warehousing & Analytics</a> — OLAP, star schemas, columnar DBs</li>
                                <li><strong>Part 15: Capstone Projects (This Guide)</strong> — Portfolio-ready database implementations</li>
                            </ol>
                        </div>
                    </div>

                    <div class="experiment-card">
                        <h4><i class="fas fa-tasks me-2"></i>Four Capstone Projects</h4>
                        <div class="content">
                            <table class="table table-bordered">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Project</th>
                                        <th>Skills Demonstrated</th>
                                        <th>Difficulty</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>E-Commerce Platform</strong></td>
                                        <td>Data modeling, transactions, indexing</td>
                                        <td>⭐⭐⭐</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Real-Time Analytics</strong></td>
                                        <td>Redis, time-series, dashboards</td>
                                        <td>⭐⭐⭐⭐</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Multi-Tenant SaaS</strong></td>
                                        <td>Security, RLS, tenant isolation</td>
                                        <td>⭐⭐⭐⭐</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Global Distributed DB</strong></td>
                                        <td>Replication, sharding, CAP trade-offs</td>
                                        <td>⭐⭐⭐⭐⭐</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                </div>

                <!-- Project 1: E-Commerce -->
                <div id="project-1" class="blog-content mt-5">
                    <h2><i class="fas fa-shopping-cart me-2 text-teal"></i>Project 1: E-Commerce Platform Database</h2>
                    
                    <h3 id="ecommerce-requirements">Requirements</h3>
                    
<pre><code class="language-plaintext">E-Commerce Database Requirements:

Functional:
- User registration and authentication
- Product catalog with categories and variants
- Shopping cart and order management
- Inventory tracking
- Reviews and ratings
- Payment processing records

Non-Functional:
- Sub-100ms product queries
- Handle 10,000+ concurrent users
- 99.9% uptime
- PCI-DSS compliance for payment data
</code></pre>

                    <h3 id="ecommerce-schema">Schema Design</h3>
                    
<pre><code class="language-sql">-- Users & Authentication
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    first_name VARCHAR(100),
    last_name VARCHAR(100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE addresses (
    id SERIAL PRIMARY KEY,
    user_id INT REFERENCES users(id),
    address_type VARCHAR(20),  -- 'shipping', 'billing'
    street_line1 VARCHAR(255),
    street_line2 VARCHAR(255),
    city VARCHAR(100),
    state VARCHAR(100),
    postal_code VARCHAR(20),
    country VARCHAR(3),
    is_default BOOLEAN DEFAULT false
);

-- Product Catalog
CREATE TABLE categories (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    parent_id INT REFERENCES categories(id),
    slug VARCHAR(100) UNIQUE,
    path LTREE  -- PostgreSQL hierarchical path
);

CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    category_id INT REFERENCES categories(id),
    base_price DECIMAL(10,2) NOT NULL,
    sku VARCHAR(50) UNIQUE,
    status VARCHAR(20) DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE product_variants (
    id SERIAL PRIMARY KEY,
    product_id INT REFERENCES products(id),
    sku VARCHAR(50) UNIQUE,
    attributes JSONB,  -- {size: 'L', color: 'blue'}
    price_adjustment DECIMAL(10,2) DEFAULT 0,
    inventory_count INT DEFAULT 0,
    low_stock_threshold INT DEFAULT 10
);

-- Orders & Transactions
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    user_id INT REFERENCES users(id),
    status VARCHAR(20) DEFAULT 'pending',
    shipping_address_id INT REFERENCES addresses(id),
    billing_address_id INT REFERENCES addresses(id),
    subtotal DECIMAL(12,2),
    tax_amount DECIMAL(10,2),
    shipping_amount DECIMAL(10,2),
    total_amount DECIMAL(12,2),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE order_items (
    id SERIAL PRIMARY KEY,
    order_id INT REFERENCES orders(id),
    variant_id INT REFERENCES product_variants(id),
    quantity INT NOT NULL,
    unit_price DECIMAL(10,2) NOT NULL,
    total_price DECIMAL(12,2) NOT NULL
);

-- Indexes for performance
CREATE INDEX idx_products_category ON products(category_id);
CREATE INDEX idx_products_status ON products(status);
CREATE INDEX idx_variants_product ON product_variants(product_id);
CREATE INDEX idx_variants_attrs ON product_variants USING GIN(attributes);
CREATE INDEX idx_orders_user ON orders(user_id);
CREATE INDEX idx_orders_status ON orders(status);
CREATE INDEX idx_orders_created ON orders(created_at DESC);
</code></pre>

                    <h3 id="ecommerce-implementation">Implementation</h3>
                    
<pre><code class="language-sql">-- Checkout transaction with inventory management
CREATE OR REPLACE FUNCTION process_checkout(
    p_user_id INT,
    p_cart_items JSONB,  -- [{variant_id, quantity}, ...]
    p_shipping_address_id INT,
    p_billing_address_id INT
) RETURNS INT AS $$
DECLARE
    v_order_id INT;
    v_item JSONB;
    v_variant RECORD;
    v_subtotal DECIMAL(12,2) := 0;
BEGIN
    -- Create order
    INSERT INTO orders (user_id, shipping_address_id, billing_address_id, status)
    VALUES (p_user_id, p_shipping_address_id, p_billing_address_id, 'processing')
    RETURNING id INTO v_order_id;

    -- Process each cart item
    FOR v_item IN SELECT * FROM jsonb_array_elements(p_cart_items)
    LOOP
        -- Lock and verify inventory
        SELECT * INTO v_variant 
        FROM product_variants 
        WHERE id = (v_item->>'variant_id')::INT
        FOR UPDATE;
        
        IF v_variant.inventory_count < (v_item->>'quantity')::INT THEN
            RAISE EXCEPTION 'Insufficient inventory for variant %', v_variant.id;
        END IF;
        
        -- Deduct inventory
        UPDATE product_variants 
        SET inventory_count = inventory_count - (v_item->>'quantity')::INT
        WHERE id = v_variant.id;
        
        -- Add order item
        INSERT INTO order_items (order_id, variant_id, quantity, unit_price, total_price)
        VALUES (
            v_order_id,
            v_variant.id,
            (v_item->>'quantity')::INT,
            v_variant.price_adjustment + (
                SELECT base_price FROM products WHERE id = v_variant.product_id
            ),
            (v_item->>'quantity')::INT * (
                v_variant.price_adjustment + (
                    SELECT base_price FROM products WHERE id = v_variant.product_id
                )
            )
        );
        
        v_subtotal := v_subtotal + (v_item->>'quantity')::INT * (
            v_variant.price_adjustment + (
                SELECT base_price FROM products WHERE id = v_variant.product_id
            )
        );
    END LOOP;

    -- Update order totals
    UPDATE orders SET 
        subtotal = v_subtotal,
        tax_amount = v_subtotal * 0.08,
        total_amount = v_subtotal * 1.08
    WHERE id = v_order_id;

    RETURN v_order_id;
END;
$$ LANGUAGE plpgsql;
</code></pre>
                </div>

                <!-- Project 2: Real-Time Analytics -->
                <div id="project-2" class="blog-content mt-5">
                    <h2><i class="fas fa-chart-line me-2 text-teal"></i>Project 2: Real-Time Analytics Pipeline</h2>
                    
                    <h3 id="analytics-requirements">Requirements</h3>
                    
<pre><code class="language-plaintext">Real-Time Analytics Requirements:

Functional:
- Track website events (page views, clicks, conversions)
- Real-time dashboards with sub-second updates
- Historical trend analysis
- Funnel analysis and cohort tracking

Non-Functional:
- Ingest 100,000+ events/second
- Dashboard queries < 100ms
- 1 year data retention
- 99.9% uptime
</code></pre>

                    <h3 id="analytics-architecture">Architecture</h3>
                    
<pre><code class="language-plaintext">Architecture:

[Web/Mobile Apps]
       ↓
[Event Collectors] → [Message Queue (Kafka)]
                            ↓
                    [Stream Processor]
                     ↓           ↓
              [Redis]      [TimescaleDB]
           (real-time)     (historical)
                ↓               ↓
            [Dashboard API Gateway]
                      ↓
              [React Dashboard]
</code></pre>

                    <h3 id="analytics-implementation">Implementation</h3>
                    
<pre><code class="language-sql">-- TimescaleDB: Hypertable for events
CREATE TABLE events (
    time TIMESTAMPTZ NOT NULL,
    session_id UUID,
    user_id INT,
    event_type VARCHAR(50),
    page_url TEXT,
    referrer TEXT,
    properties JSONB,
    device_type VARCHAR(20),
    country VARCHAR(3)
);

-- Convert to hypertable
SELECT create_hypertable('events', 'time');

-- Compression for older data
ALTER TABLE events SET (
    timescaledb.compress,
    timescaledb.compress_segmentby = 'event_type, device_type'
);

SELECT add_compression_policy('events', INTERVAL '7 days');

-- Continuous aggregates for dashboards
CREATE MATERIALIZED VIEW events_hourly
WITH (timescaledb.continuous) AS
SELECT
    time_bucket('1 hour', time) AS bucket,
    event_type,
    device_type,
    country,
    COUNT(*) as event_count,
    COUNT(DISTINCT user_id) as unique_users,
    COUNT(DISTINCT session_id) as sessions
FROM events
GROUP BY 1, 2, 3, 4
WITH NO DATA;

-- Refresh policy
SELECT add_continuous_aggregate_policy('events_hourly',
    start_offset => INTERVAL '3 hours',
    end_offset => INTERVAL '1 hour',
    schedule_interval => INTERVAL '1 hour'
);
</code></pre>

<pre><code class="language-python"># Redis for real-time counters
import redis
from datetime import datetime

r = redis.Redis(host='localhost', port=6379, decode_responses=True)

def track_event(event_type: str, user_id: int, properties: dict):
    now = datetime.utcnow()
    minute_bucket = now.strftime('%Y%m%d%H%M')
    
    pipe = r.pipeline()
    
    # Real-time counters
    pipe.incr(f'events:{event_type}:total')
    pipe.incr(f'events:{event_type}:minute:{minute_bucket}')
    pipe.expire(f'events:{event_type}:minute:{minute_bucket}', 3600)
    
    # Unique users (HyperLogLog for approximation)
    pipe.pfadd(f'events:{event_type}:users:{minute_bucket}', user_id)
    
    # Recent events stream
    pipe.xadd(f'stream:events', {'type': event_type, 'user': user_id}, maxlen=10000)
    
    pipe.execute()

def get_realtime_stats(event_type: str):
    minute_bucket = datetime.utcnow().strftime('%Y%m%d%H%M')
    
    return {
        'total': r.get(f'events:{event_type}:total'),
        'this_minute': r.get(f'events:{event_type}:minute:{minute_bucket}'),
        'unique_users': r.pfcount(f'events:{event_type}:users:{minute_bucket}')
    }
</code></pre>
                </div>

                <!-- Project 3: Multi-Tenant SaaS -->
                <div id="project-3" class="blog-content mt-5">
                    <h2><i class="fas fa-building me-2 text-teal"></i>Project 3: Multi-Tenant SaaS Platform</h2>
                    
                    <h3 id="saas-requirements">Requirements</h3>
                    
<pre><code class="language-plaintext">Multi-Tenant SaaS Requirements:

Functional:
- Multiple organizations (tenants)
- User management per organization
- Subscription tiers with feature limits
- Data isolation between tenants

Non-Functional:
- Complete data isolation (GDPR/SOC2)
- Per-tenant query performance SLAs
- Scalable to 10,000+ tenants
- Support enterprise single-tenant option
</code></pre>

                    <h3 id="saas-tenancy">Tenancy Models</h3>
                    
<pre><code class="language-plaintext">Tenancy Model Comparison:

1. Shared Schema (Row-Level Isolation)
   ✅ Efficient resource usage
   ✅ Easy to manage/deploy
   ❌ Limited isolation
   Best for: SMB SaaS, cost-sensitive

2. Schema-per-Tenant
   ✅ Better isolation
   ✅ Per-tenant backups
   ❌ Schema migration complexity
   Best for: Mid-market

3. Database-per-Tenant
   ✅ Maximum isolation
   ✅ Easy compliance
   ❌ Highest cost
   Best for: Enterprise, regulated industries
</code></pre>

                    <h3 id="saas-implementation">Implementation</h3>
                    
<pre><code class="language-sql">-- Shared Schema with Row-Level Security
CREATE TABLE tenants (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(100) NOT NULL,
    subdomain VARCHAR(50) UNIQUE,
    plan VARCHAR(20) DEFAULT 'free',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID REFERENCES tenants(id) NOT NULL,
    email VARCHAR(255) NOT NULL,
    role VARCHAR(20) DEFAULT 'member',
    UNIQUE(tenant_id, email)
);

CREATE TABLE projects (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID REFERENCES tenants(id) NOT NULL,
    name VARCHAR(100) NOT NULL,
    created_by UUID REFERENCES users(id)
);

-- Enable RLS
ALTER TABLE users ENABLE ROW LEVEL SECURITY;
ALTER TABLE projects ENABLE ROW LEVEL SECURITY;

-- Tenant isolation policies
CREATE POLICY tenant_isolation_users ON users
    USING (tenant_id = current_setting('app.current_tenant')::uuid);

CREATE POLICY tenant_isolation_projects ON projects
    USING (tenant_id = current_setting('app.current_tenant')::uuid);

-- Application sets tenant context
-- SET app.current_tenant = 'tenant-uuid-here';
</code></pre>

<pre><code class="language-python"># Python middleware for tenant context
from functools import wraps
import psycopg2

def tenant_context(f):
    @wraps(f)
    def wrapper(*args, **kwargs):
        tenant_id = get_tenant_from_request()  # From subdomain or header
        
        conn = get_db_connection()
        cursor = conn.cursor()
        
        # Set tenant context for RLS
        cursor.execute(
            "SET app.current_tenant = %s", 
            (str(tenant_id),)
        )
        
        try:
            return f(*args, **kwargs)
        finally:
            cursor.execute("RESET app.current_tenant")
            conn.commit()
    
    return wrapper

@tenant_context
def get_projects():
    cursor = get_db_cursor()
    # RLS automatically filters by tenant!
    cursor.execute("SELECT * FROM projects")
    return cursor.fetchall()
</code></pre>
                </div>

                <!-- Project 4: Global Distributed -->
                <div id="project-4" class="blog-content mt-5">
                    <h2><i class="fas fa-globe me-2 text-teal"></i>Project 4: Global Distributed Database</h2>
                    
                    <h3 id="distributed-requirements">Requirements</h3>
                    
<pre><code class="language-plaintext">Global Distributed Database Requirements:

Functional:
- Users access from NA, EU, APAC regions
- Low-latency reads in each region
- Cross-region writes with conflict resolution
- Data residency compliance (GDPR)

Non-Functional:
- Sub-50ms reads in each region
- Handle network partitions gracefully
- RPO < 1 second, RTO < 30 seconds
- Support for both strong and eventual consistency
</code></pre>

                    <h3 id="distributed-design">Design</h3>
                    
<pre><code class="language-plaintext">Multi-Region Architecture:

         [NA Region]              [EU Region]             [APAC Region]
    ┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐
    │   App Servers   │      │   App Servers   │      │   App Servers   │
    └────────┬────────┘      └────────┬────────┘      └────────┬────────┘
             │                        │                        │
    ┌────────┴────────┐      ┌────────┴────────┐      ┌────────┴────────┐
    │  CockroachDB    │◄────►│  CockroachDB    │◄────►│  CockroachDB    │
    │  (Primary)      │      │  (Replica)      │      │  (Replica)      │
    └─────────────────┘      └─────────────────┘      └─────────────────┘
    
Data Placement:
- User profiles: Pinned to user's home region
- Global data: Replicated across all regions
- EU user data: Must stay in EU (GDPR)
</code></pre>

                    <h3 id="distributed-implementation">Implementation</h3>
                    
<pre><code class="language-sql">-- CockroachDB: Multi-region table configuration
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE,
    region VARCHAR(10) NOT NULL,  -- 'na', 'eu', 'apac'
    profile JSONB,
    created_at TIMESTAMP DEFAULT NOW()
);

-- Pin data to specific regions
ALTER TABLE users CONFIGURE ZONE USING
    num_replicas = 3,
    constraints = '{"+region=na": 1, "+region=eu": 1, "+region=apac": 1}',
    lease_preferences = '[[+region=na]]';

-- Regional pinning for EU compliance
CREATE TABLE eu_user_data (
    user_id UUID REFERENCES users(id),
    sensitive_data JSONB
) LOCALITY REGIONAL BY ROW;

ALTER TABLE eu_user_data SET LOCALITY REGIONAL IN "eu-west-1";
</code></pre>

<pre><code class="language-python"># Python: Region-aware connection routing
from typing import Optional
import os

REGION_ENDPOINTS = {
    'na': 'cockroach-na.example.com:26257',
    'eu': 'cockroach-eu.example.com:26257',
    'apac': 'cockroach-apac.example.com:26257'
}

def get_regional_connection(user_region: Optional[str] = None):
    """Route to nearest region for low latency."""
    region = user_region or detect_client_region()
    endpoint = REGION_ENDPOINTS.get(region, REGION_ENDPOINTS['na'])
    
    return psycopg2.connect(
        host=endpoint.split(':')[0],
        port=26257,
        database='myapp',
        user='app_user',
        sslmode='require'
    )

def detect_client_region() -> str:
    """Detect region from request headers or IP."""
    # In practice: Use CloudFlare, AWS headers, or IP geolocation
    return os.environ.get('AWS_REGION', 'na')[:2]
</code></pre>
                </div>

                <!-- Portfolio Section -->
                <div id="portfolio" class="blog-content mt-5">
                    <h2><i class="fas fa-briefcase me-2 text-teal"></i>Building Your Portfolio</h2>
                    
                    <div class="highlight-box">
                        <i class="fas fa-lightbulb me-2"></i>
                        <strong>Portfolio Tips:</strong>
                        <ul>
                            <li><strong>GitHub Repository:</strong> Create a well-documented repo with README, schema diagrams, and setup instructions</li>
                            <li><strong>Docker Compose:</strong> Make projects easy to run locally with docker-compose</li>
                            <li><strong>Performance Benchmarks:</strong> Include load test results showing your optimization work</li>
                            <li><strong>Blog Post:</strong> Write about challenges faced and solutions implemented</li>
                            <li><strong>Live Demo:</strong> Deploy a read-only version for interviewers to explore</li>
                        </ul>
                    </div>
                    
<pre><code class="language-plaintext">Recommended Portfolio Structure:

database-capstone-projects/
├── README.md                    # Overview of all projects
├── docker-compose.yml           # Run everything locally
├── 01-ecommerce/
│   ├── README.md
│   ├── schema/
│   │   └── migrations/
│   ├── seed-data/
│   ├── queries/
│   └── benchmarks/
├── 02-realtime-analytics/
│   ├── README.md
│   ├── timescaledb/
│   ├── redis/
│   └── dashboard/
├── 03-multi-tenant-saas/
│   ├── README.md
│   ├── schema/
│   ├── rls-policies/
│   └── api-examples/
└── 04-global-distributed/
    ├── README.md
    ├── cockroachdb-config/
    ├── region-routing/
    └── chaos-testing/
</code></pre>
                </div>

                <!-- Conclusion -->
                <div id="conclusion" class="blog-content mt-5">
                    <h2><i class="fas fa-flag-checkered me-2 text-teal"></i>Series Conclusion: Your Database Mastery Journey</h2>
                    
                    <p>Congratulations on completing the <strong>Complete Database Mastery Series</strong>! You've journeyed from SQL fundamentals through advanced query optimization, explored both relational and NoSQL databases, understood distributed systems and cloud offerings, and applied security and analytics best practices.</p>

                    <div class="highlight-box highlight-navy">
                        <i class="fas fa-graduation-cap me-2"></i>
                        <strong>Series Complete!</strong> You now have the knowledge to design, implement, optimize, secure, and scale databases for any application. These capstone projects demonstrate your mastery—build them, deploy them, and showcase them in your portfolio.
                    </div>

                    <div class="experiment-card">
                        <h4><i class="fas fa-road me-2"></i>What's Next?</h4>
                        <div class="content">
                            <ul>
                                <li><strong>Build the capstone projects</strong> — Start with the e-commerce project and progress through all four</li>
                                <li><strong>Get certified</strong> — Pursue PostgreSQL, AWS Database, or MongoDB certifications</li>
                                <li><strong>Contribute to open source</strong> — Apply your skills to database-related open source projects</li>
                                <li><strong>Teach others</strong> — Solidify your knowledge by helping others learn databases</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Related Posts -->
                <div class="related-posts">
                    <h3><i class="fas fa-book me-2"></i>Review the Database Mastery Series</h3>
                    <div class="related-post-item">
                        <h5>Part 1: SQL Fundamentals & Syntax</h5>
                        <p>Start from the beginning of your database journey.</p>
                        <a href="database-mastery-sql-fundamentals.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                    <div class="related-post-item">
                        <h5>Part 7: Data Modeling & Normalization</h5>
                        <p>Review schema design principles for your projects.</p>
                        <a href="database-mastery-data-modeling.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                    <div class="related-post-item">
                        <h5>Part 11: Scaling & Distributed Systems</h5>
                        <p>Apply distributed concepts to your capstone projects.</p>
                        <a href="database-mastery-scaling-distributed.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                </div>

                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="social-media" class="bg-dark text-light py-5">
        <div class="container py-5">
            <div class="row mb-4">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h5 class="fw-bold mb-3">Let's Connect</h5>
                    <p class="text-light">
                        I'm always interested in sharing content about my interests on different topics. Read disclaimer and feel free to share further.
                    </p>
                </div>
                <div class="col-lg-6">
                    <h5 class="fw-bold mb-3">Follow Me</h5>
                    <div class="social-links d-flex gap-2 flex-wrap">
                        <a href="https://www.facebook.com/wasil.zafar/" target="_blank" class="social-icon" title="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://twitter.com/wasilzafar" target="_blank" class="social-icon" title="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.linkedin.com/in/wasilzafar" target="_blank" class="social-icon" title="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://www.youtube.com/@wasilzafar" target="_blank" class="social-icon" title="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://www.instagram.com/itswzee/" target="_blank" class="social-icon" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://in.pinterest.com/wasilz/" target="_blank" class="social-icon" title="Pinterest">
                            <i class="fab fa-pinterest-p"></i>
                        </a>
                        <a href="mailto:wasil.zafar@gmail.com" class="social-icon" title="Email">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>

            <hr class="bg-secondary">

            <div class="row mt-4">
                <div class="col-md-6">
                    <p class="small">
                        <i class="fas fa-icons me-2"></i>Icons from <a href="https://www.flaticon.com/" target="_blank" class="text-light">Flaticon</a> &amp; <a href="https://fontawesome.com/" target="_blank" class="text-light">Font Awesome</a>
                    </p>
                    <p class="small mt-3">
                        <a href="/" class="text-light text-decoration-none">Home</a> | 
                        <a href="/disclaimer.html" class="text-light text-decoration-none">Disclaimer</a> | 
                        <a href="/privacy-policy.html" class="text-light text-decoration-none">Privacy Policy</a>
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small">
                        Enjoying this content?  <a href="https://buymeacoffee.com/itswzee" target="_blank" class="text-light" style="text-decoration: underline;">Keep me caffeinated</a> to keep the pixels flowing!
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scroll-to-Top Button -->
    <button id="scrollToTop" class="scroll-to-top" title="Back to Top">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Category Indicator -->
    <div id="categoryIndicator" class="category-indicator" title="Current Section"><i class="fas fa-tag"></i><span id="categoryText">Technology</span></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="../../../js/main.js"></script>
    <script src="../../../js/cookie-consent.js"></script>
    
    <!-- Prism.js for Syntax Highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>

    <!-- Prism Theme Switcher -->
    <script>
        const themes = {
            'prism-theme': 'Tomorrow Night',
            'prism-default': 'Default',
            'prism-dark': 'Dark',
            'prism-twilight': 'Twilight',
            'prism-okaidia': 'Okaidia',
            'prism-solarizedlight': 'Solarized Light'
        };

        const savedTheme = localStorage.getItem('prism-theme') || 'prism-theme';

        function switchTheme(themeId) {
            Object.keys(themes).forEach(id => {
                const link = document.getElementById(id);
                if (link) link.disabled = true;
            });
            
            const selectedLink = document.getElementById(themeId);
            if (selectedLink) {
                selectedLink.disabled = false;
                localStorage.setItem('prism-theme', themeId);
            }

            document.querySelectorAll('div.code-toolbar select').forEach(dropdown => {
                dropdown.value = themeId;
            });

            setTimeout(() => Prism.highlightAll(), 10);
        }

        document.addEventListener('DOMContentLoaded', function() {
            switchTheme(savedTheme);
        });

        Prism.plugins.toolbar.registerButton('theme-switcher', function(env) {
            const select = document.createElement('select');
            select.setAttribute('aria-label', 'Select code theme');
            select.className = 'prism-theme-selector';
            
            Object.keys(themes).forEach(themeId => {
                const option = document.createElement('option');
                option.value = themeId;
                option.textContent = themes[themeId];
                if (themeId === savedTheme) option.selected = true;
                select.appendChild(option);
            });
            
            select.addEventListener('change', function(e) {
                switchTheme(e.target.value);
            });
            
            return select;
        });
    </script>

    <!-- Scroll-to-Top and Category Indicator Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const scrollToTopBtn = document.getElementById('scrollToTop');
            const categoryIndicator = document.getElementById('categoryIndicator');
            
            const h2Elements = document.querySelectorAll('.blog-content h2');
            const sections = [];
            
            h2Elements.forEach(function(h2) {
                let text = h2.textContent.trim().replace(/^\d+\.\s*/, '');
                if (text.length > 25) text = text.substring(0, 22) + '...';
                sections.push({ element: h2, name: text });
            });
            
            window.addEventListener('scroll', function() {
                if (window.scrollY > 300) {
                    scrollToTopBtn.classList.add('show');
                    
                    if (sections.length > 0) {
                        let currentSection = sections[0].name;
                        for (let i = 0; i < sections.length; i++) {
                            const rect = sections[i].element.getBoundingClientRect();
                            if (rect.top <= 150) currentSection = sections[i].name;
                        }
                        categoryIndicator.textContent = currentSection;
                        categoryIndicator.classList.add('show');
                    }
                } else {
                    scrollToTopBtn.classList.remove('show');
                    categoryIndicator.classList.remove('show');
                }
            });
            
            scrollToTopBtn.addEventListener('click', function() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
    </script>
</body>
</html>
