<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="robots" content="index, archive" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Complete guide to authentication and security in system design including OAuth 2.0, JWT, RBAC, session management, data encryption, SSL/TLS, GDPR compliance, and security best practices." />
    <meta name="author" content="Wasil Zafar" />
    <meta name="keywords" content="Authentication, Authorization, OAuth, JWT, RBAC, Session Management, Data Encryption, SSL/TLS, GDPR, Security, System Design, Access Control, Identity Management" />
    <meta property="og:title" content="System Design Series Part 14: Authentication & Security" />
    <meta property="og:description" content="Master authentication and security patterns including OAuth, JWT, RBAC, encryption, and compliance." />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2026-01-25" />
    <meta property="article:author" content="Wasil Zafar" />
    <meta property="article:section" content="Technology" />
    
    <title>System Design Series Part 14: Authentication & Security - Wasil Zafar</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" id="prism-theme" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" id="prism-default" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-dark.min.css" id="prism-dark" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-twilight.min.css" id="prism-twilight" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" id="prism-okaidia" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-solarizedlight.min.css" id="prism-solarizedlight" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" />
    <link rel="apple-touch-icon" sizes="180x180" href="../../../images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../images/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="../../../images/favicon_io/site.webmanifest">

    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('consent', 'default', { 'ad_storage': 'denied', 'ad_user_data': 'denied', 'ad_personalization': 'denied', 'analytics_storage': 'denied', 'region': ['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE'] });
        gtag('consent', 'default', { 'ad_storage': 'granted', 'ad_user_data': 'granted', 'ad_personalization': 'granted', 'analytics_storage': 'granted' });
        gtag('set', 'url_passthrough', true);
    </script>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PBS8M2JR');</script>

    </head>
<body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBS8M2JR" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <div id="cookieBanner" class="light display-bottom" style="display: none;">
        <div class="content-wrap">
            <div class="msg-wrap"><p style="font-size: 14px; color: var(--color-navy);">We use cookies. See our <a href="/privacy-policy.html" style="color: var(--color-teal);">Privacy Policy</a>.</p></div>
            <div class="btn-wrap">
                <button id="cookieAccept" style="background: var(--color-teal); color: white;">Accept All</button>
                <button id="cookieReject" style="background: transparent; color: var(--color-navy); border: 2px solid var(--color-teal);">Reject All</button>
            </div>
        </div>
    </div>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/"><span class="gradient-text">Wasil Zafar</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#skills">Skills</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#certifications">Certifications</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#interests">Interests</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="blog-hero">
        <div class="container py-5">
            <div class="blog-header">
                <a href="/pages/categories/technology.html" class="back-link"><i class="fas fa-arrow-left me-2"></i>Back to Technology</a>
                <h1 class="display-4 fw-bold mb-3">System Design Series Part 14: Authentication & Security</h1>
                <div class="blog-meta">
                    <span><i class="fas fa-calendar me-2"></i>January 25, 2026</span>
                    <span><i class="fas fa-user me-2"></i>Wasil Zafar</span>
                    <span class="reading-time"><i class="fas fa-clock me-1"></i>45 min read</span>
                    <button onclick="window.print()" class="print-btn"><i class="fas fa-print"></i> Print</button>
                </div>
                <p class="lead">Complete guide to authentication and security in system design including OAuth 2.0, JWT, RBAC, session management, data encryption, SSL/TLS, GDPR compliance, and security best practices for distributed systems.</p>
            </div>
        </div>
    </section>

    <button class="toc-toggle-btn" onclick="openNav()" title="Table of Contents"><i class="fas fa-list"></i></button>

    <div id="tocSidenav" class="sidenav-toc">
        <div class="toc-header">
            <h3><i class="fas fa-list me-2"></i>Table of Contents</h3>
            <button class="closebtn" onclick="closeNav()">&times;</button>
        </div>
        <ol>
            <li><a href="#introduction" onclick="closeNav()">Security Fundamentals</a>
                <ul>
                    <li><a href="#introduction" onclick="closeNav()">Authentication vs Authorization</a></li>
                    <li><a href="#threat-model" onclick="closeNav()">Threat Modeling</a></li>
                </ul>
            </li>
            <li><a href="#authentication" onclick="closeNav()">Authentication Patterns</a>
                <ul>
                    <li><a href="#authentication" onclick="closeNav()">Session-Based Auth</a></li>
                    <li><a href="#token-auth" onclick="closeNav()">Token-Based Auth</a></li>
                    <li><a href="#jwt" onclick="closeNav()">JSON Web Tokens (JWT)</a></li>
                    <li><a href="#oauth" onclick="closeNav()">OAuth 2.0 & OpenID Connect</a></li>
                </ul>
            </li>
            <li><a href="#authorization" onclick="closeNav()">Authorization Patterns</a>
                <ul>
                    <li><a href="#authorization" onclick="closeNav()">Access Control Models</a></li>
                    <li><a href="#rbac" onclick="closeNav()">Role-Based Access Control</a></li>
                    <li><a href="#abac" onclick="closeNav()">Attribute-Based Access Control</a></li>
                    <li><a href="#policy-engines" onclick="closeNav()">Policy Engines</a></li>
                </ul>
            </li>
            <li><a href="#encryption" onclick="closeNav()">Data Encryption</a>
                <ul>
                    <li><a href="#encryption" onclick="closeNav()">Encryption at Rest</a></li>
                    <li><a href="#tls" onclick="closeNav()">Encryption in Transit (TLS)</a></li>
                    <li><a href="#key-management" onclick="closeNav()">Key Management</a></li>
                </ul>
            </li>
            <li><a href="#security-patterns" onclick="closeNav()">Security Patterns</a>
                <ul>
                    <li><a href="#security-patterns" onclick="closeNav()">Defense in Depth</a></li>
                    <li><a href="#zero-trust" onclick="closeNav()">Zero Trust Architecture</a></li>
                    <li><a href="#secrets-management" onclick="closeNav()">Secrets Management</a></li>
                </ul>
            </li>
            <li><a href="#compliance" onclick="closeNav()">Compliance & Regulations</a>
                <ul>
                    <li><a href="#compliance" onclick="closeNav()">GDPR</a></li>
                    <li><a href="#pci-dss" onclick="closeNav()">PCI-DSS</a></li>
                    <li><a href="#hipaa" onclick="closeNav()">HIPAA</a></li>
                </ul>
            </li>
            <li><a href="#next-steps" onclick="closeNav()">Next Steps</a></li>
        </ol>
    </div>

    <div id="tocOverlay" class="sidenav-overlay" onclick="closeNav()"></div>

    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">

                <div id="introduction" class="blog-content">
                    <h2><i class="fas fa-shield-alt me-2 text-teal"></i>Security Fundamentals</h2>
                    
                    <div class="highlight-box crimson">
                        <i class="fas fa-book me-2"></i>
                        <strong>Series Navigation:</strong> This is Part 14 of the 15-part System Design Series. <a href="system-design-distributed-systems-deep-dive.html">Review Part 13: Distributed Systems</a> first.
                    </div>

                    <div class="experiment-card">
                        <h4><i class="fas fa-map-signs me-2"></i>Complete Series Navigation</h4>
                        <div class="meta mb-2">
                            <span class="badge bg-teal me-2">15-Part Series</span>
                            <span class="badge bg-crimson">System Design Mastery</span>
                        </div>
                        <div class="content">
                            <ol>
                                <li><a href="system-design-introduction.html">Introduction to System Design</a> - Fundamentals, why it matters, key concepts</li>
                                <li><a href="system-design-scalability-fundamentals.html">Scalability Fundamentals</a> - Horizontal vs vertical scaling, stateless design</li>
                                <li><a href="system-design-load-balancing-caching.html">Load Balancing & Caching</a> - Algorithms, Redis, CDN patterns</li>
                                <li><a href="system-design-database-sharding.html">Database Design & Sharding</a> - SQL vs NoSQL, replication, partitioning</li>
                                <li><a href="system-design-microservices-architecture.html">Microservices Architecture</a> - Service decomposition, API gateways, sagas</li>
                                <li><a href="system-design-api-rest-graphql.html">API Design & REST/GraphQL</a> - RESTful principles, GraphQL, gRPC</li>
                                <li><a href="system-design-message-queues-event-driven.html">Message Queues & Event-Driven</a> - Kafka, RabbitMQ, event sourcing</li>
                                <li><a href="system-design-cap-theorem-consistency.html">CAP Theorem & Consistency</a> - Distributed trade-offs, eventual consistency</li>
                                <li><a href="system-design-rate-limiting-security.html">Rate Limiting & Security</a> - Throttling algorithms, DDoS protection</li>
                                <li><a href="system-design-monitoring-observability.html">Monitoring & Observability</a> - Logging, metrics, distributed tracing</li>
                                <li><a href="system-design-real-world-case-studies.html">Real-World Case Studies</a> - URL shortener, chat, feed, video streaming</li>
                                <li><a href="system-design-low-level-design-patterns.html">Low-Level Design Patterns</a> - SOLID, OOP patterns, data modeling</li>
                                <li><a href="system-design-distributed-systems-deep-dive.html">Distributed Systems Deep Dive</a> - Consensus, Paxos, Raft, coordination</li>
                                <li><strong>Authentication & Security (This Guide)</strong> - OAuth, JWT, zero trust, compliance</li>
                                <li><a href="system-design-interview-preparation.html">Interview Preparation</a> - 4-step framework, estimation, strategies</li>
                            </ol>
                        </div>
                    </div>
                    
                    <p><strong>Security</strong> is not an afterthought in system design—it must be built into every layer of your architecture. Understanding the difference between authentication (who you are) and authorization (what you can do) is fundamental to designing secure systems.</p>

                    <div class="highlight-box">
                        <i class="fas fa-lightbulb"></i>
                        <strong>Key Insight:</strong> Security is about trade-offs. More security often means more friction for users. The goal is finding the right balance between protection and usability for your specific use case.
                    </div>
                </div>

                <div id="threat-model" class="blog-content mt-5">
                    <h3>Threat Modeling</h3>
                    
                    <p>Before designing security controls, identify what you're protecting against. The STRIDE model categorizes threats:</p>
                    
                    <table class="table table-bordered">
                        <thead class="table-dark">
                            <tr>
                                <th>Threat</th>
                                <th>Description</th>
                                <th>Mitigation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Spoofing</strong></td>
                                <td>Pretending to be someone else</td>
                                <td>Strong authentication, MFA</td>
                            </tr>
                            <tr>
                                <td><strong>Tampering</strong></td>
                                <td>Modifying data or code</td>
                                <td>Integrity checks, signatures</td>
                            </tr>
                            <tr>
                                <td><strong>Repudiation</strong></td>
                                <td>Denying actions performed</td>
                                <td>Audit logs, digital signatures</td>
                            </tr>
                            <tr>
                                <td><strong>Information Disclosure</strong></td>
                                <td>Exposing sensitive data</td>
                                <td>Encryption, access controls</td>
                            </tr>
                            <tr>
                                <td><strong>Denial of Service</strong></td>
                                <td>Making system unavailable</td>
                                <td>Rate limiting, redundancy</td>
                            </tr>
                            <tr>
                                <td><strong>Elevation of Privilege</strong></td>
                                <td>Gaining unauthorized access</td>
                                <td>Least privilege, input validation</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div id="authentication" class="blog-content mt-5">
                    <h2><i class="fas fa-user-shield me-2 text-teal"></i>Authentication Patterns</h2>
                    
                    <p>Authentication verifies identity. There are three factors:</p>
                    
                    <ul>
                        <li><strong>Something you know:</strong> Passwords, PINs, security questions</li>
                        <li><strong>Something you have:</strong> Phone, hardware key, smart card</li>
                        <li><strong>Something you are:</strong> Fingerprint, face, iris scan</li>
                    </ul>
                    
                    <p>Multi-Factor Authentication (MFA) combines two or more factors for stronger security.</p>
                </div>

                <div id="token-auth" class="blog-content mt-5">
                    <h3>Token-Based Authentication</h3>
                    
                    <div class="experiment-card">
                        <h4><i class="fas fa-ticket-alt me-2"></i>Session vs Token Authentication</h4>
                        <div class="experiment-content">
<pre><code class="language-python"># Session-based Authentication (Traditional)
"""
1. User logs in with credentials
2. Server creates session, stores in memory/database
3. Server sends session ID in cookie
4. Client sends cookie with each request
5. Server looks up session to validate

Pros: Server can invalidate sessions instantly
Cons: Requires session storage, hard to scale horizontally
"""

# Token-based Authentication (Modern)
"""
1. User logs in with credentials
2. Server creates signed token (JWT)
3. Server sends token to client
4. Client sends token in Authorization header
5. Server validates token signature (no lookup needed)

Pros: Stateless, scales easily, works with microservices
Cons: Cannot revoke tokens instantly (use short expiry + refresh tokens)
"""

from flask import Flask, request, jsonify
import jwt
from datetime import datetime, timedelta
from functools import wraps

app = Flask(__name__)
SECRET_KEY = 'your-secret-key'

def generate_tokens(user_id):
    """Generate access and refresh token pair"""
    access_token = jwt.encode({
        'user_id': user_id,
        'type': 'access',
        'exp': datetime.utcnow() + timedelta(minutes=15),
        'iat': datetime.utcnow()
    }, SECRET_KEY, algorithm='HS256')
    
    refresh_token = jwt.encode({
        'user_id': user_id,
        'type': 'refresh',
        'exp': datetime.utcnow() + timedelta(days=7),
        'iat': datetime.utcnow()
    }, SECRET_KEY, algorithm='HS256')
    
    return access_token, refresh_token

def require_auth(f):
    """Decorator to protect routes"""
    @wraps(f)
    def decorated(*args, **kwargs):
        token = request.headers.get('Authorization', '').replace('Bearer ', '')
        
        try:
            payload = jwt.decode(token, SECRET_KEY, algorithms=['HS256'])
            if payload['type'] != 'access':
                return jsonify({'error': 'Invalid token type'}), 401
            request.user_id = payload['user_id']
        except jwt.ExpiredSignatureError:
            return jsonify({'error': 'Token expired'}), 401
        except jwt.InvalidTokenError:
            return jsonify({'error': 'Invalid token'}), 401
        
        return f(*args, **kwargs)
    return decorated

@app.route('/protected')
@require_auth
def protected():
    return jsonify({'user_id': request.user_id})</code></pre>
                        </div>
                    </div>
                </div>

                <div id="jwt" class="blog-content mt-5">
                    <h3>JSON Web Tokens (JWT)</h3>
                    
                    <div class="highlight-box">
                        <i class="fas fa-lightbulb"></i>
                        <strong>Key Insight:</strong> JWTs are not inherently secure—they're a format. Security depends on how you implement them: using strong algorithms (RS256, ES256), short expiration times, and proper token storage.
                    </div>
                    
                    <div class="experiment-card mt-4">
                        <h4><i class="fas fa-file-code me-2"></i>JWT Structure</h4>
                        <div class="experiment-content">
<pre><code class="language-python"># JWT = Header.Payload.Signature

# Header (Base64URL encoded)
{
    "alg": "RS256",  # Algorithm: RS256, ES256, HS256
    "typ": "JWT"
}

# Payload (Base64URL encoded) - Claims
{
    "sub": "user123",        # Subject (user ID)
    "iss": "myapp.com",      # Issuer
    "aud": "myapp-api",      # Audience
    "exp": 1735689600,       # Expiration time
    "iat": 1735686000,       # Issued at
    "nbf": 1735686000,       # Not valid before
    "jti": "unique-id",      # JWT ID (for revocation)
    
    # Custom claims
    "role": "admin",
    "permissions": ["read", "write"]
}

# Signature (prevents tampering)
# RSASSA-PKCS1-v1_5 signature with SHA-256
# signature = RSA_Sign(base64url(header) + "." + base64url(payload), private_key)

# Best Practices
"""
1. Use asymmetric algorithms (RS256, ES256) for distributed systems
   - Auth server signs with private key
   - Services verify with public key
   
2. Keep tokens short-lived (15 min for access, 7 days for refresh)

3. Never store sensitive data in payload (it's readable!)

4. Implement token revocation for logout:
   - Blacklist (Redis with TTL matching token expiry)
   - Token versioning (increment on password change)
   
5. Store tokens securely:
   - Access token: Memory only (JavaScript variable)
   - Refresh token: HttpOnly, Secure, SameSite cookie
"""

# RS256 JWT Implementation
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import rsa, padding

def create_jwt_rs256(payload, private_key):
    header = base64url_encode(json.dumps({"alg": "RS256", "typ": "JWT"}))
    body = base64url_encode(json.dumps(payload))
    
    message = f"{header}.{body}".encode()
    signature = private_key.sign(
        message,
        padding.PKCS1v15(),
        hashes.SHA256()
    )
    
    return f"{header}.{body}.{base64url_encode(signature)}"

def verify_jwt_rs256(token, public_key):
    header, payload, signature = token.split('.')
    message = f"{header}.{payload}".encode()
    
    public_key.verify(
        base64url_decode(signature),
        message,
        padding.PKCS1v15(),
        hashes.SHA256()
    )
    
    return json.loads(base64url_decode(payload))</code></pre>
                        </div>
                    </div>
                </div>

                <div id="oauth" class="blog-content mt-5">
                    <h3>OAuth 2.0 & OpenID Connect</h3>
                    
                    <p>OAuth 2.0 is for <strong>authorization</strong> (delegated access). OpenID Connect (OIDC) adds an <strong>authentication</strong> layer on top.</p>

                    <div class="experiment-card">
                        <h4><i class="fas fa-handshake me-2"></i>OAuth 2.0 Authorization Code Flow</h4>
                        <div class="experiment-content">
<pre><code class="language-python"># OAuth 2.0 Authorization Code Flow (Most Secure)
"""
Used for: Server-side web applications
Why: Code exchanged server-to-server (secret stays safe)

Flow:
1. User clicks "Login with Google"
2. App redirects to Google's auth server
3. User authenticates and grants permissions
4. Google redirects back with authorization code
5. App exchanges code for tokens (server-to-server)
6. App uses access token to call Google APIs
"""

from flask import Flask, redirect, request, session
import requests

app = Flask(__name__)
CLIENT_ID = 'your-client-id'
CLIENT_SECRET = 'your-client-secret'
REDIRECT_URI = 'https://yourapp.com/callback'
AUTH_URL = 'https://accounts.google.com/o/oauth2/v2/auth'
TOKEN_URL = 'https://oauth2.googleapis.com/token'

@app.route('/login')
def login():
    # Step 1: Redirect to authorization server
    params = {
        'client_id': CLIENT_ID,
        'redirect_uri': REDIRECT_URI,
        'response_type': 'code',
        'scope': 'openid email profile',
        'state': generate_csrf_token(),  # Prevent CSRF
        'nonce': generate_nonce()        # Prevent replay attacks
    }
    auth_url = f"{AUTH_URL}?{urlencode(params)}"
    return redirect(auth_url)

@app.route('/callback')
def callback():
    # Step 2: Exchange code for tokens
    code = request.args.get('code')
    state = request.args.get('state')
    
    # Verify state matches
    if state != session.get('csrf_token'):
        return 'CSRF attack detected', 400
    
    # Exchange code for tokens (server-to-server)
    response = requests.post(TOKEN_URL, data={
        'client_id': CLIENT_ID,
        'client_secret': CLIENT_SECRET,
        'code': code,
        'grant_type': 'authorization_code',
        'redirect_uri': REDIRECT_URI
    })
    
    tokens = response.json()
    access_token = tokens['access_token']
    id_token = tokens['id_token']  # OIDC identity token
    
    # Validate ID token and extract user info
    user_info = decode_and_validate_id_token(id_token)
    
    return f"Welcome, {user_info['email']}!"</code></pre>
                        </div>
                    </div>

                    <h4 class="mt-4">OAuth 2.0 Grant Types Comparison</h4>
                    <table class="table table-bordered">
                        <thead class="table-dark">
                            <tr>
                                <th>Grant Type</th>
                                <th>Use Case</th>
                                <th>Security</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Authorization Code</strong></td>
                                <td>Server-side apps</td>
                                <td>High (secret protected)</td>
                            </tr>
                            <tr>
                                <td><strong>Auth Code + PKCE</strong></td>
                                <td>SPAs, mobile apps</td>
                                <td>High (no secret needed)</td>
                            </tr>
                            <tr>
                                <td><strong>Client Credentials</strong></td>
                                <td>Machine-to-machine</td>
                                <td>Medium (service accounts)</td>
                            </tr>
                            <tr>
                                <td><strong>Implicit</strong></td>
                                <td>Legacy SPAs</td>
                                <td>Low (deprecated)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div id="authorization" class="blog-content mt-5">
                    <h2><i class="fas fa-lock me-2 text-teal"></i>Authorization Patterns</h2>
                    
                    <p>Authorization determines what authenticated users can do. Three main models:</p>
                </div>

                <div id="rbac" class="blog-content mt-5">
                    <h3>Role-Based Access Control (RBAC)</h3>
                    
                    <div class="experiment-card">
                        <h4><i class="fas fa-users me-2"></i>RBAC Implementation</h4>
                        <div class="experiment-content">
<pre><code class="language-python"># RBAC: Users → Roles → Permissions
"""
Simple model where permissions are grouped into roles.
Users are assigned roles, not individual permissions.

Pros: Easy to understand and manage
Cons: Can lead to role explosion, not context-aware
"""

from functools import wraps
from flask import request, jsonify

# Define roles and permissions
ROLES = {
    'admin': ['read', 'write', 'delete', 'manage_users'],
    'editor': ['read', 'write'],
    'viewer': ['read']
}

class RBACSystem:
    def __init__(self, db):
        self.db = db
    
    def get_user_roles(self, user_id):
        return self.db.query(
            "SELECT role FROM user_roles WHERE user_id = ?", 
            (user_id,)
        )
    
    def get_permissions(self, user_id):
        """Get all permissions for a user's roles"""
        roles = self.get_user_roles(user_id)
        permissions = set()
        for role in roles:
            permissions.update(ROLES.get(role, []))
        return permissions
    
    def has_permission(self, user_id, permission):
        return permission in self.get_permissions(user_id)
    
    def assign_role(self, user_id, role):
        if role not in ROLES:
            raise ValueError(f"Invalid role: {role}")
        self.db.execute(
            "INSERT INTO user_roles (user_id, role) VALUES (?, ?)",
            (user_id, role)
        )

# Decorator for route protection
def require_permission(permission):
    def decorator(f):
        @wraps(f)
        def decorated(*args, **kwargs):
            user_id = request.user_id  # Set by auth middleware
            if not rbac.has_permission(user_id, permission):
                return jsonify({'error': 'Forbidden'}), 403
            return f(*args, **kwargs)
        return decorated
    return decorator

@app.route('/articles', methods=['POST'])
@require_auth
@require_permission('write')
def create_article():
    # Only users with 'write' permission can reach here
    pass</code></pre>
                        </div>
                    </div>
                </div>

                <div id="abac" class="blog-content mt-5">
                    <h3>Attribute-Based Access Control (ABAC)</h3>
                    
                    <div class="experiment-card">
                        <h4><i class="fas fa-tags me-2"></i>ABAC Implementation</h4>
                        <div class="experiment-content">
<pre><code class="language-python"># ABAC: Policies based on attributes
"""
Decisions based on:
- Subject attributes (user role, department, clearance)
- Resource attributes (owner, classification, type)
- Action attributes (read, write, delete)
- Environment attributes (time, location, device)

Pros: Fine-grained, context-aware
Cons: More complex to manage and audit
"""

class ABACPolicy:
    def evaluate(self, subject, resource, action, environment):
        """Override in subclasses"""
        raise NotImplementedError

class DocumentAccessPolicy(ABACPolicy):
    def evaluate(self, subject, resource, action, environment):
        # Rule 1: Admins can do anything
        if 'admin' in subject.get('roles', []):
            return True
        
        # Rule 2: Owners can read/write their documents
        if resource.get('owner_id') == subject.get('user_id'):
            if action in ['read', 'write', 'delete']:
                return True
        
        # Rule 3: Same department can read if not confidential
        if subject.get('department') == resource.get('department'):
            if action == 'read' and resource.get('classification') != 'confidential':
                return True
        
        # Rule 4: No access outside business hours for sensitive docs
        if resource.get('classification') == 'sensitive':
            hour = environment.get('current_hour', 0)
            if not (9 <= hour <= 17):
                return False
        
        return False

class PolicyEngine:
    def __init__(self):
        self.policies = []
    
    def add_policy(self, policy):
        self.policies.append(policy)
    
    def is_allowed(self, subject, resource, action, environment=None):
        environment = environment or {'current_hour': datetime.now().hour}
        
        for policy in self.policies:
            if policy.evaluate(subject, resource, action, environment):
                return True
        return False

# Usage
engine = PolicyEngine()
engine.add_policy(DocumentAccessPolicy())

allowed = engine.is_allowed(
    subject={'user_id': 123, 'roles': ['editor'], 'department': 'engineering'},
    resource={'owner_id': 456, 'department': 'engineering', 'classification': 'internal'},
    action='read'
)  # True - same department, not confidential</code></pre>
                        </div>
                    </div>
                </div>

                <div id="policy-engines" class="blog-content mt-5">
                    <h3>Policy Engines (OPA, Casbin)</h3>
                    
                    <div class="experiment-card">
                        <h4><i class="fas fa-gavel me-2"></i>Open Policy Agent (OPA)</h4>
                        <div class="experiment-content">
<pre><code class="language-python"># OPA uses Rego policy language
# policy.rego
"""
package authz

default allow = false

# Admins can do anything
allow {
    input.user.roles[_] == "admin"
}

# Users can read their own data
allow {
    input.action == "read"
    input.resource.owner == input.user.id
}

# Managers can read team data
allow {
    input.action == "read"
    input.resource.team == input.user.team
    input.user.roles[_] == "manager"
}
"""

# Python integration with OPA
import requests

class OPAClient:
    def __init__(self, opa_url):
        self.url = opa_url
    
    def query(self, policy_path, input_data):
        response = requests.post(
            f"{self.url}/v1/data/{policy_path}",
            json={"input": input_data}
        )
        return response.json().get('result', False)

# Usage
opa = OPAClient('http://localhost:8181')

allowed = opa.query('authz/allow', {
    'user': {'id': 'user123', 'roles': ['editor'], 'team': 'engineering'},
    'action': 'read',
    'resource': {'owner': 'user456', 'team': 'engineering'}
})</code></pre>
                        </div>
                    </div>
                </div>

                <div id="encryption" class="blog-content mt-5">
                    <h2><i class="fas fa-key me-2 text-teal"></i>Data Encryption</h2>
                    
                    <p>Encrypt data at rest and in transit to protect against unauthorized access.</p>
                </div>

                <div id="tls" class="blog-content mt-5">
                    <h3>Encryption in Transit (TLS/SSL)</h3>
                    
                    <div class="experiment-card">
                        <h4><i class="fas fa-lock me-2"></i>TLS Handshake</h4>
                        <div class="experiment-content">
<pre><code class="language-python"># TLS 1.3 Handshake (simplified)
"""
1. Client Hello
   - Supported cipher suites
   - Client random
   - Key share (ECDH public key)

2. Server Hello
   - Selected cipher suite
   - Server random
   - Key share (ECDH public key)
   - Certificate
   - Finished (encrypted)

3. Client Finished
   - Both sides derive session keys
   - All subsequent data encrypted
"""

# Flask with TLS
from flask import Flask

app = Flask(__name__)

if __name__ == '__main__':
    context = ('server.crt', 'server.key')  # Certificate and private key
    app.run(host='0.0.0.0', port=443, ssl_context=context)

# Nginx TLS configuration (production)
"""
server {
    listen 443 ssl http2;
    server_name example.com;
    
    ssl_certificate /etc/ssl/certs/example.com.crt;
    ssl_certificate_key /etc/ssl/private/example.com.key;
    
    # Modern TLS settings
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;
    ssl_prefer_server_ciphers off;
    
    # HSTS (force HTTPS)
    add_header Strict-Transport-Security "max-age=63072000" always;
}
"""

# Mutual TLS (mTLS) - Client certificates
"""
Used for service-to-service authentication in microservices.
Both client and server present certificates.

Benefits:
- Strong authentication (both parties verified)
- No shared secrets to manage
- Certificate can include identity claims
"""</code></pre>
                        </div>
                    </div>
                </div>

                <div id="key-management" class="blog-content mt-5">
                    <h3>Key Management</h3>
                    
                    <div class="experiment-card">
                        <h4><i class="fas fa-vault me-2"></i>Encryption at Rest</h4>
                        <div class="experiment-content">
<pre><code class="language-python"># Envelope Encryption Pattern
"""
Problem: Encrypting large amounts of data with a master key is slow
Solution: Use a hierarchy of keys

1. Master Key (KEK - Key Encryption Key)
   - Stored in HSM or KMS
   - Never leaves secure boundary
   
2. Data Encryption Key (DEK)
   - Generated per resource/tenant
   - Encrypted with master key
   - Stored alongside encrypted data
"""

from cryptography.fernet import Fernet
import boto3

class EnvelopeEncryption:
    def __init__(self, kms_key_id):
        self.kms = boto3.client('kms')
        self.kms_key_id = kms_key_id
    
    def encrypt(self, plaintext):
        # Generate data key
        response = self.kms.generate_data_key(
            KeyId=self.kms_key_id,
            KeySpec='AES_256'
        )
        
        plaintext_key = response['Plaintext']
        encrypted_key = response['CiphertextBlob']
        
        # Encrypt data with plaintext key
        fernet = Fernet(base64.urlsafe_b64encode(plaintext_key))
        ciphertext = fernet.encrypt(plaintext.encode())
        
        # Return encrypted key + encrypted data
        # (encrypted key can only be decrypted with master key)
        return {
            'encrypted_key': base64.b64encode(encrypted_key).decode(),
            'ciphertext': ciphertext.decode()
        }
    
    def decrypt(self, encrypted_data):
        # Decrypt data key using KMS
        encrypted_key = base64.b64decode(encrypted_data['encrypted_key'])
        response = self.kms.decrypt(CiphertextBlob=encrypted_key)
        plaintext_key = response['Plaintext']
        
        # Decrypt data
        fernet = Fernet(base64.urlsafe_b64encode(plaintext_key))
        plaintext = fernet.decrypt(encrypted_data['ciphertext'].encode())
        
        return plaintext.decode()</code></pre>
                        </div>
                    </div>
                </div>

                <div id="security-patterns" class="blog-content mt-5">
                    <h2><i class="fas fa-shield-virus me-2 text-teal"></i>Security Patterns</h2>
                    
                    <h4>Defense in Depth</h4>
                    <p>Layer multiple security controls so that if one fails, others still protect the system:</p>
                    
                    <ul>
                        <li><strong>Network:</strong> Firewalls, VPNs, network segmentation</li>
                        <li><strong>Host:</strong> OS hardening, antivirus, intrusion detection</li>
                        <li><strong>Application:</strong> Input validation, authentication, authorization</li>
                        <li><strong>Data:</strong> Encryption, access controls, backup</li>
                    </ul>
                </div>

                <div id="zero-trust" class="blog-content mt-5">
                    <h3>Zero Trust Architecture</h3>
                    
                    <div class="highlight-box">
                        <i class="fas fa-lightbulb"></i>
                        <strong>Key Principle:</strong> "Never trust, always verify." Assume the network is compromised. Authenticate and authorize every request, regardless of source.
                    </div>
                    
                    <h4 class="mt-4">Zero Trust Principles</h4>
                    <ul>
                        <li><strong>Verify explicitly:</strong> Authenticate based on all available data points</li>
                        <li><strong>Least privilege access:</strong> Limit access to just-in-time and just-enough</li>
                        <li><strong>Assume breach:</strong> Minimize blast radius, segment access, verify end-to-end encryption</li>
                    </ul>
                    
                    <div class="experiment-card mt-4">
                        <h4><i class="fas fa-network-wired me-2"></i>Zero Trust Implementation</h4>
                        <div class="experiment-content">
<pre><code class="language-python"># Zero Trust Service-to-Service Communication
"""
Traditional: Trust based on network location (inside firewall = trusted)
Zero Trust: Trust based on identity, regardless of location

Implementation:
1. Service identity (certificates, SPIFFE)
2. Mutual TLS for all communication
3. Fine-grained authorization policies
4. Continuous verification
"""

# SPIFFE (Secure Production Identity Framework)
"""
Every workload gets a SPIFFE ID:
spiffe://trust-domain/path

Example: spiffe://acme.com/ns/production/sa/payment-service

Components:
- SPIFFE ID: Unique workload identifier
- SVID (SPIFFE Verifiable Identity Document): X.509 cert or JWT
- SPIRE: Reference implementation for issuing SVIDs
"""

# Service mesh authorization (Istio)
"""
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: payment-service-policy
spec:
  selector:
    matchLabels:
      app: payment-service
  rules:
  - from:
    - source:
        principals: ["cluster.local/ns/default/sa/order-service"]
    to:
    - operation:
        methods: ["POST"]
        paths: ["/api/payments"]
  - from:
    - source:
        principals: ["cluster.local/ns/default/sa/admin-service"]
    to:
    - operation:
        methods: ["GET", "POST", "DELETE"]
"""</code></pre>
                        </div>
                    </div>
                </div>

                <div id="secrets-management" class="blog-content mt-5">
                    <h3>Secrets Management</h3>
                    
                    <div class="experiment-card">
                        <h4><i class="fas fa-user-secret me-2"></i>HashiCorp Vault</h4>
                        <div class="experiment-content">
<pre><code class="language-python"># Vault for Secrets Management
import hvac

client = hvac.Client(url='http://vault:8200')
client.token = 'your-vault-token'

# Store a secret
client.secrets.kv.v2.create_or_update_secret(
    path='database/credentials',
    secret={'username': 'admin', 'password': 'secret123'}
)

# Read a secret
response = client.secrets.kv.v2.read_secret_version(
    path='database/credentials'
)
credentials = response['data']['data']

# Dynamic Secrets (short-lived credentials)
"""
Vault can generate temporary credentials on-demand:
- Database credentials
- AWS IAM credentials
- PKI certificates

Benefits:
- No long-lived secrets
- Automatic rotation
- Audit trail
"""

# Database dynamic secrets
client.secrets.database.create_role(
    name='readonly',
    db_name='postgres',
    creation_statements=[
        "CREATE ROLE \"{{name}}\" WITH LOGIN PASSWORD '{{password}}' VALID UNTIL '{{expiration}}';",
        "GRANT SELECT ON ALL TABLES IN SCHEMA public TO \"{{name}}\";"
    ],
    default_ttl='1h',
    max_ttl='24h'
)

# Get temporary credentials
creds = client.secrets.database.generate_credentials(name='readonly')
# Returns: {'username': 'v-token-readonly-xyz', 'password': 'random', 'lease_id': '...'}

# Kubernetes Integration
"""
apiVersion: v1
kind: Pod
spec:
  serviceAccountName: app-service-account
  containers:
  - name: app
    env:
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          name: vault-injected-secrets
          key: db_password
"""</code></pre>
                        </div>
                    </div>
                </div>

                <div id="compliance" class="blog-content mt-5">
                    <h2><i class="fas fa-balance-scale me-2 text-teal"></i>Compliance & Regulations</h2>
                    
                    <h4>GDPR (General Data Protection Regulation)</h4>
                    <p>EU regulation for data protection and privacy. Key requirements:</p>
                    <ul>
                        <li><strong>Consent:</strong> Clear, affirmative consent for data processing</li>
                        <li><strong>Right to Access:</strong> Users can request their data</li>
                        <li><strong>Right to Erasure:</strong> "Right to be forgotten"</li>
                        <li><strong>Data Portability:</strong> Export data in machine-readable format</li>
                        <li><strong>Breach Notification:</strong> Report breaches within 72 hours</li>
                    </ul>
                </div>

                <div id="pci-dss" class="blog-content mt-5">
                    <h3>PCI-DSS</h3>
                    
                    <p>Payment Card Industry Data Security Standard for handling credit card data:</p>
                    <ul>
                        <li>Build and maintain secure network (firewalls, no default passwords)</li>
                        <li>Protect cardholder data (encryption, access controls)</li>
                        <li>Maintain vulnerability management program</li>
                        <li>Implement strong access control measures</li>
                        <li>Monitor and test networks regularly</li>
                        <li>Maintain information security policy</li>
                    </ul>
                    
                    <div class="highlight-box mt-4">
                        <i class="fas fa-lightbulb"></i>
                        <strong>Best Practice:</strong> Use payment tokenization (Stripe, Braintree) to avoid storing card data yourself. This dramatically reduces PCI scope.
                    </div>
                </div>

                <div id="hipaa" class="blog-content mt-5">
                    <h3>HIPAA</h3>
                    
                    <p>Health Insurance Portability and Accountability Act for healthcare data:</p>
                    <ul>
                        <li><strong>PHI (Protected Health Information):</strong> Any data that identifies a patient</li>
                        <li><strong>Privacy Rule:</strong> Limits use and disclosure of PHI</li>
                        <li><strong>Security Rule:</strong> Administrative, physical, and technical safeguards</li>
                        <li><strong>BAA (Business Associate Agreement):</strong> Required with vendors handling PHI</li>
                    </ul>
                </div>

                <div id="next-steps" class="blog-content mt-5">
                    <h2><i class="fas fa-arrow-right me-2 text-teal"></i>Next Steps</h2>
                    
                    <p>You now have a comprehensive understanding of authentication and security patterns! Continue to Part 15 for Interview Preparation—strategies and patterns for system design interviews.</p>
                    
                    <div class="related-posts">
                        <h3><i class="fas fa-book-reader me-2"></i>Continue the Series</h3>
                        <div class="related-post-item">
                            <h5 class="mb-2">Part 15: Interview Preparation</h5>
                            <p class="text-muted small mb-2">Prepare for system design interviews with patterns and strategies.</p>
                            <a href="system-design-interview-preparation.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                        <div class="related-post-item">
                            <h5 class="mb-2">Part 13: Distributed Systems Deep Dive</h5>
                            <p class="text-muted small mb-2">Master consensus algorithms and distributed coordination.</p>
                            <a href="system-design-distributed-systems-deep-dive.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                        <div class="related-post-item">
                            <h5 class="mb-2">Part 9: Rate Limiting & Security</h5>
                            <p class="text-muted small mb-2">Learn rate limiting algorithms and API security.</p>
                            <a href="system-design-rate-limiting-security.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                    </div>
                </div>

                </div>
            </div>
        </div>
    </section>

    <footer id="social-media" class="bg-dark text-light py-5">
        <div class="container py-5">
            <div class="row mb-4">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h5 class="fw-bold mb-3">Let's Connect</h5>
                    <p class="text-light">
                        I'm always interested in sharing content about my interests on different topics. Read disclaimer and feel free to share further.
                    </p>
                </div>
                <div class="col-lg-6">
                    <h5 class="fw-bold mb-3">Follow Me</h5>
                    <div class="social-links d-flex gap-2 flex-wrap">
                        <a href="https://www.facebook.com/wasil.zafar/" target="_blank" class="social-icon" title="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://twitter.com/wasilzafar" target="_blank" class="social-icon" title="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.linkedin.com/in/wasilzafar" target="_blank" class="social-icon" title="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://www.youtube.com/@wasilzafar" target="_blank" class="social-icon" title="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://www.instagram.com/itswzee/" target="_blank" class="social-icon" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://in.pinterest.com/wasilz/" target="_blank" class="social-icon" title="Pinterest">
                            <i class="fab fa-pinterest-p"></i>
                        </a>
                        <a href="mailto:wasil.zafar@gmail.com" class="social-icon" title="Email">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>

            <hr class="bg-secondary">

            <div class="row mt-4">
                <div class="col-md-6">
                    <p class="small">
                        <i class="fas fa-icons me-2"></i>Icons from <a href="https://www.flaticon.com/" target="_blank" class="text-light">Flaticon</a> &amp; <a href="https://fontawesome.com/" target="_blank" class="text-light">Font Awesome</a>
                    </p>
                    <p class="small mt-3">
                        <a href="/" class="text-light text-decoration-none">Home</a> | 
                        <a href="/disclaimer.html" class="text-light text-decoration-none">Disclaimer</a> | 
                        <a href="/privacy-policy.html" class="text-light text-decoration-none">Privacy Policy</a>
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small">
                        Enjoying this content? ☕ <a href="https://buymeacoffee.com/itswzee" target="_blank" class="text-light" style="text-decoration: underline;">Keep me caffeinated</a> to keep the pixels flowing!
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <button id="scrollToTop" class="scroll-to-top"><i class="fas fa-arrow-up"></i></button>
    <!-- Category Indicator -->
    <div id="categoryIndicator" class="category-indicator" title="Current Section">
        <i class="fas fa-tag"></i><span id="categoryText">Technology</span>
    </div>
    <script src="../../../js/cookie-consent.js"></script>
    <script src="../../../js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>

            </body>
</html>
