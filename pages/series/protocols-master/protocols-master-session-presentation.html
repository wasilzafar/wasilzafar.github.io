<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="robots" content="index, archive" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Master the Session and Presentation Layers. Learn TLS/SSL encryption, the TLS handshake, certificates, PKI, data serialization formats, compression, and secure communication." />
    <meta name="author" content="Wasil Zafar" />
    <meta name="keywords" content="TLS, SSL, Session Layer, Presentation Layer, Encryption, Certificates, PKI, JSON, XML, Protocol Buffers, Compression" />
    <meta property="og:title" content="Complete Protocols Master Part 5: Session & Presentation Layers" />
    <meta property="og:description" content="Master TLS/SSL encryption, certificates, data serialization, and compression for secure network communication." />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2026-01-31" />
    <meta property="article:author" content="Wasil Zafar" />
    <meta property="article:section" content="Technology" />
    
    <title>Complete Protocols Master Part 5: Session & Presentation Layers - Wasil Zafar</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet" />

    <!-- Custom Styles -->
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" />

    <!-- Prism.js Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" id="prism-theme" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" id="prism-default" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-dark.min.css" id="prism-dark" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-twilight.min.css" id="prism-twilight" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" id="prism-okaidia" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-solarizedlight.min.css" id="prism-solarizedlight" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" />

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="../../../images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../images/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="../../../images/favicon_io/site.webmanifest">

    <!-- Google Consent Mode v2 -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied',
            'region': ['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE']
        });
        gtag('consent', 'default', {
            'ad_storage': 'granted',
            'ad_user_data': 'granted',
            'ad_personalization': 'granted',
            'analytics_storage': 'granted'
        });
        gtag('set', 'url_passthrough', true);
    </script>

    <!-- Google Tag Manager -->
    <script>
        (function(w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({'gtm.start': new Date().getTime(), event: 'gtm.js'});
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-PBS8M2JR');
    </script>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBS8M2JR" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/"><span class="gradient-text">Wasil Zafar</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#skills">Skills</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#certifications">Certifications</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#interests">Interests</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="blog-hero">
        <div class="container py-5">
            <div class="blog-header">
                <a href="/pages/categories/technology.html" class="back-link"><i class="fas fa-arrow-left me-2"></i>Back to Technology</a>
                <h1 class="display-4 fw-bold mb-3">Complete Protocols Master Part 5: Session & Presentation Layers</h1>
                <div class="blog-meta">
                    <span><i class="fas fa-calendar me-2"></i>January 31, 2026</span>
                    <span><i class="fas fa-user me-2"></i>Wasil Zafar</span>
                    <span class="reading-time"><i class="fas fa-clock me-1"></i>40 min read</span>
                    <button onclick="window.print()" class="print-btn" title="Print this article"><i class="fas fa-print"></i> Print</button>
                </div>
                <p class="lead">Explore the crucial middle layers that handle encryption, session management, and data representation. Master TLS/SSL, certificates, PKI, and learn how data is serialized, compressed, and secured for transmission.</p>
            </div>
        </div>
    </section>

    <!-- Table of Contents Toggle Button -->
    <button class="toc-toggle-btn" onclick="openNav()" title="Table of Contents" aria-label="Open Table of Contents">
        <i class="fas fa-list"></i>
    </button>

    <!-- Side Navigation Overlay -->
    <div id="tocSidenav" class="sidenav-toc">
        <div class="toc-header">
            <h3><i class="fas fa-list me-2"></i>Table of Contents</h3>
            <button class="closebtn" onclick="closeNav()" aria-label="Close Table of Contents">&times;</button>
        </div>
        <ol>
            <li>
                <a href="#introduction" onclick="closeNav()">Introduction</a>
                <ul>
                    <li><a href="#introduction" onclick="closeNav()">Layer 5 & 6 Overview</a></li>
                    <li><a href="#osi-reality" onclick="closeNav()">OSI vs Reality</a></li>
                </ul>
            </li>
            <li>
                <a href="#tls-ssl" onclick="closeNav()">TLS/SSL Fundamentals</a>
                <ul>
                    <li><a href="#tls-ssl" onclick="closeNav()">What is TLS?</a></li>
                    <li><a href="#tls-versions" onclick="closeNav()">TLS Versions</a></li>
                    <li><a href="#cipher-suites" onclick="closeNav()">Cipher Suites</a></li>
                </ul>
            </li>
            <li>
                <a href="#tls-handshake" onclick="closeNav()">TLS Handshake</a>
                <ul>
                    <li><a href="#tls-handshake" onclick="closeNav()">TLS 1.2 Handshake</a></li>
                    <li><a href="#tls13-handshake" onclick="closeNav()">TLS 1.3 Handshake</a></li>
                </ul>
            </li>
            <li>
                <a href="#certificates" onclick="closeNav()">Certificates & PKI</a>
                <ul>
                    <li><a href="#certificates" onclick="closeNav()">X.509 Certificates</a></li>
                    <li><a href="#certificate-chain" onclick="closeNav()">Certificate Chain</a></li>
                    <li><a href="#pki" onclick="closeNav()">PKI Infrastructure</a></li>
                </ul>
            </li>
            <li>
                <a href="#cryptography" onclick="closeNav()">Cryptography Basics</a>
                <ul>
                    <li><a href="#cryptography" onclick="closeNav()">Symmetric Encryption</a></li>
                    <li><a href="#asymmetric" onclick="closeNav()">Asymmetric Encryption</a></li>
                    <li><a href="#hashing" onclick="closeNav()">Hashing & MACs</a></li>
                </ul>
            </li>
            <li>
                <a href="#serialization" onclick="closeNav()">Data Serialization</a>
                <ul>
                    <li><a href="#serialization" onclick="closeNav()">Text Formats</a></li>
                    <li><a href="#binary-formats" onclick="closeNav()">Binary Formats</a></li>
                    <li><a href="#format-comparison" onclick="closeNav()">Format Comparison</a></li>
                </ul>
            </li>
            <li>
                <a href="#compression" onclick="closeNav()">Compression</a>
                <ul>
                    <li><a href="#compression" onclick="closeNav()">Compression Algorithms</a></li>
                    <li><a href="#http-compression" onclick="closeNav()">HTTP Compression</a></li>
                </ul>
            </li>
            <li>
                <a href="#hands-on" onclick="closeNav()">Hands-On Exercises</a>
            </li>
            <li>
                <a href="#summary" onclick="closeNav()">Summary & Next Steps</a>
            </li>
        </ol>
    </div>

    <!-- Overlay Backdrop -->
    <div id="tocOverlay" class="sidenav-overlay" onclick="closeNav()"></div>

    <!-- Main Content -->
    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">

                <!-- Introduction -->
                <div id="introduction" class="blog-content">
                    <h2><i class="fas fa-layer-group me-2 text-teal"></i>Introduction: Session & Presentation Layers</h2>
                    
                    <p>In <a href="protocols-master-transport-layer.html">Part 4</a>, we explored how TCP and UDP deliver data between applications. Now we examine <strong>Layers 5 and 6</strong> of the OSI model—often overlooked but critically important for secure, efficient communication.</p>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-sitemap me-2"></i>
                        <strong>Series Context:</strong> This is <strong>Part 5 of 20</strong> in the Complete Protocols Master series. We're bridging transport and application layers with security and data handling.
                    </div>

                    <div class="experiment-card" id="series-nav">
                        <h4><i class="fas fa-map-signs me-2"></i>Complete Series Navigation</h4>
                        <div class="meta mb-2">
                            <span class="badge bg-teal me-2">20-Part Series</span>
                            <span class="badge bg-crimson">Protocol Mastery</span>
                        </div>
                        <div class="content">
                            <ol>
                                <li><a href="protocols-master-osi-foundations.html"><strong>Part 1:</strong> OSI Model & Protocol Foundations</a> — Network layers, encapsulation, TCP/IP model</li>
                                <li><a href="protocols-master-physical-datalink.html"><strong>Part 2:</strong> Physical & Data Link Layers</a> — Ethernet, Wi-Fi, VLANs, MAC addressing</li>
                                <li><a href="protocols-master-network-layer.html"><strong>Part 3:</strong> Network Layer & IP</a> — IPv4, IPv6, ICMP, routing protocols</li>
                                <li><a href="protocols-master-transport-layer.html"><strong>Part 4:</strong> Transport Layer</a> — TCP, UDP, QUIC, ports, sockets</li>
                                <li><strong>Part 5: Session & Presentation Layers (This Guide)</strong> — TLS handshake, encryption, serialization</li>
                                <li><a href="protocols-master-web-protocols.html"><strong>Part 6:</strong> Web Protocols</a> — HTTP/1.1, HTTP/2, HTTP/3, WebSockets</li>
                                <li><a href="protocols-master-api-protocols.html"><strong>Part 7:</strong> API Protocols</a> — REST, GraphQL, gRPC, SOAP</li>
                                <li><a href="protocols-master-dns-deep-dive.html"><strong>Part 8:</strong> DNS Deep Dive</a> — DNS hierarchy, records, DNSSEC</li>
                                <li><a href="protocols-master-email-protocols.html"><strong>Part 9:</strong> Email Protocols</a> — SMTP, IMAP, POP3, SPF/DKIM/DMARC</li>
                                <li><a href="protocols-master-file-transfer.html"><strong>Part 10:</strong> File Transfer Protocols</a> — FTP, SFTP, SCP, rsync</li>
                                <li><a href="protocols-master-realtime-protocols.html"><strong>Part 11:</strong> Real-Time Protocols</a> — WebRTC, SIP, RTP, VoIP</li>
                                <li><a href="protocols-master-streaming-protocols.html"><strong>Part 12:</strong> Streaming Protocols</a> — HLS, DASH, RTMP, media delivery</li>
                                <li><a href="protocols-master-iot-protocols.html"><strong>Part 13:</strong> IoT Protocols</a> — MQTT, CoAP, Zigbee, LoRaWAN</li>
                                <li><a href="protocols-master-vpn-tunneling.html"><strong>Part 14:</strong> VPN & Tunneling</a> — IPsec, OpenVPN, WireGuard</li>
                                <li><a href="protocols-master-authentication-protocols.html"><strong>Part 15:</strong> Authentication Protocols</a> — OAuth, SAML, OIDC, Kerberos</li>
                                <li><a href="protocols-master-network-management.html"><strong>Part 16:</strong> Network Management</a> — SNMP, NetFlow, Syslog</li>
                                <li><a href="protocols-master-security-protocols.html"><strong>Part 17:</strong> Security Protocols</a> — TLS/SSL, certificates, PKI</li>
                                <li><a href="protocols-master-cloud-protocols.html"><strong>Part 18:</strong> Cloud Provider Protocols</a> — AWS, Azure, GCP APIs</li>
                                <li><a href="protocols-master-emerging-protocols.html"><strong>Part 19:</strong> Emerging Protocols</a> — QUIC, HTTP/3, WebTransport</li>
                                <li><a href="protocols-master-web-security-standards.html"><strong>Part 20:</strong> Web Security Standards</a> — CORS, CSP, HSTS, SRI</li>
                            </ol>
                        </div>
                    </div>

                    <h3 id="osi-reality">OSI Model vs Reality</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">Layer 5</span>
                            <span class="badge bg-crimson text-white">Layer 6</span>
                        </div>
                        <h4>Session & Presentation Layer Functions</h4>
<pre><code class="language-bash">OSI Layer 5 - Session Layer:
├── Session establishment, maintenance, termination
├── Dialog control (who speaks when)
├── Synchronization (checkpoints for recovery)
├── Authentication negotiation
└── Examples: RPC sessions, NetBIOS, PPTP

OSI Layer 6 - Presentation Layer:
├── Data translation (format conversion)
├── Encryption/Decryption
├── Compression/Decompression  
├── Character encoding (ASCII, UTF-8)
└── Examples: SSL/TLS, MIME, JPEG, MPEG

Reality Check:
┌────────────────────────────────────────────────────────┐
│ In TCP/IP, Layers 5-6 are merged into the             │
│ Application Layer. TLS operates between TCP and       │
│ HTTP, handling both session and presentation duties.  │
│                                                        │
│ Modern stacks: App ↔ TLS ↔ TCP ↔ IP ↔ Network        │
└────────────────────────────────────────────────────────┘
</code></pre>
                    </div>

                    <div class="highlight-box">
                        <i class="fas fa-lightbulb"></i>
                        <strong>Why Study These Layers?</strong> While pure OSI layers 5/6 protocols are rare, their <em>functions</em> are everywhere: TLS handles encryption (presentation) and session keys (session), JSON/XML handle data representation, and gzip handles compression. Understanding these concepts is essential for secure application development.
                    </div>
                </div>

                <!-- TLS/SSL Section -->
                <div id="tls-ssl" class="blog-content mt-5">
                    <h2><i class="fas fa-lock me-2 text-teal"></i>TLS/SSL Fundamentals</h2>
                    
                    <p><strong>TLS (Transport Layer Security)</strong> is the cryptographic protocol that secures most internet traffic. When you see the padlock in your browser, TLS is at work.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">TLS Overview</span>
                        </div>
                        <h4>What TLS Provides</h4>
                        <ul>
                            <li><strong>Confidentiality:</strong> Encryption prevents eavesdropping</li>
                            <li><strong>Integrity:</strong> MACs detect tampering</li>
                            <li><strong>Authentication:</strong> Certificates verify identity</li>
                            <li><strong>Forward Secrecy:</strong> (TLS 1.3) Past sessions can't be decrypted if keys compromised</li>
                        </ul>
                        <p class="mt-3"><strong>Historical Note:</strong> SSL (Secure Sockets Layer) was developed by Netscape. After SSL 3.0, it was renamed TLS. SSL is now deprecated and insecure—always use TLS 1.2+.</p>
                    </div>

                    <h3 id="tls-versions">TLS Version History</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">Version Timeline</span>
                        </div>
                        <h4>TLS/SSL Evolution</h4>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Version</th>
                                    <th>Year</th>
                                    <th>Status</th>
                                    <th>Key Features</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="table-danger">
                                    <td>SSL 2.0</td>
                                    <td>1995</td>
                                    <td>❌ Deprecated</td>
                                    <td>First public version, many flaws</td>
                                </tr>
                                <tr class="table-danger">
                                    <td>SSL 3.0</td>
                                    <td>1996</td>
                                    <td>❌ Deprecated</td>
                                    <td>POODLE vulnerability</td>
                                </tr>
                                <tr class="table-warning">
                                    <td>TLS 1.0</td>
                                    <td>1999</td>
                                    <td>⚠️ Deprecated</td>
                                    <td>Renamed from SSL, BEAST vulnerability</td>
                                </tr>
                                <tr class="table-warning">
                                    <td>TLS 1.1</td>
                                    <td>2006</td>
                                    <td>⚠️ Deprecated</td>
                                    <td>Fixed BEAST, still weak</td>
                                </tr>
                                <tr class="table-success">
                                    <td>TLS 1.2</td>
                                    <td>2008</td>
                                    <td>✅ Supported</td>
                                    <td>SHA-256, AEAD ciphers, most common</td>
                                </tr>
                                <tr class="table-success">
                                    <td>TLS 1.3</td>
                                    <td>2018</td>
                                    <td>✅ Recommended</td>
                                    <td>Faster, simpler, mandatory forward secrecy</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>Security Advisory:</strong> TLS 1.0 and 1.1 were deprecated by browsers in 2020. Major sites dropped support. Always configure servers for TLS 1.2+ and prefer TLS 1.3.
                    </div>

                    <h3 id="cipher-suites">Cipher Suites</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">Cipher Suites</span>
                        </div>
                        <h4>Understanding Cipher Suite Names</h4>
<pre><code class="language-bash">TLS 1.2 Cipher Suite Example:
TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
│    │     │        │   │   │    │
│    │     │        │   │   │    └── PRF hash (key derivation)
│    │     │        │   │   └─────── AEAD tag size
│    │     │        │   └─────────── Block cipher mode
│    │     │        └─────────────── Bulk encryption key size
│    │     └──────────────────────── Server authentication
│    └────────────────────────────── Key exchange algorithm
└─────────────────────────────────── Protocol

Components:
┌─────────────────┬───────────────────────────────────────────┐
│ Key Exchange    │ ECDHE, DHE, RSA (avoid RSA key exchange)  │
├─────────────────┼───────────────────────────────────────────┤
│ Authentication  │ RSA, ECDSA, Ed25519                       │
├─────────────────┼───────────────────────────────────────────┤
│ Bulk Cipher     │ AES-128, AES-256, ChaCha20                │
├─────────────────┼───────────────────────────────────────────┤
│ Cipher Mode     │ GCM, CCM (AEAD), CBC (avoid)              │
├─────────────────┼───────────────────────────────────────────┤
│ Hash/MAC        │ SHA-256, SHA-384, Poly1305                │
└─────────────────┴───────────────────────────────────────────┘

TLS 1.3 Simplified (only 5 cipher suites):
- TLS_AES_256_GCM_SHA384
- TLS_AES_128_GCM_SHA256
- TLS_CHACHA20_POLY1305_SHA256
- TLS_AES_128_CCM_SHA256
- TLS_AES_128_CCM_8_SHA256

(Key exchange always ECDHE or DHE, authentication separate)
</code></pre>
                    </div>

<pre><code class="language-bash"># Check TLS configuration of a website

# Using OpenSSL
openssl s_client -connect google.com:443 -tls1_3
openssl s_client -connect google.com:443 -tls1_2

# Show certificate
openssl s_client -connect google.com:443 -showcerts

# List supported cipher suites
openssl ciphers -v 'TLSv1.3'
openssl ciphers -v 'HIGH:!aNULL:!MD5'

# Using nmap for comprehensive scan
nmap --script ssl-enum-ciphers -p 443 google.com

# Using testssl.sh (comprehensive testing)
# https://github.com/drwetter/testssl.sh
./testssl.sh google.com

# Check your server's TLS configuration
# https://www.ssllabs.com/ssltest/
</code></pre>
                </div>

                <!-- TLS Handshake Section -->
                <div id="tls-handshake" class="blog-content mt-5">
                    <h2><i class="fas fa-handshake me-2 text-teal"></i>The TLS Handshake</h2>
                    
                    <p>The TLS handshake establishes a secure connection by negotiating protocol version, cipher suite, and exchanging keys.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">TLS 1.2</span>
                        </div>
                        <h4>TLS 1.2 Full Handshake (2-RTT)</h4>
<pre><code class="language-bash">Client                                              Server
   │                                                   │
   │  1. ClientHello                                   │
   │     - TLS version (1.2)                           │
   │     - Random (32 bytes)                           │
   │     - Session ID                                  │
   │     - Cipher suites list                          │
   │     - Extensions (SNI, etc.)                      │
   │ ────────────────────────────────────────────────> │
   │                                                   │
   │  2. ServerHello                                   │
   │     - Chosen TLS version                          │
   │     - Server random                               │
   │     - Session ID                                  │
   │     - Chosen cipher suite                         │
   │ <──────────────────────────────────────────────── │
   │                                                   │
   │  3. Certificate                                   │
   │     - Server's X.509 certificate chain            │
   │ <──────────────────────────────────────────────── │
   │                                                   │
   │  4. ServerKeyExchange (if ECDHE/DHE)              │
   │     - DH parameters                               │
   │     - Signature                                   │
   │ <──────────────────────────────────────────────── │
   │                                                   │
   │  5. ServerHelloDone                               │
   │ <──────────────────────────────────────────────── │
   │                                                   │
   │  6. ClientKeyExchange                             │
   │     - Client's DH public value or                 │
   │       RSA-encrypted pre-master secret             │
   │ ────────────────────────────────────────────────> │
   │                                                   │
   │  7. ChangeCipherSpec                              │
   │     "Switching to encrypted mode"                 │
   │ ────────────────────────────────────────────────> │
   │                                                   │
   │  8. Finished (encrypted)                          │
   │     - Hash of all handshake messages              │
   │ ────────────────────────────────────────────────> │
   │                                                   │
   │  9. ChangeCipherSpec                              │
   │ <──────────────────────────────────────────────── │
   │                                                   │
   │  10. Finished (encrypted)                         │
   │ <──────────────────────────────────────────────── │
   │                                                   │
   │  ═══════ ENCRYPTED APPLICATION DATA ═══════      │
   │ <═══════════════════════════════════════════════> │
</code></pre>
                    </div>

                    <h3 id="tls13-handshake">TLS 1.3 Handshake (1-RTT)</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">TLS 1.3</span>
                        </div>
                        <h4>TLS 1.3 Full Handshake (1-RTT)</h4>
<pre><code class="language-bash">Client                                              Server
   │                                                   │
   │  1. ClientHello                                   │
   │     - TLS version 1.3                             │
   │     - Random                                      │
   │     - Cipher suites                               │
   │     - key_share (client's DH public)              │
   │     - supported_versions                          │
   │     - signature_algorithms                        │
   │ ────────────────────────────────────────────────> │
   │                                                   │
   │  2. ServerHello                                   │
   │     - Random                                      │
   │     - Chosen cipher suite                         │
   │     - key_share (server's DH public)              │
   │ <──────────────────────────────────────────────── │
   │                                                   │
   │  ══════ ENCRYPTION STARTS HERE ══════            │
   │                                                   │
   │  3. EncryptedExtensions                           │
   │ <──────────────────────────────────────────────── │
   │                                                   │
   │  4. Certificate                                   │
   │ <──────────────────────────────────────────────── │
   │                                                   │
   │  5. CertificateVerify                             │
   │ <──────────────────────────────────────────────── │
   │                                                   │
   │  6. Finished                                      │
   │ <──────────────────────────────────────────────── │
   │                                                   │
   │  7. Finished                                      │
   │ ────────────────────────────────────────────────> │
   │                                                   │
   │  ═══════ ENCRYPTED APPLICATION DATA ═══════      │

Key Improvements in TLS 1.3:
- 1-RTT handshake (vs 2-RTT in 1.2)
- 0-RTT for repeat connections (with caveats)
- Encryption starts earlier (after ServerHello)
- Removed insecure features (RSA key exchange, CBC, etc.)
- Mandatory forward secrecy (ECDHE/DHE only)
- Simpler, fewer cipher suites
</code></pre>
                    </div>

<pre><code class="language-python"># Examine TLS handshake with Python ssl module
import ssl
import socket
import pprint

def analyze_tls_connection(hostname, port=443):
    """Analyze TLS connection details"""
    
    # Create SSL context
    context = ssl.create_default_context()
    
    # Connect and wrap socket
    with socket.create_connection((hostname, port)) as sock:
        with context.wrap_socket(sock, server_hostname=hostname) as ssock:
            
            print(f"TLS Connection Analysis: {hostname}")
            print("=" * 60)
            
            # Protocol version
            print(f"Protocol Version: {ssock.version()}")
            
            # Cipher suite
            cipher = ssock.cipher()
            print(f"\nCipher Suite:")
            print(f"  Name: {cipher[0]}")
            print(f"  Protocol: {cipher[1]}")
            print(f"  Key Bits: {cipher[2]}")
            
            # Certificate info
            cert = ssock.getpeercert()
            print(f"\nCertificate Info:")
            print(f"  Subject: {dict(x[0] for x in cert['subject'])}")
            print(f"  Issuer: {dict(x[0] for x in cert['issuer'])}")
            print(f"  Valid From: {cert['notBefore']}")
            print(f"  Valid Until: {cert['notAfter']}")
            
            # Subject Alternative Names
            if 'subjectAltName' in cert:
                sans = [x[1] for x in cert['subjectAltName']]
                print(f"  SANs: {sans[:5]}{'...' if len(sans) > 5 else ''}")
            
            return cert

# Example usage
print("Analyzing TLS connection to google.com...")
print("(This requires network access)")
print()

# Uncomment to run:
# analyze_tls_connection('google.com')

# Show available ciphers
print("\nDefault cipher list on this system:")
context = ssl.create_default_context()
ciphers = context.get_ciphers()
for i, cipher in enumerate(ciphers[:5]):
    print(f"  {i+1}. {cipher['name']}")
print(f"  ... and {len(ciphers) - 5} more")
</code></pre>
                </div>

                <!-- Certificates Section -->
                <div id="certificates" class="blog-content mt-5">
                    <h2><i class="fas fa-certificate me-2 text-teal"></i>Certificates & PKI</h2>

                    <p><strong>X.509 certificates</strong> are digital documents that bind a public key to an identity. They're the foundation of internet trust.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">X.509 Structure</span>
                        </div>
                        <h4>Certificate Contents</h4>
<pre><code class="language-bash">X.509 v3 Certificate Structure:
┌─────────────────────────────────────────────────────────────┐
│ Version: 3                                                  │
│ Serial Number: Unique identifier                            │
│ Signature Algorithm: e.g., SHA256withRSA                    │
├─────────────────────────────────────────────────────────────┤
│ Issuer: CA that signed this certificate                     │
│   CN=DigiCert Global Root G2, O=DigiCert Inc, C=US          │
├─────────────────────────────────────────────────────────────┤
│ Validity:                                                   │
│   Not Before: Jan 01 00:00:00 2024 GMT                      │
│   Not After:  Jan 01 00:00:00 2025 GMT                      │
├─────────────────────────────────────────────────────────────┤
│ Subject: Entity this certificate identifies                 │
│   CN=www.example.com, O=Example Inc, L=City, C=US           │
├─────────────────────────────────────────────────────────────┤
│ Subject Public Key Info:                                    │
│   Algorithm: RSA (2048 bits) or ECDSA (P-256)               │
│   Public Key: [binary data]                                 │
├─────────────────────────────────────────────────────────────┤
│ X.509v3 Extensions:                                         │
│   Key Usage: Digital Signature, Key Encipherment            │
│   Extended Key Usage: TLS Web Server Authentication         │
│   Subject Alternative Name: DNS:www.example.com,            │
│                             DNS:example.com                 │
│   Basic Constraints: CA:FALSE                               │
│   Authority Key Identifier: [CA's key ID]                   │
│   CRL Distribution Points: [URL to CRL]                     │
│   Authority Info Access: OCSP - [URL]                       │
├─────────────────────────────────────────────────────────────┤
│ Signature: CA's signature over all the above                │
└─────────────────────────────────────────────────────────────┘
</code></pre>
                    </div>

                    <h3 id="certificate-chain">Certificate Chain of Trust</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">Trust Chain</span>
                        </div>
                        <h4>How Certificate Validation Works</h4>
<pre><code class="language-bash">Certificate Chain (Chain of Trust):

┌─────────────────────────────────┐
│       Root CA Certificate       │  ← Self-signed, pre-installed
│   (e.g., DigiCert Root CA)      │     in browser/OS trust store
│   Validity: 20+ years           │
└────────────────┬────────────────┘
                 │ Signs
                 ▼
┌─────────────────────────────────┐
│    Intermediate CA Certificate  │  ← Signed by Root CA
│   (e.g., DigiCert TLS RSA)      │     Stored on server
│   Validity: 5-10 years          │
└────────────────┬────────────────┘
                 │ Signs
                 ▼
┌─────────────────────────────────┐
│    End-Entity Certificate       │  ← Your website's cert
│   (e.g., www.example.com)       │     Signed by Intermediate
│   Validity: 1-2 years           │
└─────────────────────────────────┘

Validation Process:
1. Server sends: End-Entity + Intermediate cert(s)
2. Browser verifies End-Entity signature with Intermediate's public key
3. Browser verifies Intermediate signature with Root's public key
4. Root is in browser's trust store → TRUSTED
5. Check validity dates, revocation status (CRL/OCSP)
6. Check hostname matches certificate's CN or SAN
</code></pre>
                    </div>

<pre><code class="language-bash"># Examine certificates with OpenSSL

# View certificate details
openssl s_client -connect google.com:443 -showcerts < /dev/null 2>/dev/null | \
    openssl x509 -text -noout

# Get certificate chain
openssl s_client -connect google.com:443 -showcerts < /dev/null

# Check certificate expiration
echo | openssl s_client -connect google.com:443 2>/dev/null | \
    openssl x509 -noout -dates

# Verify certificate chain
openssl verify -CAfile /etc/ssl/certs/ca-certificates.crt cert.pem

# Generate self-signed certificate (for testing)
openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem \
    -days 365 -nodes -subj "/CN=localhost"

# Convert certificate formats
openssl x509 -in cert.pem -outform DER -out cert.der  # PEM to DER
openssl x509 -in cert.der -inform DER -outform PEM -out cert.pem  # DER to PEM
</code></pre>

                    <h3 id="pki">Public Key Infrastructure (PKI)</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">PKI Components</span>
                        </div>
                        <h4>PKI Ecosystem</h4>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Component</th>
                                    <th>Role</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Certificate Authority (CA)</strong></td>
                                    <td>Issues and signs certificates. Root CAs are trusted by default.</td>
                                </tr>
                                <tr>
                                    <td><strong>Registration Authority (RA)</strong></td>
                                    <td>Verifies identity before CA issues cert (domain validation, org validation).</td>
                                </tr>
                                <tr>
                                    <td><strong>Certificate Revocation List (CRL)</strong></td>
                                    <td>List of revoked certificates. Published periodically by CA.</td>
                                </tr>
                                <tr>
                                    <td><strong>OCSP (Online Certificate Status Protocol)</strong></td>
                                    <td>Real-time certificate status checking. More efficient than CRL.</td>
                                </tr>
                                <tr>
                                    <td><strong>OCSP Stapling</strong></td>
                                    <td>Server includes OCSP response in TLS handshake. Better privacy.</td>
                                </tr>
                                <tr>
                                    <td><strong>Certificate Transparency (CT)</strong></td>
                                    <td>Public logs of all issued certificates. Detects rogue CAs.</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="highlight-box">
                        <i class="fas fa-shield-alt"></i>
                        <strong>Let's Encrypt Revolution:</strong> Since 2015, Let's Encrypt has issued billions of free certificates, making HTTPS accessible to everyone. They automated Domain Validation (DV) via the ACME protocol, which tools like Certbot use.
                    </div>
                </div>

                <!-- Cryptography Section -->
                <div id="cryptography" class="blog-content mt-5">
                    <h2><i class="fas fa-key me-2 text-teal"></i>Cryptography Basics</h2>

                    <p>Understanding cryptographic primitives helps you make informed security decisions and debug TLS issues.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">Symmetric Encryption</span>
                        </div>
                        <h4>Symmetric (Secret Key) Cryptography</h4>
                        <p>Same key for encryption and decryption. Fast, used for bulk data.</p>
<pre><code class="language-bash">Symmetric Encryption:

Plaintext ─────► [Encrypt with Key K] ─────► Ciphertext
                        │
                        │ Same key
                        ▼
Ciphertext ────► [Decrypt with Key K] ─────► Plaintext

Common Algorithms:
┌────────────────┬─────────────┬─────────────────────────────────┐
│ Algorithm      │ Key Size    │ Notes                           │
├────────────────┼─────────────┼─────────────────────────────────┤
│ AES-128        │ 128 bits    │ Fast, secure, hardware support  │
│ AES-256        │ 256 bits    │ Quantum-resistant key size      │
│ ChaCha20       │ 256 bits    │ Fast on mobile (no AES-NI)      │
│ 3DES           │ 168 bits    │ Legacy, avoid                   │
└────────────────┴─────────────┴─────────────────────────────────┘

Block Cipher Modes:
- GCM (Galois/Counter Mode): AEAD, parallelizable, preferred
- CBC (Cipher Block Chaining): Vulnerable to padding oracle, avoid
- CTR (Counter Mode): Streaming, needs separate MAC
</code></pre>
                    </div>

                    <h3 id="asymmetric">Asymmetric (Public Key) Cryptography</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">Asymmetric Encryption</span>
                        </div>
                        <h4>Public/Private Key Pairs</h4>
<pre><code class="language-bash">Asymmetric Encryption:

For Encryption (confidentiality):
Plaintext ─────► [Encrypt with Public Key] ─────► Ciphertext
Ciphertext ────► [Decrypt with Private Key] ────► Plaintext

For Digital Signatures (authentication):
Message ────────► [Sign with Private Key] ──────► Signature
Message+Sig ────► [Verify with Public Key] ─────► Valid/Invalid

Key Exchange (Diffie-Hellman):
Alice: a (private), g^a (public)
Bob:   b (private), g^b (public)
Both compute: g^(ab) = shared secret

Common Algorithms:
┌────────────────┬─────────────────┬────────────────────────────┐
│ Algorithm      │ Key Size        │ Use Case                   │
├────────────────┼─────────────────┼────────────────────────────┤
│ RSA            │ 2048-4096 bits  │ Encryption, signatures     │
│ ECDSA          │ 256-384 bits    │ Signatures (P-256, P-384)  │
│ Ed25519        │ 256 bits        │ Modern signatures, fast    │
│ ECDH           │ 256-384 bits    │ Key exchange               │
│ X25519         │ 256 bits        │ Modern key exchange        │
└────────────────┴─────────────────┴────────────────────────────┘

Why Both?
- Asymmetric: Solves key distribution (can share public key openly)
- Symmetric: Much faster (1000x) for bulk encryption
- TLS uses asymmetric to exchange symmetric keys, then symmetric for data
</code></pre>
                    </div>

                    <h3 id="hashing">Hashing and MACs</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">Hash Functions</span>
                        </div>
                        <h4>Cryptographic Hash Functions</h4>
<pre><code class="language-bash">Hash Function Properties:
- Deterministic: Same input → same output
- One-way: Cannot reverse hash to get input
- Collision-resistant: Hard to find two inputs with same hash
- Avalanche effect: Small input change → completely different hash

Common Hash Functions:
┌─────────────┬────────────┬───────────────────────────────────┐
│ Algorithm   │ Output     │ Status                            │
├─────────────┼────────────┼───────────────────────────────────┤
│ MD5         │ 128 bits   │ ❌ Broken, collisions found       │
│ SHA-1       │ 160 bits   │ ❌ Deprecated, collisions found   │
│ SHA-256     │ 256 bits   │ ✅ Secure, widely used            │
│ SHA-384     │ 384 bits   │ ✅ Secure                         │
│ SHA-512     │ 512 bits   │ ✅ Secure                         │
│ SHA-3       │ Variable   │ ✅ Secure, backup to SHA-2        │
│ BLAKE2/3    │ Variable   │ ✅ Fast, secure                   │
└─────────────┴────────────┴───────────────────────────────────┘

MAC (Message Authentication Code):
- Hash + Secret Key = MAC
- Verifies integrity AND authenticity
- HMAC-SHA256: HMAC(key, message) = hash
- Modern: Use AEAD modes (GCM) which include MAC
</code></pre>
                    </div>

<pre><code class="language-python"># Cryptography examples in Python
import hashlib
import hmac
import secrets

# Hashing
def demonstrate_hashing():
    """Show different hash algorithms"""
    message = b"Hello, TLS!"
    
    print("Hashing Examples")
    print("=" * 60)
    print(f"Message: {message.decode()}")
    print()
    
    algorithms = ['md5', 'sha1', 'sha256', 'sha384', 'sha512']
    
    for algo in algorithms:
        h = hashlib.new(algo, message)
        status = "❌ Broken" if algo in ['md5', 'sha1'] else "✅ Secure"
        print(f"{algo.upper():10} ({h.digest_size * 8} bits) {status}")
        print(f"  {h.hexdigest()}")
        print()

demonstrate_hashing()

# HMAC (Message Authentication Code)
def demonstrate_hmac():
    """Show HMAC usage"""
    key = secrets.token_bytes(32)  # 256-bit key
    message = b"Transfer $1000 to account 12345"
    
    # Create HMAC
    mac = hmac.new(key, message, hashlib.sha256)
    
    print("HMAC Example")
    print("=" * 60)
    print(f"Message: {message.decode()}")
    print(f"Key: {key.hex()[:32]}...")
    print(f"HMAC-SHA256: {mac.hexdigest()}")
    print()
    
    # Verify HMAC
    received_mac = mac.hexdigest()
    verification = hmac.compare_digest(
        mac.hexdigest(),
        received_mac
    )
    print(f"Verification: {'✅ Valid' if verification else '❌ Invalid'}")

demonstrate_hmac()

# Key derivation (for passwords)
def demonstrate_key_derivation():
    """Show secure password hashing"""
    import hashlib
    
    password = b"user_password_123"
    salt = secrets.token_bytes(16)  # Random salt
    
    # PBKDF2 - Password-Based Key Derivation Function
    derived_key = hashlib.pbkdf2_hmac(
        'sha256',
        password,
        salt,
        iterations=100000,  # High iteration count
        dklen=32
    )
    
    print("Password Key Derivation (PBKDF2)")
    print("=" * 60)
    print(f"Password: {password.decode()}")
    print(f"Salt: {salt.hex()}")
    print(f"Iterations: 100,000")
    print(f"Derived Key: {derived_key.hex()}")
    print()
    print("Store: salt + derived_key (never the password!)")

demonstrate_key_derivation()
</code></pre>
                </div>

                <!-- Serialization Section -->
                <div id="serialization" class="blog-content mt-5">
                    <h2><i class="fas fa-file-code me-2 text-teal"></i>Data Serialization</h2>

                    <p>The Presentation Layer handles converting data between application format and network format. Serialization formats determine efficiency and interoperability.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">Text Formats</span>
                        </div>
                        <h4>Human-Readable Formats</h4>
<pre><code class="language-bash">JSON (JavaScript Object Notation):
{
    "name": "Alice",
    "age": 30,
    "active": true,
    "roles": ["admin", "user"]
}
Pros: Human-readable, universal support, simple
Cons: Verbose, no schema, no comments, limited types

XML (Extensible Markup Language):
&lt;user&gt;
    &lt;name&gt;Alice&lt;/name&gt;
    &lt;age&gt;30&lt;/age&gt;
    &lt;active&gt;true&lt;/active&gt;
    &lt;roles&gt;
        &lt;role&gt;admin&lt;/role&gt;
        &lt;role&gt;user&lt;/role&gt;
    &lt;/roles&gt;
&lt;/user&gt;
Pros: Self-describing, schema support (XSD), namespaces
Cons: Very verbose, complex, slow parsing

YAML (YAML Ain't Markup Language):
name: Alice
age: 30
active: true
roles:
  - admin
  - user
Pros: Very readable, comments, complex structures
Cons: Whitespace-sensitive, security risks (code execution)
</code></pre>
                    </div>

                    <h3 id="binary-formats">Binary Formats</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">Binary Formats</span>
                        </div>
                        <h4>Efficient Binary Serialization</h4>
<pre><code class="language-bash">Protocol Buffers (Google):
// .proto schema file
message User {
    string name = 1;
    int32 age = 2;
    bool active = 3;
    repeated string roles = 4;
}
Pros: Very compact, fast, schema-based, code generation
Cons: Not human-readable, requires schema, Google ecosystem

MessagePack:
Similar to JSON but binary-encoded
Pros: JSON-compatible, compact, fast, no schema needed
Cons: Less tooling than Protobuf

Apache Avro:
Schema embedded or separate, dynamic typing
Pros: Schema evolution, compact, Hadoop ecosystem
Cons: More complex, less common outside big data

Apache Thrift (Facebook):
RPC framework with serialization
Pros: Multi-language, includes RPC, flexible
Cons: Complex, heavy

FlatBuffers (Google):
Zero-copy deserialization
Pros: Extremely fast access, no parsing needed
Cons: Complex schemas, larger than Protobuf

Cap'n Proto:
Zero-copy, no encoding step
Pros: Fastest serialization (none needed)
Cons: Less portable, complex
</code></pre>
                    </div>

                    <h3 id="format-comparison">Format Comparison</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">Comparison</span>
                        </div>
                        <h4>Serialization Format Trade-offs</h4>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Format</th>
                                    <th>Size</th>
                                    <th>Speed</th>
                                    <th>Human-Readable</th>
                                    <th>Schema</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>JSON</td>
                                    <td>Large</td>
                                    <td>Slow</td>
                                    <td>✅ Yes</td>
                                    <td>Optional</td>
                                </tr>
                                <tr>
                                    <td>XML</td>
                                    <td>Very Large</td>
                                    <td>Slowest</td>
                                    <td>✅ Yes</td>
                                    <td>Optional (XSD)</td>
                                </tr>
                                <tr>
                                    <td>YAML</td>
                                    <td>Medium</td>
                                    <td>Slow</td>
                                    <td>✅ Yes</td>
                                    <td>No</td>
                                </tr>
                                <tr>
                                    <td>MessagePack</td>
                                    <td>Small</td>
                                    <td>Fast</td>
                                    <td>❌ No</td>
                                    <td>No</td>
                                </tr>
                                <tr>
                                    <td>Protobuf</td>
                                    <td>Smallest</td>
                                    <td>Very Fast</td>
                                    <td>❌ No</td>
                                    <td>Required</td>
                                </tr>
                                <tr>
                                    <td>Avro</td>
                                    <td>Small</td>
                                    <td>Fast</td>
                                    <td>❌ No</td>
                                    <td>Required</td>
                                </tr>
                                <tr>
                                    <td>FlatBuffers</td>
                                    <td>Medium</td>
                                    <td>Fastest Read</td>
                                    <td>❌ No</td>
                                    <td>Required</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

<pre><code class="language-python"># Compare serialization formats in Python
import json
import sys

# Sample data
user_data = {
    "id": 12345,
    "name": "Alice Johnson",
    "email": "alice@example.com",
    "age": 30,
    "active": True,
    "roles": ["admin", "developer", "reviewer"],
    "metadata": {
        "created": "2024-01-15T10:30:00Z",
        "last_login": "2024-01-20T14:22:00Z",
        "login_count": 42
    }
}

print("Serialization Format Comparison")
print("=" * 60)

# JSON
json_data = json.dumps(user_data)
json_pretty = json.dumps(user_data, indent=2)
print(f"JSON (compact):  {len(json_data)} bytes")
print(f"JSON (pretty):   {len(json_pretty)} bytes")

# MessagePack (if available)
try:
    import msgpack
    msgpack_data = msgpack.packb(user_data)
    print(f"MessagePack:     {len(msgpack_data)} bytes")
except ImportError:
    print("MessagePack:     (install: pip install msgpack)")

# YAML (if available)
try:
    import yaml
    yaml_data = yaml.dump(user_data)
    print(f"YAML:            {len(yaml_data)} bytes")
except ImportError:
    print("YAML:            (install: pip install pyyaml)")

print()
print("Note: Protocol Buffers requires schema definition (.proto)")
print("      and code generation - not shown in this simple example")

# Show size comparison
print()
print("Size Comparison (typical ratio to JSON):")
print("  JSON:        1.00x (baseline)")
print("  YAML:        0.95x")
print("  MessagePack: 0.70x")
print("  Protobuf:    0.50x")
print("  FlatBuffers: 0.60x")
</code></pre>
                </div>

                <!-- Compression Section -->
                <div id="compression" class="blog-content mt-5">
                    <h2><i class="fas fa-compress-alt me-2 text-teal"></i>Compression</h2>

                    <p>Compression reduces data size for faster transmission and lower bandwidth costs. The Presentation Layer handles compression/decompression transparently.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">Algorithms</span>
                        </div>
                        <h4>Compression Algorithm Comparison</h4>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Algorithm</th>
                                    <th>Ratio</th>
                                    <th>Speed</th>
                                    <th>CPU</th>
                                    <th>Use Case</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>gzip</strong></td>
                                    <td>Good</td>
                                    <td>Medium</td>
                                    <td>Medium</td>
                                    <td>HTTP, general purpose</td>
                                </tr>
                                <tr>
                                    <td><strong>deflate</strong></td>
                                    <td>Good</td>
                                    <td>Medium</td>
                                    <td>Medium</td>
                                    <td>HTTP, ZIP files</td>
                                </tr>
                                <tr>
                                    <td><strong>Brotli (br)</strong></td>
                                    <td>Best</td>
                                    <td>Slower</td>
                                    <td>Higher</td>
                                    <td>Web content (20% better than gzip)</td>
                                </tr>
                                <tr>
                                    <td><strong>zstd</strong></td>
                                    <td>Excellent</td>
                                    <td>Very Fast</td>
                                    <td>Low</td>
                                    <td>Modern apps, databases</td>
                                </tr>
                                <tr>
                                    <td><strong>LZ4</strong></td>
                                    <td>Lower</td>
                                    <td>Fastest</td>
                                    <td>Lowest</td>
                                    <td>Real-time, databases</td>
                                </tr>
                                <tr>
                                    <td><strong>Snappy</strong></td>
                                    <td>Lower</td>
                                    <td>Very Fast</td>
                                    <td>Low</td>
                                    <td>Google services, Hadoop</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 id="http-compression">HTTP Compression</h3>

<pre><code class="language-bash"># HTTP Compression Headers

# Client request - indicates supported compression
Accept-Encoding: gzip, deflate, br

# Server response - indicates applied compression
Content-Encoding: gzip

# Check compression with curl
curl -H "Accept-Encoding: gzip, deflate, br" -I https://google.com

# Compare compressed vs uncompressed size
curl -so /dev/null -w "Uncompressed: %{size_download} bytes\n" https://example.com
curl -so /dev/null -w "Compressed: %{size_download} bytes\n" \
     -H "Accept-Encoding: gzip" https://example.com

# Decompress gzip response
curl -H "Accept-Encoding: gzip" https://example.com | gunzip

# nginx configuration for compression
# gzip on;
# gzip_types text/plain text/css application/json application/javascript;
# gzip_min_length 1000;
# gzip_comp_level 6;
</code></pre>

<pre><code class="language-python"># Compression comparison in Python
import gzip
import zlib
import json
import time

# Sample data (realistic JSON payload)
data = {
    "users": [
        {"id": i, "name": f"User {i}", "email": f"user{i}@example.com", 
         "bio": "Lorem ipsum dolor sit amet " * 10}
        for i in range(100)
    ]
}

original = json.dumps(data).encode()
print("Compression Comparison")
print("=" * 60)
print(f"Original size: {len(original):,} bytes")
print()

# Test different compression methods
results = []

# gzip
start = time.time()
gzipped = gzip.compress(original, compresslevel=9)
gzip_time = time.time() - start
results.append(("gzip", len(gzipped), gzip_time))

# zlib (deflate)
start = time.time()
deflated = zlib.compress(original, level=9)
deflate_time = time.time() - start
results.append(("deflate", len(deflated), deflate_time))

# Try brotli if available
try:
    import brotli
    start = time.time()
    br_compressed = brotli.compress(original, quality=11)
    br_time = time.time() - start
    results.append(("brotli", len(br_compressed), br_time))
except ImportError:
    results.append(("brotli", None, None))

# Try zstd if available
try:
    import zstandard
    start = time.time()
    cctx = zstandard.ZstdCompressor(level=19)
    zstd_compressed = cctx.compress(original)
    zstd_time = time.time() - start
    results.append(("zstd", len(zstd_compressed), zstd_time))
except ImportError:
    results.append(("zstd", None, None))

# Print results
print(f"{'Algorithm':<12} {'Compressed':<12} {'Ratio':<8} {'Time':<10}")
print("-" * 42)

for name, size, compress_time in results:
    if size is not None:
        ratio = len(original) / size
        print(f"{name:<12} {size:>8,} B   {ratio:.2f}x    {compress_time*1000:.2f}ms")
    else:
        print(f"{name:<12} (not installed)")

print()
print("Install optional: pip install brotli zstandard")
</code></pre>

                    <div class="highlight-box">
                        <i class="fas fa-tachometer-alt"></i>
                        <strong>Compression Best Practices:</strong>
                        <ul class="mb-0 mt-2">
                            <li><strong>Text content:</strong> Always compress (HTML, CSS, JS, JSON) - 70-90% reduction</li>
                            <li><strong>Images:</strong> Don't compress (JPEG, PNG already compressed)</li>
                            <li><strong>Brotli for static:</strong> Pre-compress static files with Brotli at high quality</li>
                            <li><strong>gzip for dynamic:</strong> Faster for on-the-fly compression</li>
                            <li><strong>Min size:</strong> Don't compress files under 1KB (overhead > savings)</li>
                        </ul>
                    </div>
                </div>

                <!-- Hands-On Section -->
                <div id="hands-on" class="blog-content mt-5">
                    <h2><i class="fas fa-laptop-code me-2 text-teal"></i>Hands-On Exercises</h2>

<pre><code class="language-python"># Complete TLS analysis tool
import ssl
import socket
import hashlib
from datetime import datetime

def full_tls_analysis(hostname, port=443):
    """Comprehensive TLS connection analysis"""
    
    print(f"TLS Analysis: {hostname}:{port}")
    print("=" * 70)
    
    context = ssl.create_default_context()
    
    try:
        with socket.create_connection((hostname, port), timeout=10) as sock:
            with context.wrap_socket(sock, server_hostname=hostname) as ssock:
                
                # Connection info
                print("\n[Connection Info]")
                print(f"  Protocol: {ssock.version()}")
                cipher = ssock.cipher()
                print(f"  Cipher Suite: {cipher[0]}")
                print(f"  Key Exchange Bits: {cipher[2]}")
                
                # Certificate
                cert = ssock.getpeercert()
                cert_bin = ssock.getpeercert(binary_form=True)
                
                print("\n[Certificate]")
                subject = dict(x[0] for x in cert['subject'])
                print(f"  Subject CN: {subject.get('commonName', 'N/A')}")
                
                issuer = dict(x[0] for x in cert['issuer'])
                print(f"  Issuer: {issuer.get('organizationName', 'N/A')}")
                
                # Parse dates
                not_before = cert['notBefore']
                not_after = cert['notAfter']
                print(f"  Valid From: {not_before}")
                print(f"  Valid Until: {not_after}")
                
                # Certificate fingerprint
                sha256_fp = hashlib.sha256(cert_bin).hexdigest()
                print(f"  SHA-256 Fingerprint: {sha256_fp[:32]}...")
                
                # SANs
                if 'subjectAltName' in cert:
                    sans = [x[1] for x in cert['subjectAltName'] if x[0] == 'DNS']
                    print(f"  Subject Alt Names: {len(sans)} domains")
                    for san in sans[:3]:
                        print(f"    - {san}")
                    if len(sans) > 3:
                        print(f"    ... and {len(sans) - 3} more")
                
                # Security assessment
                print("\n[Security Assessment]")
                
                version = ssock.version()
                if version == 'TLSv1.3':
                    print("  ✅ TLS 1.3 - Excellent")
                elif version == 'TLSv1.2':
                    print("  ✅ TLS 1.2 - Good")
                else:
                    print(f"  ⚠️ {version} - Outdated, upgrade recommended")
                
                # Check cipher strength
                if 'GCM' in cipher[0] or 'CHACHA' in cipher[0]:
                    print("  ✅ AEAD cipher mode")
                else:
                    print("  ⚠️ Non-AEAD cipher, consider upgrading")
                
                if 'ECDHE' in cipher[0] or 'DHE' in cipher[0]:
                    print("  ✅ Forward secrecy enabled")
                else:
                    print("  ⚠️ No forward secrecy")
                
                return True
                
    except ssl.SSLCertVerificationError as e:
        print(f"\n❌ Certificate Error: {e}")
        return False
    except socket.timeout:
        print(f"\n❌ Connection timeout")
        return False
    except Exception as e:
        print(f"\n❌ Error: {e}")
        return False

# Example (uncomment to run)
print("TLS Analysis Tool")
print("=" * 70)
print("Usage: full_tls_analysis('google.com')")
print()
print("Example output would show:")
print("  - TLS version and cipher suite")
print("  - Certificate details and validity")
print("  - Security assessment")
</code></pre>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">Self-Assessment</span>
                        </div>
                        <h4>Quiz: Test Your Knowledge</h4>
                        <ol>
                            <li>What's the minimum recommended TLS version? <em>(TLS 1.2, prefer 1.3)</em></li>
                            <li>How many RTTs does TLS 1.3 need for a full handshake? <em>(1 RTT)</em></li>
                            <li>What does AEAD stand for? <em>(Authenticated Encryption with Associated Data)</em></li>
                            <li>Which is faster: symmetric or asymmetric encryption? <em>(Symmetric, ~1000x faster)</em></li>
                            <li>What does forward secrecy protect against? <em>(Future key compromise decrypting past traffic)</em></li>
                            <li>What's the most compact serialization format? <em>(Protocol Buffers)</em></li>
                            <li>Which HTTP compression has the best ratio? <em>(Brotli)</em></li>
                            <li>What verifies a certificate wasn't revoked? <em>(OCSP or CRL)</em></li>
                        </ol>
                    </div>
                </div>

                <!-- Summary Section -->
                <div id="summary" class="blog-content mt-5">
                    <h2><i class="fas fa-check-circle me-2 text-teal"></i>Summary & Next Steps</h2>

                    <div class="highlight-box">
                        <i class="fas fa-graduation-cap"></i>
                        <strong>Key Takeaways:</strong>
                        <ul class="mt-2 mb-0">
                            <li><strong>TLS</strong> provides encryption, integrity, and authentication for secure communication</li>
                            <li><strong>TLS 1.3</strong> is faster (1-RTT), simpler, and more secure than 1.2</li>
                            <li><strong>Certificates</strong> bind public keys to identities; trust chains verify them</li>
                            <li><strong>Symmetric encryption</strong> (AES) is fast for data; <strong>asymmetric</strong> (RSA/ECDH) for key exchange</li>
                            <li><strong>Serialization formats</strong> trade off readability, size, and speed (JSON vs Protobuf)</li>
                            <li><strong>Compression</strong> (gzip, Brotli) reduces bandwidth significantly for text content</li>
                        </ul>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">Quick Reference</span>
                        </div>
                        <h4>Security Cheat Sheet</h4>
                        <ul>
                            <li><strong>TLS Version:</strong> Use TLS 1.2+ (prefer 1.3)</li>
                            <li><strong>Cipher Suites:</strong> ECDHE + AES-GCM or ChaCha20-Poly1305</li>
                            <li><strong>Key Size:</strong> RSA 2048+, ECDSA P-256+, Ed25519</li>
                            <li><strong>Hashing:</strong> SHA-256+ (never MD5 or SHA-1)</li>
                            <li><strong>Certificates:</strong> Use Let's Encrypt, enable OCSP stapling</li>
                        </ul>
                    </div>

                    <div class="series-next">
                        <h4><i class="fas fa-arrow-right me-2"></i>Next in the Series</h4>
                        <p>In <a href="protocols-master-web-protocols.html"><strong>Part 6: Web Protocols</strong></a>, we'll explore HTTP/1.1, HTTP/2, HTTP/3, and WebSockets. Learn how web communication evolved from simple request-response to multiplexed, bidirectional, real-time connections.</p>
                    </div>
                </div>

                <!-- Related Articles -->
                <div id="related" class="blog-content mt-5">
                    <h2><i class="fas fa-book-reader me-2 text-teal"></i>Continue the Series</h2>

                    <div class="related-posts">
                        <h3><i class="fas fa-arrow-right me-2"></i>Navigation</h3>
                        <div class="related-post-item">
                            <h5>Part 4: Transport Layer</h5>
                            <p>Review TCP, UDP, QUIC, and reliable data delivery.</p>
                            <a href="protocols-master-transport-layer.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                        <div class="related-post-item">
                            <h5>Part 6: Web Protocols</h5>
                            <p>Explore HTTP/1.1, HTTP/2, HTTP/3, and WebSockets.</p>
                            <a href="protocols-master-web-protocols.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                        <div class="related-post-item">
                            <h5>Part 17: Security Protocols</h5>
                            <p>Deep dive into IPsec, SSH, and advanced security topics.</p>
                            <a href="protocols-master-security-protocols.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                    </div>
                </div>

                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="social-media" class="bg-dark text-light py-5">
        <div class="container py-5">
            <div class="row mb-4">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h5 class="fw-bold mb-3">Let's Connect</h5>
                    <p class="text-light">I'm always interested in sharing content about my interests on different topics. Read disclaimer and feel free to share further.</p>
                </div>
                <div class="col-lg-6">
                    <h5 class="fw-bold mb-3">Follow Me</h5>
                    <div class="social-links d-flex gap-2 flex-wrap">
                        <a href="https://www.facebook.com/wasil.zafar/" target="_blank" class="social-icon" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://twitter.com/wasilzafar" target="_blank" class="social-icon" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.linkedin.com/in/wasilzafar" target="_blank" class="social-icon" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@wasilzafar" target="_blank" class="social-icon" title="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://www.instagram.com/itswzee/" target="_blank" class="social-icon" title="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="https://in.pinterest.com/wasilz/" target="_blank" class="social-icon" title="Pinterest"><i class="fab fa-pinterest-p"></i></a>
                        <a href="mailto:wasil.zafar@gmail.com" class="social-icon" title="Email"><i class="fas fa-envelope"></i></a>
                    </div>
                </div>
            </div>
            <hr class="bg-secondary">
            <div class="row mt-4">
                <div class="col-md-6">
                    <p class="small"><i class="fas fa-icons me-2"></i>Icons from <a href="https://www.flaticon.com/" target="_blank" class="text-light">Flaticon</a> &amp; <a href="https://fontawesome.com/" target="_blank" class="text-light">Font Awesome</a></p>
                    <p class="small mt-3"><a href="/" class="text-light text-decoration-none">Home</a> | <a href="/disclaimer.html" class="text-light text-decoration-none">Disclaimer</a> | <a href="/privacy-policy.html" class="text-light text-decoration-none">Privacy Policy</a></p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small">Enjoying this content? ☕ <a href="https://buymeacoffee.com/itswzee" target="_blank" class="text-light" style="text-decoration: underline;">Keep me caffeinated</a> to keep the pixels flowing!</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Scroll-to-Top Button -->
    <button id="scrollToTop" class="scroll-to-top" title="Back to Top"><i class="fas fa-arrow-up"></i></button>
    <div id="categoryIndicator" class="category-indicator"></div>
    
    <!-- Cookie Consent JS -->
    <script src="../../../js/cookie-consent.js"></script>
    
    <!-- Main JS -->
    <script src="../../../js/main.js"></script>

    <!-- Prism.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
</body>
</html>
