<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="robots" content="index, archive" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Master security protocols: TLS 1.3 deep-dive, X.509 certificates, PKI infrastructure, cipher suites, and certificate validation chains." />
    <meta name="author" content="Wasil Zafar" />
    <meta name="keywords" content="TLS, SSL, X.509, Certificates, PKI, HTTPS, Encryption, Cipher Suite, Certificate Chain, CA" />
    <meta property="og:title" content="Complete Protocols Master Part 17: Security Protocols" />
    <meta property="og:description" content="Comprehensive guide to TLS, certificates, PKI, and cryptographic protocols securing the internet." />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2026-01-31" />
    <meta property="article:author" content="Wasil Zafar" />
    <meta property="article:section" content="Technology" />
    
    <title>Complete Protocols Master Part 17: Security Protocols - Wasil Zafar</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" id="prism-theme" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" />
    <link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon_io/favicon-32x32.png">

    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('consent', 'default', {'ad_storage': 'denied', 'analytics_storage': 'denied', 'region': ['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE']});
        gtag('consent', 'default', {'ad_storage': 'granted', 'analytics_storage': 'granted'});
    </script>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s);j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PBS8M2JR');</script>
</head>
<body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBS8M2JR" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/"><span class="gradient-text">Wasil Zafar</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#skills">Skills</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#certifications">Certifications</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#interests">Interests</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="blog-hero">
        <div class="container py-5">
            <div class="blog-header">
                <a href="/pages/categories/technology.html" class="back-link"><i class="fas fa-arrow-left me-2"></i>Back to Technology</a>
                <h1 class="display-4 fw-bold mb-3">Complete Protocols Master Part 17: Security Protocols</h1>
                <div class="blog-meta">
                    <span><i class="fas fa-calendar me-2"></i>January 31, 2026</span>
                    <span><i class="fas fa-user me-2"></i>Wasil Zafar</span>
                    <span class="reading-time"><i class="fas fa-clock me-1"></i>45 min read</span>
                    <button onclick="window.print()" class="print-btn"><i class="fas fa-print"></i> Print</button>
                </div>
                <p class="lead">Deep-dive into TLS 1.3, X.509 certificates, PKI infrastructure, and the cryptographic protocols that secure internet communication.</p>
            </div>
        </div>
    </section>

    <button class="toc-toggle-btn" onclick="openNav()"><i class="fas fa-list"></i></button>
    <div id="tocSidenav" class="sidenav-toc">
        <div class="toc-header">
            <h3><i class="fas fa-list me-2"></i>Table of Contents</h3>
            <button class="closebtn" onclick="closeNav()">&times;</button>
        </div>
        <ol>
            <li><a href="#introduction" onclick="closeNav()">Introduction</a></li>
            <li><a href="#tls" onclick="closeNav()">TLS Protocol</a></li>
            <li><a href="#certificates" onclick="closeNav()">X.509 Certificates</a></li>
            <li><a href="#pki" onclick="closeNav()">PKI Infrastructure</a></li>
            <li><a href="#ciphers" onclick="closeNav()">Cipher Suites</a></li>
            <li><a href="#validation" onclick="closeNav()">Certificate Validation</a></li>
            <li><a href="#summary" onclick="closeNav()">Summary</a></li>
        </ol>
    </div>
    <div id="tocOverlay" class="sidenav-overlay" onclick="closeNav()"></div>

    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">

                <div id="introduction" class="blog-content">
                    <h2><i class="fas fa-shield-alt me-2 text-teal"></i>Introduction: The Cryptographic Web</h2>
                    
                    <p>Every time you see the padlock in your browser, TLS is at work. It's the foundation of web security—encrypting data, verifying server identity, and ensuring integrity of communication.</p>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-sitemap me-2"></i>
                        <strong>Series Context:</strong> This is <strong>Part 17 of 20</strong> in the Complete Protocols Master series. TLS operates at the Presentation/Session layers, securing Application Layer protocols like HTTP, SMTP, and IMAP.
                    </div>

                    <div class="experiment-card" id="series-nav">
                        <h4><i class="fas fa-map-signs me-2"></i>Complete Series Navigation</h4>
                        <div class="meta mb-2">
                            <span class="badge bg-teal me-2">20-Part Series</span>
                            <span class="badge bg-crimson">Protocol Mastery</span>
                        </div>
                        <div class="content">
                            <ol>
                                <li><a href="protocols-master-osi-foundations.html"><strong>Part 1:</strong> OSI Model & Protocol Foundations</a> — Network layers, encapsulation, TCP/IP model</li>
                                <li><a href="protocols-master-physical-datalink.html"><strong>Part 2:</strong> Physical & Data Link Layers</a> — Ethernet, Wi-Fi, VLANs, MAC addressing</li>
                                <li><a href="protocols-master-network-layer.html"><strong>Part 3:</strong> Network Layer & IP</a> — IPv4, IPv6, ICMP, routing protocols</li>
                                <li><a href="protocols-master-transport-layer.html"><strong>Part 4:</strong> Transport Layer</a> — TCP, UDP, QUIC, ports, sockets</li>
                                <li><a href="protocols-master-session-presentation.html"><strong>Part 5:</strong> Session & Presentation Layers</a> — TLS handshake, encryption, serialization</li>
                                <li><a href="protocols-master-web-protocols.html"><strong>Part 6:</strong> Web Protocols</a> — HTTP/1.1, HTTP/2, HTTP/3, WebSockets</li>
                                <li><a href="protocols-master-api-protocols.html"><strong>Part 7:</strong> API Protocols</a> — REST, GraphQL, gRPC, SOAP</li>
                                <li><a href="protocols-master-dns-deep-dive.html"><strong>Part 8:</strong> DNS Deep Dive</a> — DNS hierarchy, records, DNSSEC</li>
                                <li><a href="protocols-master-email-protocols.html"><strong>Part 9:</strong> Email Protocols</a> — SMTP, IMAP, POP3, SPF/DKIM/DMARC</li>
                                <li><a href="protocols-master-file-transfer.html"><strong>Part 10:</strong> File Transfer Protocols</a> — FTP, SFTP, SCP, rsync</li>
                                <li><a href="protocols-master-realtime-protocols.html"><strong>Part 11:</strong> Real-Time Protocols</a> — WebRTC, SIP, RTP, VoIP</li>
                                <li><a href="protocols-master-streaming-protocols.html"><strong>Part 12:</strong> Streaming Protocols</a> — HLS, DASH, RTMP, media delivery</li>
                                <li><a href="protocols-master-iot-protocols.html"><strong>Part 13:</strong> IoT Protocols</a> — MQTT, CoAP, Zigbee, LoRaWAN</li>
                                <li><a href="protocols-master-vpn-tunneling.html"><strong>Part 14:</strong> VPN & Tunneling</a> — IPsec, OpenVPN, WireGuard</li>
                                <li><a href="protocols-master-authentication-protocols.html"><strong>Part 15:</strong> Authentication Protocols</a> — OAuth, SAML, OIDC, Kerberos</li>
                                <li><a href="protocols-master-network-management.html"><strong>Part 16:</strong> Network Management</a> — SNMP, NetFlow, Syslog</li>
                                <li><strong>Part 17: Security Protocols (This Guide)</strong> — TLS/SSL, certificates, PKI</li>
                                <li><a href="protocols-master-cloud-protocols.html"><strong>Part 18:</strong> Cloud Provider Protocols</a> — AWS, Azure, GCP APIs</li>
                                <li><a href="protocols-master-emerging-protocols.html"><strong>Part 19:</strong> Emerging Protocols</a> — QUIC, HTTP/3, WebTransport</li>
                                <li><a href="protocols-master-web-security-standards.html"><strong>Part 20:</strong> Web Security Standards</a> — CORS, CSP, HSTS, SRI</li>
                            </ol>
                        </div>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Security Goals</span></div>
                        <h4>What TLS Provides</h4>
<pre><code class="language-bash">TLS Security Properties:

1. CONFIDENTIALITY
   • Data encrypted in transit
   • Only sender/receiver can read
   • Symmetric encryption (AES, ChaCha20)

2. INTEGRITY
   • Data not modified in transit
   • Detects tampering
   • MAC or AEAD

3. AUTHENTICATION
   • Server proves identity (always)
   • Client proves identity (optional)
   • X.509 certificates

What TLS Does NOT Provide:
• Privacy (metadata visible: IPs, timing)
• Protection at rest (only in-transit)
• Protection against compromised endpoints
</code></pre>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">History</span></div>
                        <h4>SSL/TLS Evolution</h4>
                        <table class="table table-bordered">
                            <thead><tr><th>Version</th><th>Year</th><th>Status</th><th>Notes</th></tr></thead>
                            <tbody>
                                <tr><td>SSL 2.0</td><td>1995</td><td>❌ Insecure</td><td>Broken</td></tr>
                                <tr><td>SSL 3.0</td><td>1996</td><td>❌ Insecure</td><td>POODLE attack</td></tr>
                                <tr><td>TLS 1.0</td><td>1999</td><td>❌ Deprecated</td><td>BEAST vulnerable</td></tr>
                                <tr><td>TLS 1.1</td><td>2006</td><td>❌ Deprecated</td><td>Weak ciphers</td></tr>
                                <tr><td>TLS 1.2</td><td>2008</td><td>✅ Acceptable</td><td>Still widely used</td></tr>
                                <tr><td>TLS 1.3</td><td>2018</td><td>✅ Recommended</td><td>Modern, faster</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="tls" class="blog-content mt-5">
                    <h2><i class="fas fa-lock me-2 text-teal"></i>TLS Protocol Deep-Dive</h2>

                    <p>TLS 1.3 is a major improvement over 1.2—faster handshake (1-RTT), removed obsolete algorithms, and mandatory forward secrecy. Let's understand both.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">TLS 1.2</span></div>
                        <h4>TLS 1.2 Handshake</h4>
<pre><code class="language-bash">TLS 1.2 Full Handshake (2-RTT):

Client                                 Server
   |                                      |
   |--- ClientHello ----------------->    |
   |    (version, random, cipher suites,  |
   |     extensions)                      |
   |                                      |
   |<-- ServerHello -------------------|  |
   |<-- Certificate -------------------|  |
   |<-- ServerKeyExchange -------------|  |
   |<-- ServerHelloDone ---------------|  |
   |                                      |
   |--- ClientKeyExchange ------------>   |
   |--- ChangeCipherSpec ------------->   |
   |--- Finished (encrypted) --------->   |
   |                                      |
   |<-- ChangeCipherSpec --------------|  |
   |<-- Finished (encrypted) ----------|  |
   |                                      |
   [Application Data flows encrypted]

2 Round Trips before app data!
</code></pre>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">TLS 1.3</span></div>
                        <h4>TLS 1.3 Handshake (1-RTT)</h4>
<pre><code class="language-bash">TLS 1.3 Handshake (1-RTT):

Client                                 Server
   |                                      |
   |--- ClientHello ----------------->    |
   |    (supported versions, key_share,   |
   |     cipher suites)                   |
   |                                      |
   |<-- ServerHello -------------------|  |
   |<-- EncryptedExtensions -----------|  |
   |<-- Certificate -------------------|  |
   |<-- CertificateVerify -------------|  |
   |<-- Finished ----------------------|  |
   |                                      |
   |--- Finished ---------------------->  |
   |                                      |
   [Application Data flows encrypted]

Only 1 Round Trip!

TLS 1.3 also supports 0-RTT:
• Resumed connections send data immediately
• Trade-off: Replay attack possible
</code></pre>
                    </div>

<pre><code class="language-bash"># Inspect TLS connection with OpenSSL

# Connect and show certificate
openssl s_client -connect example.com:443 -showcerts

# Check TLS version and cipher
openssl s_client -connect example.com:443 2>/dev/null | \
  grep -E "Protocol|Cipher"
# Protocol  : TLSv1.3
# Cipher    : TLS_AES_256_GCM_SHA384

# Force specific TLS version
openssl s_client -connect example.com:443 -tls1_2
openssl s_client -connect example.com:443 -tls1_3

# Show certificate details
echo | openssl s_client -connect example.com:443 2>/dev/null | \
  openssl x509 -noout -text

# Check certificate expiration
echo | openssl s_client -connect example.com:443 2>/dev/null | \
  openssl x509 -noout -dates
</code></pre>

<pre><code class="language-python"># TLS connection inspection with Python

import ssl
import socket
from datetime import datetime

def inspect_tls(hostname, port=443):
    """Inspect TLS connection details"""
    
    context = ssl.create_default_context()
    
    with socket.create_connection((hostname, port)) as sock:
        with context.wrap_socket(sock, server_hostname=hostname) as tls_sock:
            
            print(f"TLS Connection to {hostname}")
            print("=" * 50)
            
            # Protocol version
            print(f"Protocol: {tls_sock.version()}")
            
            # Cipher suite
            cipher = tls_sock.cipher()
            print(f"Cipher: {cipher[0]}")
            print(f"Bits: {cipher[2]}")
            
            # Certificate
            cert = tls_sock.getpeercert()
            
            print(f"\nCertificate:")
            print(f"  Subject: {dict(x[0] for x in cert['subject'])}")
            print(f"  Issuer: {dict(x[0] for x in cert['issuer'])}")
            
            # Validity
            not_after = cert['notAfter']
            expiry = datetime.strptime(not_after, '%b %d %H:%M:%S %Y %Z')
            days_left = (expiry - datetime.now()).days
            print(f"  Expires: {not_after} ({days_left} days)")
            
            # SANs
            if 'subjectAltName' in cert:
                sans = [x[1] for x in cert['subjectAltName']]
                print(f"  SANs: {', '.join(sans[:3])}...")

# Example
# inspect_tls('google.com')

print("""
TLS 1.3 Improvements:
• 1-RTT handshake (was 2-RTT)
• 0-RTT resumption (with replay risk)
• Forward secrecy mandatory
• Removed RSA key exchange
• Removed weak ciphers (RC4, 3DES)
• Simplified cipher suite naming
""")
</code></pre>
                </div>

                <div id="certificates" class="blog-content mt-5">
                    <h2><i class="fas fa-certificate me-2 text-teal"></i>X.509 Certificates</h2>

                    <p><strong>X.509 certificates</strong> are digital documents that bind a public key to an identity. They're the foundation of internet trust—your browser trusts thousands of root CAs.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Structure</span></div>
                        <h4>Certificate Anatomy</h4>
<pre><code class="language-bash">X.509 Certificate Structure:

Certificate:
    Version: 3 (0x2)
    Serial Number: unique identifier
    
    Signature Algorithm: sha256WithRSAEncryption
    
    Issuer: CN=DigiCert Global Root CA, O=DigiCert Inc
    
    Validity:
        Not Before: Jan 1 00:00:00 2020 GMT
        Not After : Dec 31 23:59:59 2025 GMT
    
    Subject: CN=example.com, O=Example Inc
    
    Subject Public Key Info:
        Public Key Algorithm: rsaEncryption
        RSA Public Key: (2048 bit)
    
    X509v3 Extensions:
        Basic Constraints: CA:FALSE
        Key Usage: Digital Signature, Key Encipherment
        Extended Key Usage: TLS Web Server Authentication
        Subject Alternative Name:
            DNS:example.com
            DNS:www.example.com
        Authority Key Identifier: ...
        Certificate Policies: ...
        CRL Distribution Points: ...
        Authority Information Access:
            OCSP - URI:http://ocsp.digicert.com
            CA Issuers - URI:http://...
    
Signature Algorithm: sha256WithRSAEncryption
Signature: (binary signature)
</code></pre>
                    </div>

<pre><code class="language-bash"># Certificate operations with OpenSSL

# Generate private key
openssl genrsa -out server.key 2048

# Generate CSR (Certificate Signing Request)
openssl req -new -key server.key -out server.csr \
  -subj "/CN=example.com/O=Example Inc/C=US"

# Self-signed certificate (for testing)
openssl x509 -req -days 365 -in server.csr \
  -signkey server.key -out server.crt

# View certificate
openssl x509 -in server.crt -noout -text

# Verify certificate chain
openssl verify -CAfile ca-bundle.crt server.crt

# Check certificate matches key
openssl x509 -noout -modulus -in server.crt | md5sum
openssl rsa -noout -modulus -in server.key | md5sum
# Should match!

# Convert formats
openssl pkcs12 -export -in server.crt -inkey server.key -out server.pfx
openssl pkcs12 -in server.pfx -out server.pem -nodes
</code></pre>

<pre><code class="language-python"># Certificate analysis with Python

from cryptography import x509
from cryptography.hazmat.backends import default_backend
import ssl
import socket

def analyze_certificate(hostname):
    """Analyze server certificate"""
    
    # Get certificate
    context = ssl.create_default_context()
    with socket.create_connection((hostname, 443)) as sock:
        with context.wrap_socket(sock, server_hostname=hostname) as tls:
            der_cert = tls.getpeercert(binary_form=True)
    
    # Parse certificate
    cert = x509.load_der_x509_certificate(der_cert, default_backend())
    
    print(f"Certificate Analysis: {hostname}")
    print("=" * 50)
    
    # Subject
    print(f"Subject: {cert.subject.rfc4514_string()}")
    print(f"Issuer: {cert.issuer.rfc4514_string()}")
    
    # Validity
    print(f"Valid From: {cert.not_valid_before}")
    print(f"Valid Until: {cert.not_valid_after}")
    
    # Key info
    pub_key = cert.public_key()
    print(f"Key Type: {type(pub_key).__name__}")
    print(f"Key Size: {pub_key.key_size} bits")
    
    # SANs
    try:
        san = cert.extensions.get_extension_for_class(
            x509.SubjectAlternativeName)
        names = san.value.get_values_for_type(x509.DNSName)
        print(f"SANs: {names}")
    except x509.ExtensionNotFound:
        print("SANs: None")
    
    # Signature algorithm
    print(f"Signature: {cert.signature_algorithm_oid._name}")

# Example
# analyze_certificate('google.com')
</code></pre>
                </div>

                <div id="pki" class="blog-content mt-5">
                    <h2><i class="fas fa-sitemap me-2 text-teal"></i>PKI Infrastructure</h2>

                    <p><strong>PKI</strong> (Public Key Infrastructure) is the trust hierarchy that makes certificates work. Root CAs are trusted by browsers, and they sign intermediate CAs, which sign end-entity certificates.</p>

                    <div class="highlight-box">
                        <i class="fas fa-lightbulb"></i>
                        <strong>Chain of Trust:</strong> Your browser trusts ~150 root CAs. Each root can sign intermediates, which sign server certificates. If ANY CA is compromised, the whole system fails.
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">Trust Chain</span></div>
                        <h4>Certificate Chain</h4>
<pre><code class="language-bash">Certificate Trust Chain:

Root CA Certificate (self-signed)
  └── Trusted by browsers/OS
  └── Stored offline, rarely used
        |
        ↓ signs
Intermediate CA Certificate
  └── Signs end-entity certificates
  └── Limits blast radius if compromised
        |
        ↓ signs
End-Entity Certificate (your server)
  └── Presented to clients
  └── Valid for specific domain(s)

Example Chain:
1. DigiCert Global Root CA (in browser trust store)
2. DigiCert SHA2 Extended Validation Server CA
3. www.example.com

Server sends: #3 + #2 (leaf + intermediates)
Browser has: #1 (root, pre-trusted)
</code></pre>
                    </div>

<pre><code class="language-bash"># View certificate chain

# Show full chain
openssl s_client -connect example.com:443 -showcerts 2>/dev/null | \
  grep -E "s:|i:" | head -10

# Chain depth
# 0 s: CN=www.example.com (leaf)
#   i: CN=DigiCert SHA2 Extended Validation Server CA (intermediate)
# 1 s: CN=DigiCert SHA2 Extended Validation Server CA
#   i: CN=DigiCert High Assurance EV Root CA (root)

# Verify chain
openssl verify -CAfile root.crt -untrusted intermediate.crt server.crt
</code></pre>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Types</span></div>
                        <h4>Certificate Types</h4>
                        <table class="table table-bordered">
                            <thead><tr><th>Type</th><th>Validation</th><th>Indicator</th><th>Use Case</th></tr></thead>
                            <tbody>
                                <tr><td><strong>DV</strong></td><td>Domain only</td><td>Padlock</td><td>Personal sites</td></tr>
                                <tr><td><strong>OV</strong></td><td>Organization verified</td><td>Padlock</td><td>Business sites</td></tr>
                                <tr><td><strong>EV</strong></td><td>Extended validation</td><td>Padlock (was green bar)</td><td>E-commerce, banks</td></tr>
                                <tr><td><strong>Wildcard</strong></td><td>*.domain.com</td><td>Padlock</td><td>Multiple subdomains</td></tr>
                                <tr><td><strong>Multi-domain</strong></td><td>SAN list</td><td>Padlock</td><td>Multiple domains</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="ciphers" class="blog-content mt-5">
                    <h2><i class="fas fa-cogs me-2 text-teal"></i>Cipher Suites</h2>

                    <p>A <strong>cipher suite</strong> defines the algorithms used for key exchange, authentication, encryption, and integrity. TLS 1.3 simplified this significantly.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">TLS 1.2</span></div>
                        <h4>TLS 1.2 Cipher Suite Format</h4>
<pre><code class="language-bash">TLS 1.2 Cipher Suite:
TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384

Breakdown:
TLS_          Protocol
ECDHE_        Key Exchange (Elliptic Curve Diffie-Hellman Ephemeral)
RSA_          Authentication (RSA signature)
WITH_
AES_256_      Encryption (AES 256-bit)
GCM_          Mode (Galois/Counter Mode - AEAD)
SHA384        Hash for PRF (Pseudo-Random Function)

Key Exchange Options:
• RSA: Server's RSA key (NO forward secrecy!)
• DHE: Diffie-Hellman Ephemeral
• ECDHE: Elliptic Curve DHE (preferred)

Authentication:
• RSA: RSA signature
• ECDSA: Elliptic Curve Digital Signature

Encryption:
• AES-GCM: Modern, fast (AEAD)
• AES-CBC: Older, needs separate MAC
• ChaCha20-Poly1305: Mobile-friendly
</code></pre>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">TLS 1.3</span></div>
                        <h4>TLS 1.3 Cipher Suites (Simplified)</h4>
<pre><code class="language-bash">TLS 1.3 Cipher Suites:

Only 5 cipher suites:
• TLS_AES_256_GCM_SHA384
• TLS_AES_128_GCM_SHA256
• TLS_CHACHA20_POLY1305_SHA256
• TLS_AES_128_CCM_SHA256
• TLS_AES_128_CCM_8_SHA256

Why simpler?
• Key exchange ALWAYS ephemeral (forward secrecy)
• Authentication separate (in certificate)
• Only AEAD ciphers allowed

TLS 1.3 removes:
• RSA key exchange (no forward secrecy)
• Static DH
• CBC mode ciphers
• RC4, 3DES, MD5, SHA-1
</code></pre>
                    </div>

<pre><code class="language-bash"># Check server cipher suites

# List supported ciphers
nmap --script ssl-enum-ciphers -p 443 example.com

# Test specific cipher
openssl s_client -connect example.com:443 \
  -cipher 'ECDHE-RSA-AES256-GCM-SHA384'

# Modern cipher configuration (nginx)
ssl_protocols TLSv1.2 TLSv1.3;
ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384;
ssl_prefer_server_ciphers off;

# Mozilla SSL Configuration Generator
# https://ssl-config.mozilla.org/
</code></pre>
                </div>

                <div id="validation" class="blog-content mt-5">
                    <h2><i class="fas fa-check-double me-2 text-teal"></i>Certificate Validation</h2>

                    <p>When your browser receives a certificate, it performs multiple checks: chain validation, expiration, revocation, and domain matching.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Validation</span></div>
                        <h4>Certificate Validation Steps</h4>
<pre><code class="language-bash">Certificate Validation Checks:

1. CHAIN VALIDATION
   • Build path to trusted root
   • Verify each signature
   • Check BasicConstraints (CA:TRUE for intermediates)

2. VALIDITY PERIOD
   • notBefore < now < notAfter
   • Alert if expired or not yet valid

3. REVOCATION CHECK
   • CRL (Certificate Revocation List)
   • OCSP (Online Certificate Status Protocol)
   • OCSP Stapling (server provides status)

4. NAME MATCHING
   • CN or SAN must match hostname
   • Wildcard matching rules (*.example.com)

5. KEY USAGE
   • digitalSignature for TLS server auth
   • Extended Key Usage: serverAuth

6. POLICY CHECK
   • Certificate Transparency logs
   • CAA DNS records
</code></pre>
                    </div>

<pre><code class="language-bash"># Certificate revocation checks

# Check OCSP
openssl ocsp -issuer intermediate.crt -cert server.crt \
  -url http://ocsp.digicert.com -resp_text

# Check CRL
openssl crl -in crl.pem -text -noout

# OCSP stapling test
openssl s_client -connect example.com:443 -status 2>/dev/null | \
  grep -A 17 "OCSP Response"

# Certificate Transparency lookup
# https://crt.sh/?q=example.com
</code></pre>

<pre><code class="language-python"># Certificate validation in Python

import ssl
import socket
from datetime import datetime

def validate_certificate(hostname):
    """Validate server certificate"""
    
    print(f"Validating certificate for {hostname}")
    print("=" * 50)
    
    # Create context with validation
    context = ssl.create_default_context()
    # context.check_hostname = True (default)
    # context.verify_mode = ssl.CERT_REQUIRED (default)
    
    try:
        with socket.create_connection((hostname, 443)) as sock:
            with context.wrap_socket(sock, server_hostname=hostname) as tls:
                cert = tls.getpeercert()
                
                print("✅ Chain valid (trusted by system CA store)")
                print("✅ Hostname matches")
                
                # Check expiration
                not_after = cert['notAfter']
                expiry = datetime.strptime(not_after, '%b %d %H:%M:%S %Y %Z')
                days_left = (expiry - datetime.now()).days
                
                if days_left > 0:
                    print(f"✅ Not expired ({days_left} days remaining)")
                else:
                    print(f"❌ EXPIRED!")
                
                return True
                
    except ssl.SSLCertVerificationError as e:
        print(f"❌ Validation failed: {e}")
        return False
    except ssl.CertificateError as e:
        print(f"❌ Certificate error: {e}")
        return False

# Test
# validate_certificate('google.com')
# validate_certificate('expired.badssl.com')  # Will fail
</code></pre>
                </div>

                <div id="summary" class="blog-content mt-5">
                    <h2><i class="fas fa-check-circle me-2 text-teal"></i>Summary & Next Steps</h2>

                    <div class="highlight-box">
                        <i class="fas fa-graduation-cap"></i>
                        <strong>Key Takeaways:</strong>
                        <ul class="mt-2 mb-0">
                            <li><strong>TLS 1.3</strong>: 1-RTT handshake, mandatory forward secrecy</li>
                            <li><strong>X.509</strong>: Standard for digital certificates</li>
                            <li><strong>PKI</strong>: Root → Intermediate → End-Entity chain</li>
                            <li><strong>Cipher suites</strong>: Key exchange + Auth + Encryption</li>
                            <li><strong>Validation</strong>: Chain, expiry, revocation, hostname</li>
                        </ul>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Quiz</span></div>
                        <h4>Test Your Knowledge</h4>
                        <ol>
                            <li>TLS 1.3 vs 1.2 handshake? <em>(1-RTT vs 2-RTT)</em></li>
                            <li>What's forward secrecy? <em>(Compromised key doesn't decrypt past traffic)</em></li>
                            <li>Why intermediate CAs? <em>(Limit blast radius, keep root offline)</em></li>
                            <li>OCSP vs CRL? <em>(Real-time check vs periodic list)</em></li>
                            <li>Why no RSA key exchange in TLS 1.3? <em>(No forward secrecy)</em></li>
                        </ol>
                    </div>

                    <div class="series-next">
                        <h4><i class="fas fa-arrow-right me-2"></i>Next in the Series</h4>
                        <p>In <a href="protocols-master-cloud-protocols.html"><strong>Part 18: Cloud Protocols</strong></a>, we'll explore AWS, Azure, and GCP-specific protocols and APIs.</p>
                    </div>
                </div>

                <div class="related-posts mt-5">
                    <h3><i class="fas fa-book me-2"></i>Related Articles</h3>
                    <div class="related-post-item">
                        <h5>Part 16: Network Management</h5>
                        <p>SNMP, NetFlow, syslog monitoring.</p>
                        <a href="protocols-master-network-management.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                    <div class="related-post-item">
                        <h5>Part 18: Cloud Protocols</h5>
                        <p>AWS, Azure, GCP communication.</p>
                        <a href="protocols-master-cloud-protocols.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                </div>

                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="social-media" class="bg-dark text-light py-5">
        <div class="container py-5">
            <div class="row mb-4">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h5 class="fw-bold mb-3">Let's Connect</h5>
                    <p class="text-light">
                        I'm always interested in sharing content about my interests on different topics. Read disclaimer and feel free to share further.
                    </p>
                </div>
                <div class="col-lg-6">
                    <h5 class="fw-bold mb-3">Follow Me</h5>
                    <div class="social-links d-flex gap-2 flex-wrap">
                        <a href="https://www.facebook.com/wasil.zafar/" target="_blank" class="social-icon" title="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://twitter.com/wasilzafar" target="_blank" class="social-icon" title="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.linkedin.com/in/wasilzafar" target="_blank" class="social-icon" title="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://www.youtube.com/@wasilzafar" target="_blank" class="social-icon" title="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://www.instagram.com/itswzee/" target="_blank" class="social-icon" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://in.pinterest.com/wasilz/" target="_blank" class="social-icon" title="Pinterest">
                            <i class="fab fa-pinterest-p"></i>
                        </a>
                        <a href="mailto:wasil.zafar@gmail.com" class="social-icon" title="Email">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>

            <hr class="bg-secondary">

            <div class="row mt-4">
                <div class="col-md-6">
                    <p class="small">
                        <i class="fas fa-icons me-2"></i>Icons from <a href="https://www.flaticon.com/" target="_blank" class="text-light">Flaticon</a> &amp; <a href="https://fontawesome.com/" target="_blank" class="text-light">Font Awesome</a>
                    </p>
                    <p class="small mt-3">
                        <a href="/" class="text-light text-decoration-none">Home</a> | 
                        <a href="/disclaimer.html" class="text-light text-decoration-none">Disclaimer</a> | 
                        <a href="/privacy-policy.html" class="text-light text-decoration-none">Privacy Policy</a>
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small">
                        Enjoying this content? ☕ <a href="https://buymeacoffee.com/itswzee" target="_blank" class="text-light" style="text-decoration: underline;">Keep me caffeinated</a> to keep the pixels flowing!
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <button id="scrollToTop" class="scroll-to-top"><i class="fas fa-arrow-up"></i></button>
    <div id="categoryIndicator" class="category-indicator"></div>
    <script src="../../../js/cookie-consent.js"></script>
    <script src="../../../js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
</body>
</html>
