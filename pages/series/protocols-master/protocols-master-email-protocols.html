<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="robots" content="index, archive" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Master email protocols: SMTP for sending, POP3 and IMAP for receiving. Learn email security with SPF, DKIM, DMARC, and understand how email traverses the internet." />
    <meta name="author" content="Wasil Zafar" />
    <meta name="keywords" content="SMTP, POP3, IMAP, Email Protocols, SPF, DKIM, DMARC, Email Security, MX Records, Email Authentication" />
    <meta property="og:title" content="Complete Protocols Master Part 9: Email Protocols" />
    <meta property="og:description" content="Comprehensive guide to email protocols: SMTP, POP3, IMAP, and security mechanisms SPF, DKIM, DMARC." />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2026-01-31" />
    <meta property="article:author" content="Wasil Zafar" />
    <meta property="article:section" content="Technology" />
    
    <title>Complete Protocols Master Part 9: Email Protocols - Wasil Zafar</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet" />

    <!-- Custom Styles -->
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" />

    <!-- Prism.js Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" id="prism-theme" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" />

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="../../../images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../images/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="../../../images/favicon_io/site.webmanifest">

    <!-- Google Consent Mode v2 & Tag Manager -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('consent', 'default', {'ad_storage': 'denied', 'analytics_storage': 'denied', 'region': ['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE']});
        gtag('consent', 'default', {'ad_storage': 'granted', 'analytics_storage': 'granted'});
    </script>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PBS8M2JR');</script>
</head>
<body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBS8M2JR" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/"><span class="gradient-text">Wasil Zafar</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#skills">Skills</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#certifications">Certifications</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#interests">Interests</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="blog-hero">
        <div class="container py-5">
            <div class="blog-header">
                <a href="/pages/categories/technology.html" class="back-link"><i class="fas fa-arrow-left me-2"></i>Back to Technology</a>
                <h1 class="display-4 fw-bold mb-3">Complete Protocols Master Part 9: Email Protocols</h1>
                <div class="blog-meta">
                    <span><i class="fas fa-calendar me-2"></i>January 31, 2026</span>
                    <span><i class="fas fa-user me-2"></i>Wasil Zafar</span>
                    <span class="reading-time"><i class="fas fa-clock me-1"></i>38 min read</span>
                    <button onclick="window.print()" class="print-btn" title="Print this article"><i class="fas fa-print"></i> Print</button>
                </div>
                <p class="lead">Understand how email works: SMTP for sending, POP3 and IMAP for receiving. Learn essential email security mechanisms including SPF, DKIM, and DMARC to protect against spoofing and phishing.</p>
            </div>
        </div>
    </section>

    <!-- TOC Toggle -->
    <button class="toc-toggle-btn" onclick="openNav()" title="Table of Contents"><i class="fas fa-list"></i></button>
    <div id="tocSidenav" class="sidenav-toc">
        <div class="toc-header">
            <h3><i class="fas fa-list me-2"></i>Table of Contents</h3>
            <button class="closebtn" onclick="closeNav()">&times;</button>
        </div>
        <ol>
            <li><a href="#introduction" onclick="closeNav()">Introduction</a></li>
            <li><a href="#smtp" onclick="closeNav()">SMTP Protocol</a></li>
            <li><a href="#pop3" onclick="closeNav()">POP3 Protocol</a></li>
            <li><a href="#imap" onclick="closeNav()">IMAP Protocol</a></li>
            <li><a href="#security" onclick="closeNav()">Email Security (SPF, DKIM, DMARC)</a></li>
            <li><a href="#hands-on" onclick="closeNav()">Hands-On Exercises</a></li>
            <li><a href="#summary" onclick="closeNav()">Summary</a></li>
        </ol>
    </div>
    <div id="tocOverlay" class="sidenav-overlay" onclick="closeNav()"></div>

    <!-- Main Content -->
    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">

                <div id="introduction" class="blog-content">
                    <h2><i class="fas fa-envelope me-2 text-teal"></i>Introduction: How Email Works</h2>
                    
                    <p>Email is one of the oldest and most critical internet services. Despite being decades old, email remains the backbone of business communication, delivering over 300 billion messages daily.</p>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-sitemap me-2"></i>
                        <strong>Series Context:</strong> This is <strong>Part 9 of 20</strong> in the Complete Protocols Master series. Email protocols work at the Application Layer, with DNS playing a crucial role in mail routing via MX records.
                    </div>

                    <div class="experiment-card" id="series-nav">
                        <h4><i class="fas fa-map-signs me-2"></i>Complete Series Navigation</h4>
                        <div class="meta mb-2">
                            <span class="badge bg-teal me-2">20-Part Series</span>
                            <span class="badge bg-crimson">Protocol Mastery</span>
                        </div>
                        <div class="content">
                            <ol>
                                <li><a href="protocols-master-osi-foundations.html"><strong>Part 1:</strong> OSI Model & Protocol Foundations</a> — Network layers, encapsulation, TCP/IP model</li>
                                <li><a href="protocols-master-physical-datalink.html"><strong>Part 2:</strong> Physical & Data Link Layers</a> — Ethernet, Wi-Fi, VLANs, MAC addressing</li>
                                <li><a href="protocols-master-network-layer.html"><strong>Part 3:</strong> Network Layer & IP</a> — IPv4, IPv6, ICMP, routing protocols</li>
                                <li><a href="protocols-master-transport-layer.html"><strong>Part 4:</strong> Transport Layer</a> — TCP, UDP, QUIC, ports, sockets</li>
                                <li><a href="protocols-master-session-presentation.html"><strong>Part 5:</strong> Session & Presentation Layers</a> — TLS handshake, encryption, serialization</li>
                                <li><a href="protocols-master-web-protocols.html"><strong>Part 6:</strong> Web Protocols</a> — HTTP/1.1, HTTP/2, HTTP/3, WebSockets</li>
                                <li><a href="protocols-master-api-protocols.html"><strong>Part 7:</strong> API Protocols</a> — REST, GraphQL, gRPC, SOAP</li>
                                <li><a href="protocols-master-dns-deep-dive.html"><strong>Part 8:</strong> DNS Deep Dive</a> — DNS hierarchy, records, DNSSEC</li>
                                <li><strong>Part 9: Email Protocols (This Guide)</strong> — SMTP, IMAP, POP3, SPF/DKIM/DMARC</li>
                                <li><a href="protocols-master-file-transfer.html"><strong>Part 10:</strong> File Transfer Protocols</a> — FTP, SFTP, SCP, rsync</li>
                                <li><a href="protocols-master-realtime-protocols.html"><strong>Part 11:</strong> Real-Time Protocols</a> — WebRTC, SIP, RTP, VoIP</li>
                                <li><a href="protocols-master-streaming-protocols.html"><strong>Part 12:</strong> Streaming Protocols</a> — HLS, DASH, RTMP, media delivery</li>
                                <li><a href="protocols-master-iot-protocols.html"><strong>Part 13:</strong> IoT Protocols</a> — MQTT, CoAP, Zigbee, LoRaWAN</li>
                                <li><a href="protocols-master-vpn-tunneling.html"><strong>Part 14:</strong> VPN & Tunneling</a> — IPsec, OpenVPN, WireGuard</li>
                                <li><a href="protocols-master-authentication-protocols.html"><strong>Part 15:</strong> Authentication Protocols</a> — OAuth, SAML, OIDC, Kerberos</li>
                                <li><a href="protocols-master-network-management.html"><strong>Part 16:</strong> Network Management</a> — SNMP, NetFlow, Syslog</li>
                                <li><a href="protocols-master-security-protocols.html"><strong>Part 17:</strong> Security Protocols</a> — TLS/SSL, certificates, PKI</li>
                                <li><a href="protocols-master-cloud-protocols.html"><strong>Part 18:</strong> Cloud Provider Protocols</a> — AWS, Azure, GCP APIs</li>
                                <li><a href="protocols-master-emerging-protocols.html"><strong>Part 19:</strong> Emerging Protocols</a> — QUIC, HTTP/3, WebTransport</li>
                                <li><a href="protocols-master-web-security-standards.html"><strong>Part 20:</strong> Web Security Standards</a> — CORS, CSP, HSTS, SRI</li>
                            </ol>
                        </div>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Overview</span></div>
                        <h4>Email Protocol Stack</h4>
                        <table class="table table-bordered">
                            <thead><tr><th>Protocol</th><th>Purpose</th><th>Port(s)</th></tr></thead>
                            <tbody>
                                <tr><td><strong>SMTP</strong></td><td>Send email</td><td>25, 465 (SSL), 587 (TLS)</td></tr>
                                <tr><td><strong>POP3</strong></td><td>Download email</td><td>110, 995 (SSL)</td></tr>
                                <tr><td><strong>IMAP</strong></td><td>Sync email</td><td>143, 993 (SSL)</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">Journey</span></div>
                        <h4>Email Journey: alice@company.com → bob@example.org</h4>
<pre><code class="language-bash">1. Alice composes email, clicks Send
2. Client submits to smtp.company.com (port 587, authenticated)
3. company.com queries DNS for example.org MX record
4. SMTP relay to mail.example.org (port 25)
5. SPF/DKIM/DMARC checks performed
6. Message stored in Bob's mailbox
7. Bob's client fetches via IMAP (port 993)

┌─────────────────────────────────────────────────────┐
│ Alice's    SMTP     Company     SMTP     Example   │
│ Client  ───────>  Mail Server ─────> Mail Server   │
│                                           │        │
│ Bob's      IMAP                      Bob's         │
│ Client  <────────────────────────── Mailbox        │
└─────────────────────────────────────────────────────┘
</code></pre>
                    </div>
                </div>

                <div id="smtp" class="blog-content mt-5">
                    <h2><i class="fas fa-paper-plane me-2 text-teal"></i>SMTP: Simple Mail Transfer Protocol</h2>

                    <p><strong>SMTP</strong> is the protocol for sending email. It's text-based and human-readable, making it easy to debug but also easy to abuse without proper authentication.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Commands</span></div>
                        <h4>SMTP Commands</h4>
<pre><code class="language-bash">SMTP Commands:
EHLO/HELO    - Identify client (EHLO for extensions)
AUTH         - Authenticate (LOGIN, PLAIN)
MAIL FROM:   - Specify sender
RCPT TO:     - Specify recipient(s)
DATA         - Start message content (end with .\r\n)
QUIT         - End session

Response Codes:
220 - Service ready
250 - OK
354 - Start mail input
421 - Service unavailable
550 - Mailbox not found

Ports:
25  - Server-to-server relay
465 - SMTP over SSL
587 - Submission (client-to-server with STARTTLS)
</code></pre>
                    </div>

<pre><code class="language-bash"># SMTP session example
S: 220 smtp.example.com ESMTP ready
C: EHLO client.example.net
S: 250-smtp.example.com
S: 250-STARTTLS
S: 250-AUTH LOGIN PLAIN
S: 250 OK
C: STARTTLS
S: 220 Ready to start TLS
[TLS handshake]
C: AUTH LOGIN
S: 334 VXNlcm5hbWU6
C: [base64 username]
S: 334 UGFzc3dvcmQ6
C: [base64 password]
S: 235 Authentication successful
C: MAIL FROM:&lt;alice@example.com&gt;
S: 250 OK
C: RCPT TO:&lt;bob@example.org&gt;
S: 250 OK
C: DATA
S: 354 Start mail input
C: From: Alice &lt;alice@example.com&gt;
C: To: Bob &lt;bob@example.org&gt;
C: Subject: Hello!
C: 
C: Hi Bob, this is a test.
C: .
S: 250 OK: queued
C: QUIT
S: 221 Bye
</code></pre>

<pre><code class="language-python"># Python SMTP example
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart

def demonstrate_smtp_message():
    """Show SMTP message structure"""
    msg = MIMEMultipart()
    msg['From'] = 'alice@example.com'
    msg['To'] = 'bob@example.org'
    msg['Subject'] = 'Hello from Python!'
    
    body = "Hi Bob,\n\nThis is a test email.\n\nBest,\nAlice"
    msg.attach(MIMEText(body, 'plain'))
    
    print("SMTP Message Structure:")
    print("=" * 50)
    print(msg.as_string())
    
    print("\nTo send:")
    print("""
    import smtplib
    with smtplib.SMTP('smtp.example.com', 587) as server:
        server.starttls()
        server.login('user', 'password')
        server.send_message(msg)
    """)

demonstrate_smtp_message()
</code></pre>
                </div>

                <div id="pop3" class="blog-content mt-5">
                    <h2><i class="fas fa-download me-2 text-teal"></i>POP3: Post Office Protocol</h2>

                    <p><strong>POP3</strong> is simple—download emails, optionally delete from server. Best for single-device access with local storage.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">POP3</span></div>
                        <h4>POP3 Commands</h4>
<pre><code class="language-bash">POP3 Commands:
USER &lt;name&gt;    - Username
PASS &lt;pwd&gt;     - Password
STAT           - Mailbox status
LIST           - List messages
RETR &lt;n&gt;       - Retrieve message n
DELE &lt;n&gt;       - Delete message n
QUIT           - Commit and close

Session:
S: +OK POP3 ready
C: USER bob
S: +OK
C: PASS secret
S: +OK 3 messages
C: STAT
S: +OK 3 12048
C: RETR 1
S: +OK
S: [message content]
S: .
C: DELE 1
S: +OK deleted
C: QUIT
S: +OK bye

Ports: 110 (plain), 995 (SSL)
</code></pre>
                    </div>

                    <div class="highlight-box">
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>POP3 Limitations:</strong> Single-device focused, no folders, no sync. Delete on one device = gone everywhere. Use IMAP for multi-device access.
                    </div>
                </div>

                <div id="imap" class="blog-content mt-5">
                    <h2><i class="fas fa-sync me-2 text-teal"></i>IMAP: Internet Message Access Protocol</h2>

                    <p><strong>IMAP</strong> keeps email on the server and synchronizes across devices. It supports folders, server-side search, and partial message fetching.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Comparison</span></div>
                        <h4>IMAP vs POP3</h4>
                        <table class="table table-bordered">
                            <thead><tr><th>Feature</th><th>POP3</th><th>IMAP</th></tr></thead>
                            <tbody>
                                <tr><td>Storage</td><td>Download locally</td><td>Server-side</td></tr>
                                <tr><td>Folders</td><td>Inbox only</td><td>Multiple</td></tr>
                                <tr><td>Multi-device</td><td>Poor</td><td>Designed for it</td></tr>
                                <tr><td>Search</td><td>Local</td><td>Server-side</td></tr>
                                <tr><td>Partial fetch</td><td>No</td><td>Yes</td></tr>
                            </tbody>
                        </table>
                    </div>

<pre><code class="language-bash"># IMAP session example
S: * OK IMAP4rev1 ready
C: a001 LOGIN bob secret
S: a001 OK LOGIN completed
C: a002 SELECT INBOX
S: * 172 EXISTS
S: * 1 RECENT
S: a002 OK SELECT completed
C: a003 FETCH 172 (FLAGS BODY[HEADER])
S: * 172 FETCH (FLAGS (\Recent) BODY[HEADER] {...})
S: a003 OK FETCH completed
C: a004 STORE 172 +FLAGS (\Seen)
S: a004 OK STORE completed
C: a005 LOGOUT
S: * BYE
S: a005 OK LOGOUT completed

Key Commands: LOGIN, SELECT, FETCH, STORE, SEARCH, COPY, IDLE
Ports: 143 (STARTTLS), 993 (SSL)
</code></pre>

<pre><code class="language-python"># IMAP operations demo
def demonstrate_imap_operations():
    """Demonstrate IMAP concepts"""
    operations = [
        ("LOGIN", "Authenticate"),
        ("SELECT INBOX", "Open mailbox"),
        ("SEARCH UNSEEN", "Find unread"),
        ("FETCH n (BODY[HEADER])", "Get headers"),
        ("FETCH n (BODY[TEXT])", "Get body"),
        ("STORE n +FLAGS (\\Seen)", "Mark read"),
        ("COPY n Archive", "Copy to folder"),
        ("IDLE", "Wait for new mail (push)")
    ]
    
    print("IMAP Operations:")
    print("=" * 50)
    for cmd, desc in operations:
        print(f"  {cmd:30} - {desc}")
    
    print("\nPython example:")
    print("""
    import imaplib
    
    mail = imaplib.IMAP4_SSL('imap.example.com', 993)
    mail.login('user', 'password')
    mail.select('INBOX')
    
    status, messages = mail.search(None, 'UNSEEN')
    for num in messages[0].split():
        status, data = mail.fetch(num, '(RFC822)')
        # Process email...
    
    mail.logout()
    """)

demonstrate_imap_operations()
</code></pre>
                </div>

                <div id="security" class="blog-content mt-5">
                    <h2><i class="fas fa-shield-alt me-2 text-teal"></i>Email Security: SPF, DKIM, DMARC</h2>

                    <p>Email was designed without authentication—the From header can be anything! SPF, DKIM, and DMARC work together to prevent spoofing.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">SPF</span></div>
                        <h4>SPF: Sender Policy Framework</h4>
<pre><code class="language-bash">SPF: DNS TXT record listing authorized sending IPs

example.com. TXT "v=spf1 ip4:192.0.2.0/24 include:_spf.google.com -all"

Components:
v=spf1           - Version
ip4:192.0.2.0/24 - Allow IP range
include:...      - Include another SPF
a                - Allow A record IPs
mx               - Allow MX record IPs
-all             - Hard fail others
~all             - Soft fail others

Check: Does sending IP match SPF record for envelope sender domain?
Limitation: Doesn't check From: header, breaks with forwarding
</code></pre>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">DKIM</span></div>
                        <h4>DKIM: DomainKeys Identified Mail</h4>
<pre><code class="language-bash">DKIM: Cryptographically signs email headers + body

DKIM-Signature: v=1; a=rsa-sha256; d=example.com; s=selector1;
  h=from:to:subject:date;
  bh=base64_body_hash;
  b=base64_signature

Public key in DNS:
selector1._domainkey.example.com. TXT "v=DKIM1; k=rsa; p=MIGfMA0..."

Advantages:
• Survives forwarding (signature travels with email)
• Verifies content integrity
• More robust than SPF alone
</code></pre>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">DMARC</span></div>
                        <h4>DMARC: Domain-based Message Authentication</h4>
<pre><code class="language-bash">DMARC: Ties SPF + DKIM together with policy and reporting

_dmarc.example.com. TXT "v=DMARC1; p=reject; rua=mailto:dmarc@example.com"

Parameters:
p=none       - Monitor only
p=quarantine - Send to spam
p=reject     - Block entirely
rua=         - Aggregate report email
ruf=         - Forensic report email

ALIGNMENT (Critical):
SPF checks: envelope sender (MAIL FROM)
DKIM checks: signing domain (d=)
DMARC requires: at least one must ALIGN with visible From: header!

Recommended rollout:
1. p=none (monitor)
2. p=quarantine pct=10 (test 10%)
3. p=quarantine pct=100
4. p=reject (full protection)
</code></pre>
                    </div>

<pre><code class="language-python"># Email authentication check simulation
def check_email_auth(email_info):
    """Simulate SPF/DKIM/DMARC checks"""
    results = {'spf': 'unknown', 'dkim': 'unknown', 'dmarc': 'unknown'}
    
    # SPF: Is sending IP authorized?
    envelope_domain = email_info['envelope_from'].split('@')[1]
    if email_info['sending_ip'] in email_info.get('spf_ips', []):
        results['spf'] = 'pass'
    else:
        results['spf'] = 'fail'
    
    # DKIM: Is signature valid?
    results['dkim'] = 'pass' if email_info.get('dkim_valid') else 'fail'
    
    # DMARC: Alignment check
    header_domain = email_info['header_from'].split('@')[1]
    dkim_domain = email_info.get('dkim_domain', '')
    
    spf_aligned = envelope_domain == header_domain
    dkim_aligned = dkim_domain == header_domain
    
    if (results['spf'] == 'pass' and spf_aligned) or \
       (results['dkim'] == 'pass' and dkim_aligned):
        results['dmarc'] = 'pass'
    else:
        results['dmarc'] = 'fail'
    
    return results

# Test: Legitimate email
print("Legitimate Email:")
result = check_email_auth({
    'header_from': 'alice@example.com',
    'envelope_from': 'bounce@example.com',
    'sending_ip': '192.0.2.10',
    'spf_ips': ['192.0.2.10'],
    'dkim_valid': True,
    'dkim_domain': 'example.com'
})
for k, v in result.items():
    print(f"  {k.upper()}: {v}")

# Test: Spoofed email
print("\nSpoofed Email:")
result = check_email_auth({
    'header_from': 'ceo@example.com',
    'envelope_from': 'attacker@evil.com',
    'sending_ip': '198.51.100.5',
    'spf_ips': ['192.0.2.10'],
    'dkim_valid': False,
    'dkim_domain': ''
})
for k, v in result.items():
    print(f"  {k.upper()}: {v}")
print("  Action: REJECT (DMARC policy)")
</code></pre>
                </div>

                <div id="hands-on" class="blog-content mt-5">
                    <h2><i class="fas fa-laptop-code me-2 text-teal"></i>Hands-On Exercises</h2>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">Quiz</span></div>
                        <h4>Test Your Knowledge</h4>
                        <ol>
                            <li>What protocol sends email? <em>(SMTP)</em></li>
                            <li>POP3 vs IMAP main difference? <em>(POP3 downloads/deletes, IMAP syncs)</em></li>
                            <li>SMTP submission port with TLS? <em>(587)</em></li>
                            <li>What does SPF verify? <em>(Sending IP authorization)</em></li>
                            <li>What does DKIM add? <em>(Cryptographic signature)</em></li>
                            <li>What is DMARC alignment? <em>(SPF/DKIM domain must match From:)</em></li>
                        </ol>
                    </div>

<pre><code class="language-bash"># Check email authentication records
dig example.com TXT | grep spf           # SPF
dig selector._domainkey.example.com TXT  # DKIM
dig _dmarc.example.com TXT               # DMARC
dig example.com MX                       # Mail servers

# Tools: mxtoolbox.com, mail-tester.com
</code></pre>
                </div>

                <div id="summary" class="blog-content mt-5">
                    <h2><i class="fas fa-check-circle me-2 text-teal"></i>Summary & Next Steps</h2>

                    <div class="highlight-box">
                        <i class="fas fa-graduation-cap"></i>
                        <strong>Key Takeaways:</strong>
                        <ul class="mt-2 mb-0">
                            <li><strong>SMTP</strong> sends email (587 with TLS)</li>
                            <li><strong>POP3</strong> downloads (single device)</li>
                            <li><strong>IMAP</strong> syncs (multi-device)</li>
                            <li><strong>SPF</strong> authorizes IPs</li>
                            <li><strong>DKIM</strong> signs cryptographically</li>
                            <li><strong>DMARC</strong> enforces policy + alignment</li>
                        </ul>
                    </div>

                    <div class="series-next">
                        <h4><i class="fas fa-arrow-right me-2"></i>Next in the Series</h4>
                        <p>In <a href="protocols-master-file-transfer.html"><strong>Part 10: File Transfer Protocols</strong></a>, we'll explore FTP, SFTP, SCP, and modern alternatives for secure file transfer.</p>
                    </div>
                </div>

                <div class="related-posts mt-5">
                    <h3><i class="fas fa-book me-2"></i>Related Articles</h3>
                    <div class="related-post-item">
                        <h5>Part 8: DNS Deep Dive</h5>
                        <p>DNS and MX records for email routing.</p>
                        <a href="protocols-master-dns-deep-dive.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                    <div class="related-post-item">
                        <h5>Part 10: File Transfer Protocols</h5>
                        <p>FTP, SFTP, and secure file transfer.</p>
                        <a href="protocols-master-file-transfer.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                </div>

                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="social-media" class="bg-dark text-light py-5">
        <div class="container py-5">
            <div class="row mb-4">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h5 class="fw-bold mb-3">Let's Connect</h5>
                    <p class="text-light">
                        I'm always interested in sharing content about my interests on different topics. Read disclaimer and feel free to share further.
                    </p>
                </div>
                <div class="col-lg-6">
                    <h5 class="fw-bold mb-3">Follow Me</h5>
                    <div class="social-links d-flex gap-2 flex-wrap">
                        <a href="https://www.facebook.com/wasil.zafar/" target="_blank" class="social-icon" title="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://twitter.com/wasilzafar" target="_blank" class="social-icon" title="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.linkedin.com/in/wasilzafar" target="_blank" class="social-icon" title="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://www.youtube.com/@wasilzafar" target="_blank" class="social-icon" title="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://www.instagram.com/itswzee/" target="_blank" class="social-icon" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://in.pinterest.com/wasilz/" target="_blank" class="social-icon" title="Pinterest">
                            <i class="fab fa-pinterest-p"></i>
                        </a>
                        <a href="mailto:wasil.zafar@gmail.com" class="social-icon" title="Email">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>

            <hr class="bg-secondary">

            <div class="row mt-4">
                <div class="col-md-6">
                    <p class="small">
                        <i class="fas fa-icons me-2"></i>Icons from <a href="https://www.flaticon.com/" target="_blank" class="text-light">Flaticon</a> &amp; <a href="https://fontawesome.com/" target="_blank" class="text-light">Font Awesome</a>
                    </p>
                    <p class="small mt-3">
                        <a href="/" class="text-light text-decoration-none">Home</a> | 
                        <a href="/disclaimer.html" class="text-light text-decoration-none">Disclaimer</a> | 
                        <a href="/privacy-policy.html" class="text-light text-decoration-none">Privacy Policy</a>
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small">
                        Enjoying this content? ☕ <a href="https://buymeacoffee.com/itswzee" target="_blank" class="text-light" style="text-decoration: underline;">Keep me caffeinated</a> to keep the pixels flowing!
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <button id="scrollToTop" class="scroll-to-top"><i class="fas fa-arrow-up"></i></button>
    <div id="categoryIndicator" class="category-indicator"></div>
    <script src="../../../js/cookie-consent.js"></script>
    <script src="../../../js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
</body>
</html>
