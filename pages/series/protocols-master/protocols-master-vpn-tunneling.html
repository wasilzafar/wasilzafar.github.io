<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="robots" content="index, archive" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Master VPN and tunneling protocols: IPsec, WireGuard, OpenVPN, SSH tunnels, and GRE. Learn to create secure encrypted tunnels for private communication." />
    <meta name="author" content="Wasil Zafar" />
    <meta name="keywords" content="VPN, IPsec, WireGuard, OpenVPN, SSH Tunnel, GRE, Tunneling, IKE, Encryption, Network Security" />
    <meta property="og:title" content="Complete Protocols Master Part 14: VPN & Tunneling Protocols" />
    <meta property="og:description" content="Comprehensive guide to VPN protocols: IPsec, WireGuard, OpenVPN for secure encrypted tunnels." />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2026-01-31" />
    <meta property="article:author" content="Wasil Zafar" />
    <meta property="article:section" content="Technology" />
    
    <title>Complete Protocols Master Part 14: VPN & Tunneling Protocols - Wasil Zafar</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" id="prism-theme" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" />
    <link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon_io/favicon-32x32.png">

    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('consent', 'default', {'ad_storage': 'denied', 'analytics_storage': 'denied', 'region': ['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE']});
        gtag('consent', 'default', {'ad_storage': 'granted', 'analytics_storage': 'granted'});
    </script>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s);j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PBS8M2JR');</script>
</head>
<body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBS8M2JR" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/"><span class="gradient-text">Wasil Zafar</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#skills">Skills</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#certifications">Certifications</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#interests">Interests</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="blog-hero">
        <div class="container py-5">
            <div class="blog-header">
                <a href="/pages/categories/technology.html" class="back-link"><i class="fas fa-arrow-left me-2"></i>Back to Technology</a>
                <h1 class="display-4 fw-bold mb-3">Complete Protocols Master Part 14: VPN & Tunneling Protocols</h1>
                <div class="blog-meta">
                    <span><i class="fas fa-calendar me-2"></i>January 31, 2026</span>
                    <span><i class="fas fa-user me-2"></i>Wasil Zafar</span>
                    <span class="reading-time"><i class="fas fa-clock me-1"></i>40 min read</span>
                    <button onclick="window.print()" class="print-btn"><i class="fas fa-print"></i> Print</button>
                </div>
                <p class="lead">Master secure tunneling: IPsec for site-to-site, WireGuard for modern simplicity, OpenVPN for flexibility, and SSH tunnels for quick secure access.</p>
            </div>
        </div>
    </section>

    <button class="toc-toggle-btn" onclick="openNav()"><i class="fas fa-list"></i></button>
    <div id="tocSidenav" class="sidenav-toc">
        <div class="toc-header">
            <h3><i class="fas fa-list me-2"></i>Table of Contents</h3>
            <button class="closebtn" onclick="closeNav()">&times;</button>
        </div>
        <ol>
            <li><a href="#introduction" onclick="closeNav()">Introduction</a></li>
            <li><a href="#ipsec" onclick="closeNav()">IPsec</a></li>
            <li><a href="#wireguard" onclick="closeNav()">WireGuard</a></li>
            <li><a href="#openvpn" onclick="closeNav()">OpenVPN</a></li>
            <li><a href="#ssh" onclick="closeNav()">SSH Tunnels</a></li>
            <li><a href="#gre" onclick="closeNav()">GRE Tunnels</a></li>
            <li><a href="#comparison" onclick="closeNav()">Comparison</a></li>
            <li><a href="#summary" onclick="closeNav()">Summary</a></li>
        </ol>
    </div>
    <div id="tocOverlay" class="sidenav-overlay" onclick="closeNav()"></div>

    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">

                <div id="introduction" class="blog-content">
                    <h2><i class="fas fa-shield-alt me-2 text-teal"></i>Introduction: VPN & Tunneling Concepts</h2>
                    
                    <p>VPNs create encrypted "tunnels" through untrusted networks. Whether connecting offices, enabling remote work, or bypassing censorship—the goal is secure, private communication over public infrastructure.</p>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-sitemap me-2"></i>
                        <strong>Series Context:</strong> This is <strong>Part 14 of 20</strong> in the Complete Protocols Master series. VPN protocols operate across multiple OSI layers—IPsec at Layer 3, SSL VPNs at Layer 4/7.
                    </div>

                    <div class="experiment-card" id="series-nav">
                        <h4><i class="fas fa-map-signs me-2"></i>Complete Series Navigation</h4>
                        <div class="meta mb-2">
                            <span class="badge bg-teal me-2">20-Part Series</span>
                            <span class="badge bg-crimson">Protocol Mastery</span>
                        </div>
                        <div class="content">
                            <ol>
                                <li><a href="protocols-master-osi-foundations.html"><strong>Part 1:</strong> OSI Model & Protocol Foundations</a> — Network layers, encapsulation, TCP/IP model</li>
                                <li><a href="protocols-master-physical-datalink.html"><strong>Part 2:</strong> Physical & Data Link Layers</a> — Ethernet, Wi-Fi, VLANs, MAC addressing</li>
                                <li><a href="protocols-master-network-layer.html"><strong>Part 3:</strong> Network Layer & IP</a> — IPv4, IPv6, ICMP, routing protocols</li>
                                <li><a href="protocols-master-transport-layer.html"><strong>Part 4:</strong> Transport Layer</a> — TCP, UDP, QUIC, ports, sockets</li>
                                <li><a href="protocols-master-session-presentation.html"><strong>Part 5:</strong> Session & Presentation Layers</a> — TLS handshake, encryption, serialization</li>
                                <li><a href="protocols-master-web-protocols.html"><strong>Part 6:</strong> Web Protocols</a> — HTTP/1.1, HTTP/2, HTTP/3, WebSockets</li>
                                <li><a href="protocols-master-api-protocols.html"><strong>Part 7:</strong> API Protocols</a> — REST, GraphQL, gRPC, SOAP</li>
                                <li><a href="protocols-master-dns-deep-dive.html"><strong>Part 8:</strong> DNS Deep Dive</a> — DNS hierarchy, records, DNSSEC</li>
                                <li><a href="protocols-master-email-protocols.html"><strong>Part 9:</strong> Email Protocols</a> — SMTP, IMAP, POP3, SPF/DKIM/DMARC</li>
                                <li><a href="protocols-master-file-transfer.html"><strong>Part 10:</strong> File Transfer Protocols</a> — FTP, SFTP, SCP, rsync</li>
                                <li><a href="protocols-master-realtime-protocols.html"><strong>Part 11:</strong> Real-Time Protocols</a> — WebRTC, SIP, RTP, VoIP</li>
                                <li><a href="protocols-master-streaming-protocols.html"><strong>Part 12:</strong> Streaming Protocols</a> — HLS, DASH, RTMP, media delivery</li>
                                <li><a href="protocols-master-iot-protocols.html"><strong>Part 13:</strong> IoT Protocols</a> — MQTT, CoAP, Zigbee, LoRaWAN</li>
                                <li><strong>Part 14: VPN & Tunneling (This Guide)</strong> — IPsec, OpenVPN, WireGuard</li>
                                <li><a href="protocols-master-authentication-protocols.html"><strong>Part 15:</strong> Authentication Protocols</a> — OAuth, SAML, OIDC, Kerberos</li>
                                <li><a href="protocols-master-network-management.html"><strong>Part 16:</strong> Network Management</a> — SNMP, NetFlow, Syslog</li>
                                <li><a href="protocols-master-security-protocols.html"><strong>Part 17:</strong> Security Protocols</a> — TLS/SSL, certificates, PKI</li>
                                <li><a href="protocols-master-cloud-protocols.html"><strong>Part 18:</strong> Cloud Provider Protocols</a> — AWS, Azure, GCP APIs</li>
                                <li><a href="protocols-master-emerging-protocols.html"><strong>Part 19:</strong> Emerging Protocols</a> — QUIC, HTTP/3, WebTransport</li>
                                <li><a href="protocols-master-web-security-standards.html"><strong>Part 20:</strong> Web Security Standards</a> — CORS, CSP, HSTS, SRI</li>
                            </ol>
                        </div>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Concepts</span></div>
                        <h4>VPN Fundamentals</h4>
<pre><code class="language-bash">VPN Core Concepts:

1. TUNNEL
   Original packet encapsulated inside another
   Encrypted and authenticated
   Appears as single connection to outsiders

2. ENCRYPTION
   Prevents eavesdropping
   Common: AES-256-GCM, ChaCha20-Poly1305

3. AUTHENTICATION
   Proves identity of both ends
   Pre-shared keys, certificates, or passwords

4. INTEGRITY
   Detects tampering
   HMAC, Poly1305

VPN Types:
• Site-to-Site: Connect entire networks
• Remote Access: Individual users to network
• Point-to-Point: Direct server connection

Without VPN:
[You] → [ISP] → [Internet] → [Server]
       ↑ Can see everything

With VPN:
[You] → [Encrypted Tunnel] → [VPN Server] → [Server]
       ↑ ISP sees encrypted blob
</code></pre>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">Comparison</span></div>
                        <h4>VPN Protocol Overview</h4>
                        <table class="table table-bordered">
                            <thead><tr><th>Protocol</th><th>Complexity</th><th>Speed</th><th>Best For</th></tr></thead>
                            <tbody>
                                <tr><td><strong>IPsec</strong></td><td>High</td><td>Fast</td><td>Site-to-site, enterprise</td></tr>
                                <tr><td><strong>WireGuard</strong></td><td>Low</td><td>Fastest</td><td>Modern choice, mobile</td></tr>
                                <tr><td><strong>OpenVPN</strong></td><td>Medium</td><td>Good</td><td>Flexible, firewalls</td></tr>
                                <tr><td><strong>SSH Tunnel</strong></td><td>Low</td><td>Good</td><td>Quick port forwarding</td></tr>
                                <tr><td><strong>PPTP</strong></td><td>Low</td><td>Fast</td><td>❌ Broken, don't use</td></tr>
                                <tr><td><strong>L2TP/IPsec</strong></td><td>Medium</td><td>Good</td><td>Legacy compatibility</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="ipsec" class="blog-content mt-5">
                    <h2><i class="fas fa-lock me-2 text-teal"></i>IPsec: Internet Protocol Security</h2>

                    <p><strong>IPsec</strong> is the standard for site-to-site VPNs between offices. It operates at Layer 3, securing all IP traffic transparently. Complex but battle-tested.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Components</span></div>
                        <h4>IPsec Architecture</h4>
<pre><code class="language-bash">IPsec Components:

1. IKE (Internet Key Exchange)
   • Phase 1: Establish secure channel for negotiation
   • Phase 2: Negotiate actual VPN parameters
   • Handles key exchange, authentication

2. ESP (Encapsulating Security Payload)
   • Encrypts packet payload
   • Provides authentication
   • Most common IPsec mode

3. AH (Authentication Header)
   • Authentication only, no encryption
   • Rarely used alone
   • Doesn't work with NAT

Modes:
• Tunnel Mode: Entire packet encrypted (site-to-site)
• Transport Mode: Only payload encrypted (host-to-host)

IKE Phases:
Phase 1 (IKE SA):
  • Authenticate peers
  • Establish secure channel
  • Negotiate algorithms

Phase 2 (IPsec SA):
  • Negotiate IPsec parameters
  • Create encryption keys
  • One per traffic pair
</code></pre>
                    </div>

<pre><code class="language-bash"># IPsec packet structure (Tunnel Mode)

Original Packet:
+--------+--------+---------+
| IP Hdr | TCP/UDP | Payload |
+--------+--------+---------+

After ESP Encryption (Tunnel Mode):
+----------+----------+------------+----------+---------+-----------+
| New IP   | ESP      | Orig IP    | TCP/UDP  | Payload | ESP Auth  |
| Header   | Header   | Header     |          |         | Trailer   |
+----------+----------+------------+----------+---------+-----------+
           |←────────── ENCRYPTED ────────────→|

ESP Header:
• SPI (Security Parameter Index): Identifies the SA
• Sequence Number: Anti-replay protection

ESP Trailer:
• Padding
• Authentication Tag (ICV)
</code></pre>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">IKEv2</span></div>
                        <h4>IKEv2 Advantages</h4>
<pre><code class="language-bash">IKEv2 vs IKEv1:

IKEv2 Improvements:
• Fewer messages (4 vs 6-9)
• Built-in NAT traversal
• MOBIKE: Seamless IP changes (mobile)
• Stronger crypto requirements
• Better DoS resistance

IKEv2 Exchange:

Initiator                 Responder
    |                         |
    |--- IKE_SA_INIT -------->|
    |<-- IKE_SA_INIT ---------|
    |                         |
    |--- IKE_AUTH ----------->|
    |<-- IKE_AUTH ------------|
    |                         |
    [IPsec tunnel established]

Just 4 messages to establish VPN!
</code></pre>
                    </div>

<pre><code class="language-bash"># strongSwan IPsec configuration example

# /etc/ipsec.conf
config setup
    charondebug="ike 2, knl 2, cfg 2"

conn site-to-site
    # Authentication
    authby=secret
    
    # Local side
    left=203.0.113.1
    leftsubnet=10.1.0.0/16
    leftid=@office-a
    
    # Remote side
    right=198.51.100.1
    rightsubnet=10.2.0.0/16
    rightid=@office-b
    
    # Encryption (IKE and ESP)
    ike=aes256-sha256-modp2048!
    esp=aes256-sha256!
    
    # Key exchange
    keyexchange=ikev2
    
    # Start automatically
    auto=start

# /etc/ipsec.secrets
@office-a @office-b : PSK "shared-secret-key-here"

# Commands
ipsec start
ipsec up site-to-site
ipsec statusall
</code></pre>
                </div>

                <div id="wireguard" class="blog-content mt-5">
                    <h2><i class="fas fa-bolt me-2 text-teal"></i>WireGuard: Modern VPN</h2>

                    <p><strong>WireGuard</strong> is the modern choice—simpler, faster, and more secure by design. Only ~4,000 lines of code vs OpenVPN's 100,000+. Now included in the Linux kernel.</p>

                    <div class="highlight-box">
                        <i class="fas fa-lightbulb"></i>
                        <strong>Why WireGuard?</strong> Opinionated cryptography (no algorithm negotiation), minimal attack surface, excellent performance. The future of VPN.
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Design</span></div>
                        <h4>WireGuard Principles</h4>
<pre><code class="language-bash">WireGuard Design Philosophy:

1. SIMPLICITY
   • ~4,000 lines of code (auditable)
   • Fixed cryptography (no negotiation)
   • Minimal configuration

2. CRYPTOGRAPHY (non-negotiable)
   • Key exchange: Curve25519
   • Encryption: ChaCha20-Poly1305
   • Hashing: BLAKE2s
   • KDF: HKDF

3. STEALTHY
   • UDP only
   • Silent to unauthenticated packets
   • No handshake response until valid

4. ROAMING
   • Client IP can change
   • Seamless reconnection
   • Perfect for mobile

Peer Model:
• No client/server distinction
• Each peer has public/private key pair
• AllowedIPs defines routing
</code></pre>
                    </div>

<pre><code class="language-bash"># WireGuard setup

# 1. Generate keys (on each peer)
wg genkey | tee privatekey | wg pubkey > publickey

# 2. Server configuration (/etc/wireguard/wg0.conf)
[Interface]
PrivateKey = SERVER_PRIVATE_KEY
Address = 10.0.0.1/24
ListenPort = 51820
PostUp = iptables -A FORWARD -i wg0 -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
PostDown = iptables -D FORWARD -i wg0 -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE

[Peer]
# Client 1
PublicKey = CLIENT1_PUBLIC_KEY
AllowedIPs = 10.0.0.2/32

[Peer]
# Client 2
PublicKey = CLIENT2_PUBLIC_KEY
AllowedIPs = 10.0.0.3/32

# 3. Client configuration
[Interface]
PrivateKey = CLIENT_PRIVATE_KEY
Address = 10.0.0.2/24
DNS = 1.1.1.1

[Peer]
PublicKey = SERVER_PUBLIC_KEY
Endpoint = vpn.example.com:51820
AllowedIPs = 0.0.0.0/0  # Route all traffic through VPN
PersistentKeepalive = 25

# 4. Start WireGuard
wg-quick up wg0
wg-quick down wg0

# 5. Check status
wg show
</code></pre>

<pre><code class="language-python"># WireGuard config generator

def generate_wireguard_config():
    """Generate WireGuard configurations"""
    
    print("WireGuard Configuration Generator")
    print("=" * 50)
    
    # In real use, generate with: wg genkey | wg pubkey
    print("""
    # Generate keys (run on each machine):
    wg genkey > privatekey
    cat privatekey | wg pubkey > publickey
    
    # Server config (wg0.conf):
    [Interface]
    PrivateKey = <server-private-key>
    Address = 10.0.0.1/24
    ListenPort = 51820
    
    [Peer]
    PublicKey = <client-public-key>
    AllowedIPs = 10.0.0.2/32
    
    # Client config:
    [Interface]
    PrivateKey = <client-private-key>
    Address = 10.0.0.2/24
    
    [Peer]
    PublicKey = <server-public-key>
    Endpoint = server-ip:51820
    AllowedIPs = 0.0.0.0/0
    PersistentKeepalive = 25
    """)
    
    print("\nAllowedIPs meanings:")
    print("• 0.0.0.0/0: Route ALL traffic (full tunnel)")
    print("• 10.0.0.0/24: Only VPN subnet (split tunnel)")
    print("• 10.0.0.2/32: Only this specific peer")

generate_wireguard_config()
</code></pre>
                </div>

                <div id="openvpn" class="blog-content mt-5">
                    <h2><i class="fas fa-globe me-2 text-teal"></i>OpenVPN: Flexible SSL VPN</h2>

                    <p><strong>OpenVPN</strong> is the most flexible VPN solution. Uses SSL/TLS, works over TCP or UDP, and can traverse firewalls that block other VPNs.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">Features</span></div>
                        <h4>OpenVPN Capabilities</h4>
<pre><code class="language-bash">OpenVPN Features:

1. TRANSPORT OPTIONS
   • UDP (default, faster)
   • TCP (firewall-friendly)
   • TCP 443 (looks like HTTPS)

2. AUTHENTICATION
   • Certificates (PKI)
   • Username/password
   • Two-factor (TOTP)
   • LDAP/RADIUS integration

3. MODES
   • TUN (Layer 3, routing)
   • TAP (Layer 2, bridging)

4. FLEXIBILITY
   • Push routes to clients
   • Client-specific configs
   • Split tunneling
   • Custom scripts

When to choose OpenVPN:
• Need TCP (blocked UDP)
• Complex authentication requirements
• Legacy system compatibility
• Need TAP mode (Layer 2)
</code></pre>
                    </div>

<pre><code class="language-bash"># OpenVPN server configuration

# Server: /etc/openvpn/server.conf

# Network
port 1194
proto udp
dev tun

# Certificates
ca ca.crt
cert server.crt
key server.key
dh dh2048.pem
tls-auth ta.key 0

# Network settings
server 10.8.0.0 255.255.255.0
push "redirect-gateway def1 bypass-dhcp"
push "dhcp-option DNS 8.8.8.8"

# Security
cipher AES-256-GCM
auth SHA256

# Performance
keepalive 10 120
comp-lzo

# Privileges
user nobody
group nogroup
persist-key
persist-tun

# Logging
status /var/log/openvpn-status.log
verb 3
</code></pre>

<pre><code class="language-bash"># OpenVPN client configuration

# Client: client.ovpn

client
dev tun
proto udp
remote vpn.example.com 1194
resolv-retry infinite
nobind

persist-key
persist-tun

# Certificates (inline or file reference)
ca ca.crt
cert client.crt
key client.key
tls-auth ta.key 1

cipher AES-256-GCM
auth SHA256
verb 3

# Connect
# openvpn --config client.ovpn
</code></pre>
                </div>

                <div id="ssh" class="blog-content mt-5">
                    <h2><i class="fas fa-terminal me-2 text-teal"></i>SSH Tunnels</h2>

                    <p><strong>SSH tunnels</strong> aren't full VPNs, but they're incredibly useful for quick secure access. Forward specific ports or create a SOCKS proxy—all through SSH.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Tunnel Types</span></div>
                        <h4>SSH Tunnel Options</h4>
<pre><code class="language-bash">SSH Tunnel Types:

1. LOCAL PORT FORWARDING (-L)
   Forward local port to remote service
   
   ssh -L 8080:internal-server:80 user@jump-host
   
   You → localhost:8080 → [SSH] → jump-host → internal-server:80
   
   Use: Access internal web server through jump host

2. REMOTE PORT FORWARDING (-R)
   Expose local service on remote server
   
   ssh -R 8080:localhost:3000 user@server
   
   server:8080 → [SSH] → You → localhost:3000
   
   Use: Expose local dev server publicly

3. DYNAMIC PORT FORWARDING (-D)
   Create SOCKS proxy
   
   ssh -D 1080 user@server
   
   Configure browser to use SOCKS5 localhost:1080
   All traffic goes through SSH tunnel
   
   Use: Browse as if from server's location
</code></pre>
                    </div>

<pre><code class="language-bash"># SSH tunnel examples

# Local port forwarding
# Access remote database through jump host
ssh -L 5432:database.internal:5432 user@jump-host
# Now: psql -h localhost -p 5432

# Access internal web app
ssh -L 8080:intranet.company.local:80 user@vpn-server
# Now: http://localhost:8080

# Remote port forwarding
# Expose local dev server
ssh -R 80:localhost:3000 user@public-server
# Now: http://public-server/ shows your local app

# SOCKS proxy (browse through remote)
ssh -D 1080 user@server
# Configure browser: SOCKS5, localhost:1080

# Keep tunnel alive in background
ssh -f -N -L 8080:target:80 user@jump
# -f: Background
# -N: No command (tunnel only)

# Multiple tunnels
ssh -L 8080:web:80 -L 3306:db:3306 -L 6379:redis:6379 user@jump
</code></pre>

<pre><code class="language-python"># SSH tunnel with Python (sshtunnel library)

def ssh_tunnel_example():
    """Demonstrate SSH tunnel usage"""
    
    print("SSH Tunnel with Python")
    print("=" * 50)
    
    print("""
    from sshtunnel import SSHTunnelForwarder
    import pymysql
    
    # Create tunnel to access MySQL through SSH
    with SSHTunnelForwarder(
        ('jump-host.example.com', 22),
        ssh_username='user',
        ssh_pkey='/path/to/key',
        remote_bind_address=('database.internal', 3306),
        local_bind_address=('127.0.0.1', 3306)
    ) as tunnel:
        
        # Connect to database through tunnel
        conn = pymysql.connect(
            host='127.0.0.1',
            port=tunnel.local_bind_port,
            user='dbuser',
            password='dbpass',
            database='mydb'
        )
        
        cursor = conn.cursor()
        cursor.execute('SELECT * FROM users')
        print(cursor.fetchall())
    """)
    
    print("\nInstall: pip install sshtunnel")

ssh_tunnel_example()
</code></pre>
                </div>

                <div id="gre" class="blog-content mt-5">
                    <h2><i class="fas fa-route me-2 text-teal"></i>GRE Tunnels</h2>

                    <p><strong>GRE</strong> (Generic Routing Encapsulation) creates simple tunnels without encryption. Often combined with IPsec for secure site-to-site links.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">GRE Basics</span></div>
                        <h4>GRE Overview</h4>
<pre><code class="language-bash">GRE Characteristics:

WHAT IT DOES:
• Encapsulates any protocol in IP
• Creates virtual point-to-point link
• No encryption (add IPsec for security)

USE CASES:
• Carry non-IP protocols over IP network
• Connect routing domains
• Multicast over WAN
• Usually combined with IPsec

GRE Packet:
+----------+----------+----------+----------+
| Delivery | GRE      | Passenger| Passenger|
| Header   | Header   | Header   | Payload  |
+----------+----------+----------+----------+
(Outer IP)           (Inner packet)

GRE over IPsec:
+--------+---------+----------+----------+----------+
| IP Hdr | ESP Hdr | GRE Hdr  | Inner IP | Payload  |
+--------+---------+----------+----------+----------+
         |←────── Encrypted ──────────→|
</code></pre>
                    </div>

<pre><code class="language-bash"># GRE tunnel configuration (Linux)

# Site A (192.168.1.0/24, public IP: 203.0.113.1)
ip tunnel add gre1 mode gre remote 198.51.100.1 local 203.0.113.1 ttl 255
ip link set gre1 up
ip addr add 10.0.0.1/30 dev gre1
ip route add 192.168.2.0/24 via 10.0.0.2

# Site B (192.168.2.0/24, public IP: 198.51.100.1)
ip tunnel add gre1 mode gre remote 203.0.113.1 local 198.51.100.1 ttl 255
ip link set gre1 up
ip addr add 10.0.0.2/30 dev gre1
ip route add 192.168.1.0/24 via 10.0.0.1

# Verify
ip tunnel show
ping 10.0.0.2  # Ping across tunnel

# Note: GRE alone is NOT encrypted
# Combine with IPsec for security
</code></pre>
                </div>

                <div id="comparison" class="blog-content mt-5">
                    <h2><i class="fas fa-balance-scale me-2 text-teal"></i>Protocol Comparison</h2>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Decision Guide</span></div>
                        <h4>Choosing the Right VPN</h4>
                        <table class="table table-bordered">
                            <thead><tr><th>Scenario</th><th>Best Choice</th><th>Reason</th></tr></thead>
                            <tbody>
                                <tr><td>New deployment</td><td>WireGuard</td><td>Simple, fast, modern</td></tr>
                                <tr><td>Enterprise site-to-site</td><td>IPsec IKEv2</td><td>Standard, hardware support</td></tr>
                                <tr><td>Strict firewall</td><td>OpenVPN (TCP 443)</td><td>Looks like HTTPS</td></tr>
                                <tr><td>Quick port forward</td><td>SSH tunnel</td><td>No setup, instant</td></tr>
                                <tr><td>Mobile users</td><td>WireGuard</td><td>Seamless roaming</td></tr>
                                <tr><td>Legacy integration</td><td>OpenVPN</td><td>Most flexible auth</td></tr>
                            </tbody>
                        </table>
                    </div>

<pre><code class="language-python"># VPN selection helper

def vpn_recommendation():
    """Recommend VPN based on requirements"""
    
    recommendations = {
        "greenfield": {
            "vpn": "WireGuard",
            "why": "Modern, simple, fastest performance",
            "config": "~15 lines of config"
        },
        "corporate_site_to_site": {
            "vpn": "IPsec IKEv2",
            "why": "Industry standard, hardware support",
            "config": "Complex, but well-documented"
        },
        "restricted_network": {
            "vpn": "OpenVPN over TCP 443",
            "why": "Mimics HTTPS, hard to block",
            "config": "Certificate management needed"
        },
        "quick_access": {
            "vpn": "SSH tunnel",
            "why": "No setup, use existing SSH",
            "config": "One command"
        },
        "mobile_workers": {
            "vpn": "WireGuard",
            "why": "Seamless IP changes, low battery",
            "config": "QR code import supported"
        }
    }
    
    print("VPN Recommendation Guide")
    print("=" * 50)
    
    for scenario, rec in recommendations.items():
        print(f"\n{scenario.replace('_', ' ').title()}:")
        print(f"  → {rec['vpn']}")
        print(f"     {rec['why']}")
        print(f"     Config: {rec['config']}")

vpn_recommendation()
</code></pre>
                </div>

                <div id="summary" class="blog-content mt-5">
                    <h2><i class="fas fa-check-circle me-2 text-teal"></i>Summary & Next Steps</h2>

                    <div class="highlight-box">
                        <i class="fas fa-graduation-cap"></i>
                        <strong>Key Takeaways:</strong>
                        <ul class="mt-2 mb-0">
                            <li><strong>IPsec</strong>: Enterprise standard, site-to-site, complex</li>
                            <li><strong>WireGuard</strong>: Modern, simple, fastest—the future</li>
                            <li><strong>OpenVPN</strong>: Flexible, works through firewalls</li>
                            <li><strong>SSH Tunnel</strong>: Quick port forwarding, no setup</li>
                            <li><strong>GRE</strong>: Encapsulation without encryption (add IPsec)</li>
                        </ul>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Quiz</span></div>
                        <h4>Test Your Knowledge</h4>
                        <ol>
                            <li>IPsec IKEv2 vs IKEv1? <em>(Fewer messages, NAT traversal)</em></li>
                            <li>WireGuard advantage? <em>(Simple, fast, minimal code)</em></li>
                            <li>When OpenVPN over WireGuard? <em>(TCP needed, complex auth)</em></li>
                            <li>SSH -L vs -R? <em>(Local forward vs remote forward)</em></li>
                            <li>GRE limitation? <em>(No encryption, needs IPsec)</em></li>
                        </ol>
                    </div>

                    <div class="series-next">
                        <h4><i class="fas fa-arrow-right me-2"></i>Next in the Series</h4>
                        <p>In <a href="protocols-master-authentication-protocols.html"><strong>Part 15: Authentication Protocols</strong></a>, we'll explore OAuth 2.0, SAML, Kerberos, and how identity verification works.</p>
                    </div>
                </div>

                <div class="related-posts mt-5">
                    <h3><i class="fas fa-book me-2"></i>Related Articles</h3>
                    <div class="related-post-item">
                        <h5>Part 13: IoT Protocols</h5>
                        <p>MQTT, CoAP, Zigbee for IoT devices.</p>
                        <a href="protocols-master-iot-protocols.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                    <div class="related-post-item">
                        <h5>Part 15: Authentication Protocols</h5>
                        <p>OAuth, SAML, Kerberos for identity.</p>
                        <a href="protocols-master-authentication-protocols.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                </div>

                </div>
            </div>
        </div>
    </section>

    <footer id="social-media" class="bg-dark text-light py-5">
        <div class="container py-5">
            <div class="row mb-4">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h5 class="fw-bold mb-3">Let's Connect</h5>
                    <p class="text-light">
                        I'm always interested in sharing content about my interests on different topics. Read disclaimer and feel free to share further.
                    </p>
                </div>
                <div class="col-lg-6">
                    <h5 class="fw-bold mb-3">Follow Me</h5>
                    <div class="social-links d-flex gap-2 flex-wrap">
                        <a href="https://www.facebook.com/wasil.zafar/" target="_blank" class="social-icon" title="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://twitter.com/wasilzafar" target="_blank" class="social-icon" title="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.linkedin.com/in/wasilzafar" target="_blank" class="social-icon" title="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://www.youtube.com/@wasilzafar" target="_blank" class="social-icon" title="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://www.instagram.com/itswzee/" target="_blank" class="social-icon" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://in.pinterest.com/wasilz/" target="_blank" class="social-icon" title="Pinterest">
                            <i class="fab fa-pinterest-p"></i>
                        </a>
                        <a href="mailto:wasil.zafar@gmail.com" class="social-icon" title="Email">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>

            <hr class="bg-secondary">

            <div class="row mt-4">
                <div class="col-md-6">
                    <p class="small">
                        <i class="fas fa-icons me-2"></i>Icons from <a href="https://www.flaticon.com/" target="_blank" class="text-light">Flaticon</a> &amp; <a href="https://fontawesome.com/" target="_blank" class="text-light">Font Awesome</a>
                    </p>
                    <p class="small mt-3">
                        <a href="/" class="text-light text-decoration-none">Home</a> | 
                        <a href="/disclaimer.html" class="text-light text-decoration-none">Disclaimer</a> | 
                        <a href="/privacy-policy.html" class="text-light text-decoration-none">Privacy Policy</a>
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small">
                        Enjoying this content? ☕ <a href="https://buymeacoffee.com/itswzee" target="_blank" class="text-light" style="text-decoration: underline;">Keep me caffeinated</a> to keep the pixels flowing!
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <button id="scrollToTop" class="scroll-to-top"><i class="fas fa-arrow-up"></i></button>
    <div id="categoryIndicator" class="category-indicator"></div>
    <script src="../../../js/cookie-consent.js"></script>
    <script src="../../../js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
</body>
</html>
