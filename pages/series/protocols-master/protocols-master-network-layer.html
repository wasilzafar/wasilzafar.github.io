<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="robots" content="index, archive" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Master the Network Layer and IP protocol. Learn IPv4, IPv6, subnetting, CIDR, ICMP, routing protocols, and how packets traverse the internet with hands-on examples." />
    <meta name="author" content="Wasil Zafar" />
    <meta name="keywords" content="IPv4, IPv6, Network Layer, IP Addressing, Subnetting, CIDR, ICMP, Routing, BGP, OSPF, NAT" />
    <meta property="og:title" content="Complete Protocols Master Part 3: Network Layer & IP" />
    <meta property="og:description" content="Master the Network Layer and IP protocol. Learn IPv4, IPv6, subnetting, CIDR, ICMP, and routing protocols." />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2026-01-31" />
    <meta property="article:author" content="Wasil Zafar" />
    <meta property="article:section" content="Technology" />
    
    <title>Complete Protocols Master Part 3: Network Layer & IP - Wasil Zafar</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet" />

    <!-- Custom Styles -->
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" />

    <!-- Prism.js Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" id="prism-theme" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" id="prism-default" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-dark.min.css" id="prism-dark" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-twilight.min.css" id="prism-twilight" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" id="prism-okaidia" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-solarizedlight.min.css" id="prism-solarizedlight" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" />

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="../../../images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../images/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="../../../images/favicon_io/site.webmanifest">

    <!-- Google Consent Mode v2 -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied',
            'region': ['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE']
        });
        
        gtag('consent', 'default', {
            'ad_storage': 'granted',
            'ad_user_data': 'granted',
            'ad_personalization': 'granted',
            'analytics_storage': 'granted'
        });
        
        gtag('set', 'url_passthrough', true);
    </script>

    <!-- Google Tag Manager -->
    <script>
        (function(w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-PBS8M2JR');
    </script>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBS8M2JR" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/">
                <span class="gradient-text">Wasil Zafar</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#skills">Skills</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#certifications">Certifications</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#interests">Interests</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="blog-hero">
        <div class="container py-5">
            <div class="blog-header">
                <a href="/pages/categories/technology.html" class="back-link"><i class="fas fa-arrow-left me-2"></i>Back to Technology</a>
                <h1 class="display-4 fw-bold mb-3">Complete Protocols Master Part 3: Network Layer & IP</h1>
                <div class="blog-meta">
                    <span><i class="fas fa-calendar me-2"></i>January 31, 2026</span>
                    <span><i class="fas fa-user me-2"></i>Wasil Zafar</span>
                    <span class="reading-time"><i class="fas fa-clock me-1"></i>38 min read</span>
                    <button onclick="window.print()" class="print-btn" title="Print this article"><i class="fas fa-print"></i> Print</button>
                </div>
                <p class="lead">Master the Network Layer where packets find their path across networks. Learn IPv4 and IPv6 addressing, subnetting, CIDR notation, ICMP, NAT, and the routing protocols that make the global internet possible.</p>
            </div>
        </div>
    </section>

    <!-- Table of Contents Toggle Button -->
    <button class="toc-toggle-btn" onclick="openNav()" title="Table of Contents" aria-label="Open Table of Contents">
        <i class="fas fa-list"></i>
    </button>

    <!-- Side Navigation Overlay -->
    <div id="tocSidenav" class="sidenav-toc">
        <div class="toc-header">
            <h3><i class="fas fa-list me-2"></i>Table of Contents</h3>
            <button class="closebtn" onclick="closeNav()" aria-label="Close Table of Contents">&times;</button>
        </div>
        <ol>
            <li>
                <a href="#introduction" onclick="closeNav()">Introduction</a>
                <ul>
                    <li><a href="#introduction" onclick="closeNav()">Layer 3 Overview</a></li>
                    <li><a href="#series-nav" onclick="closeNav()">Series Navigation</a></li>
                </ul>
            </li>
            <li>
                <a href="#ipv4" onclick="closeNav()">IPv4 Addressing</a>
                <ul>
                    <li><a href="#ipv4" onclick="closeNav()">Address Structure</a></li>
                    <li><a href="#address-classes" onclick="closeNav()">Address Classes</a></li>
                    <li><a href="#private-addresses" onclick="closeNav()">Private Addresses</a></li>
                </ul>
            </li>
            <li>
                <a href="#subnetting" onclick="closeNav()">Subnetting & CIDR</a>
                <ul>
                    <li><a href="#subnetting" onclick="closeNav()">Subnet Masks</a></li>
                    <li><a href="#cidr" onclick="closeNav()">CIDR Notation</a></li>
                    <li><a href="#subnet-calc" onclick="closeNav()">Subnet Calculations</a></li>
                </ul>
            </li>
            <li>
                <a href="#ipv6" onclick="closeNav()">IPv6 Addressing</a>
                <ul>
                    <li><a href="#ipv6" onclick="closeNav()">Why IPv6?</a></li>
                    <li><a href="#ipv6-format" onclick="closeNav()">Address Format</a></li>
                    <li><a href="#ipv6-types" onclick="closeNav()">Address Types</a></li>
                </ul>
            </li>
            <li>
                <a href="#ip-header" onclick="closeNav()">IP Packet Structure</a>
                <ul>
                    <li><a href="#ip-header" onclick="closeNav()">IPv4 Header</a></li>
                    <li><a href="#ipv6-header" onclick="closeNav()">IPv6 Header</a></li>
                    <li><a href="#fragmentation" onclick="closeNav()">Fragmentation</a></li>
                </ul>
            </li>
            <li>
                <a href="#icmp" onclick="closeNav()">ICMP Protocol</a>
                <ul>
                    <li><a href="#icmp" onclick="closeNav()">ICMP Messages</a></li>
                    <li><a href="#ping" onclick="closeNav()">Ping & Traceroute</a></li>
                </ul>
            </li>
            <li>
                <a href="#routing" onclick="closeNav()">Routing Fundamentals</a>
                <ul>
                    <li><a href="#routing" onclick="closeNav()">How Routing Works</a></li>
                    <li><a href="#routing-protocols" onclick="closeNav()">Routing Protocols</a></li>
                    <li><a href="#bgp" onclick="closeNav()">BGP & Internet Routing</a></li>
                </ul>
            </li>
            <li>
                <a href="#nat" onclick="closeNav()">NAT & PAT</a>
                <ul>
                    <li><a href="#nat" onclick="closeNav()">Network Address Translation</a></li>
                    <li><a href="#nat-types" onclick="closeNav()">NAT Types</a></li>
                </ul>
            </li>
            <li>
                <a href="#hands-on" onclick="closeNav()">Hands-On Exercises</a>
                <ul>
                    <li><a href="#hands-on" onclick="closeNav()">IP Tools</a></li>
                    <li><a href="#python-ip" onclick="closeNav()">Python IP Library</a></li>
                </ul>
            </li>
            <li>
                <a href="#summary" onclick="closeNav()">Summary & Next Steps</a>
            </li>
        </ol>
    </div>

    <!-- Overlay Backdrop -->
    <div id="tocOverlay" class="sidenav-overlay" onclick="closeNav()"></div>

    <!-- Main Content -->
    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">

                <!-- Introduction -->
                <div id="introduction" class="blog-content">
                    <h2><i class="fas fa-globe me-2 text-teal"></i>Introduction: The Network Layer</h2>
                    
                    <p>In <a href="protocols-master-physical-datalink.html">Part 2</a>, we explored how data moves within local networks at Layers 1 and 2. Now we ascend to <strong>Layer 3—the Network Layer</strong>—where the magic of global connectivity happens. This is where:</p>
                    
                    <ul>
                        <li><strong>Logical addresses (IP)</strong> replace physical addresses (MAC)</li>
                        <li><strong>Routers</strong> make forwarding decisions across networks</li>
                        <li><strong>Packets</strong> find paths across the globe</li>
                        <li><strong>The Internet</strong> becomes possible</li>
                    </ul>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-sitemap me-2"></i>
                        <strong>Series Context:</strong> This is <strong>Part 3 of 20</strong> in the Complete Protocols Master series. We're building up from physical layers to application protocols.
                    </div>

                    <div class="experiment-card" id="series-nav">
                        <h4><i class="fas fa-map-signs me-2"></i>Complete Series Navigation</h4>
                        <div class="meta mb-2">
                            <span class="badge bg-teal me-2">20-Part Series</span>
                            <span class="badge bg-crimson">Protocol Mastery</span>
                        </div>
                        <div class="content">
                            <ol>
                                <li><a href="protocols-master-osi-foundations.html"><strong>Part 1:</strong> OSI Model & Protocol Foundations</a> — Network layers, encapsulation, TCP/IP model</li>
                                <li><a href="protocols-master-physical-datalink.html"><strong>Part 2:</strong> Physical & Data Link Layers</a> — Ethernet, Wi-Fi, VLANs, MAC addressing</li>
                                <li><strong>Part 3: Network Layer & IP (This Guide)</strong> — IPv4, IPv6, ICMP, routing protocols</li>
                                <li><a href="protocols-master-transport-layer.html"><strong>Part 4:</strong> Transport Layer</a> — TCP, UDP, QUIC, ports, sockets</li>
                                <li><a href="protocols-master-session-presentation.html"><strong>Part 5:</strong> Session & Presentation Layers</a> — TLS handshake, encryption, serialization</li>
                                <li><a href="protocols-master-web-protocols.html"><strong>Part 6:</strong> Web Protocols</a> — HTTP/1.1, HTTP/2, HTTP/3, WebSockets</li>
                                <li><a href="protocols-master-api-protocols.html"><strong>Part 7:</strong> API Protocols</a> — REST, GraphQL, gRPC, SOAP</li>
                                <li><a href="protocols-master-dns-deep-dive.html"><strong>Part 8:</strong> DNS Deep Dive</a> — DNS hierarchy, records, DNSSEC</li>
                                <li><a href="protocols-master-email-protocols.html"><strong>Part 9:</strong> Email Protocols</a> — SMTP, IMAP, POP3, SPF/DKIM/DMARC</li>
                                <li><a href="protocols-master-file-transfer.html"><strong>Part 10:</strong> File Transfer Protocols</a> — FTP, SFTP, SCP, rsync</li>
                                <li><a href="protocols-master-realtime-protocols.html"><strong>Part 11:</strong> Real-Time Protocols</a> — WebRTC, SIP, RTP, VoIP</li>
                                <li><a href="protocols-master-streaming-protocols.html"><strong>Part 12:</strong> Streaming Protocols</a> — HLS, DASH, RTMP, media delivery</li>
                                <li><a href="protocols-master-iot-protocols.html"><strong>Part 13:</strong> IoT Protocols</a> — MQTT, CoAP, Zigbee, LoRaWAN</li>
                                <li><a href="protocols-master-vpn-tunneling.html"><strong>Part 14:</strong> VPN & Tunneling</a> — IPsec, OpenVPN, WireGuard</li>
                                <li><a href="protocols-master-authentication-protocols.html"><strong>Part 15:</strong> Authentication Protocols</a> — OAuth, SAML, OIDC, Kerberos</li>
                                <li><a href="protocols-master-network-management.html"><strong>Part 16:</strong> Network Management</a> — SNMP, NetFlow, Syslog</li>
                                <li><a href="protocols-master-security-protocols.html"><strong>Part 17:</strong> Security Protocols</a> — TLS/SSL, certificates, PKI</li>
                                <li><a href="protocols-master-cloud-protocols.html"><strong>Part 18:</strong> Cloud Provider Protocols</a> — AWS, Azure, GCP APIs</li>
                                <li><a href="protocols-master-emerging-protocols.html"><strong>Part 19:</strong> Emerging Protocols</a> — QUIC, HTTP/3, WebTransport</li>
                                <li><a href="protocols-master-web-security-standards.html"><strong>Part 20:</strong> Web Security Standards</a> — CORS, CSP, HSTS, SRI</li>
                            </ol>
                        </div>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">Layer 3</span>
                            <span class="badge bg-teal text-white">Network Layer</span>
                        </div>
                        <h4>Network Layer Responsibilities</h4>
                        <ul>
                            <li><strong>Logical Addressing:</strong> IP addresses identify devices globally</li>
                            <li><strong>Routing:</strong> Determining the best path for packets</li>
                            <li><strong>Packet Forwarding:</strong> Moving packets hop-by-hop toward destination</li>
                            <li><strong>Fragmentation:</strong> Breaking large packets to fit link MTU</li>
                            <li><strong>Error Reporting:</strong> ICMP for network diagnostics</li>
                        </ul>
                        <p class="mt-3"><strong>Key Protocols:</strong> IP (IPv4, IPv6), ICMP, IGMP, IPsec</p>
                        <p><strong>Key Devices:</strong> Routers, Layer 3 switches</p>
                    </div>

                    <div class="highlight-box">
                        <i class="fas fa-lightbulb"></i>
                        <strong>MAC vs IP:</strong> MAC addresses work on <em>local</em> networks (Layer 2). IP addresses work <em>globally</em> (Layer 3). When a packet crosses a router, the MAC addresses change at each hop, but the IP addresses stay the same end-to-end.
                    </div>
                </div>

                <!-- IPv4 Section -->
                <div id="ipv4" class="blog-content mt-5">
                    <h2><i class="fas fa-network-wired me-2 text-teal"></i>IPv4 Addressing</h2>
                    
                    <p><strong>Internet Protocol version 4 (IPv4)</strong> has been the backbone of the internet since 1983. Despite IPv6's availability, IPv4 still carries the majority of internet traffic.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">IPv4</span>
                        </div>
                        <h4>IPv4 Address Structure</h4>
                        <p>An IPv4 address is a <strong>32-bit number</strong>, typically written in <strong>dotted decimal notation</strong>:</p>
<pre><code class="language-bash">IPv4 Address: 192.168.1.100

Binary representation:
192      .168      .1        .100
11000000 .10101000 .00000001 .01100100

Each octet: 8 bits (0-255)
Total: 32 bits = 4 bytes
Maximum addresses: 2^32 = 4,294,967,296 (~4.3 billion)
</code></pre>
                    </div>

<pre><code class="language-python"># Understanding IPv4 addresses in Python
import ipaddress

# Create an IPv4 address object
ip = ipaddress.IPv4Address('192.168.1.100')

print(f"Address: {ip}")
print(f"Integer value: {int(ip)}")
print(f"Binary: {bin(int(ip))}")
print(f"Packed bytes: {ip.packed}")
print(f"Is private: {ip.is_private}")
print(f"Is global: {ip.is_global}")
print(f"Is loopback: {ip.is_loopback}")
print(f"Is multicast: {ip.is_multicast}")

# Convert between formats
ip_from_int = ipaddress.IPv4Address(3232235876)
print(f"\nFrom integer 3232235876: {ip_from_int}")

# Binary to decimal conversion for each octet
def ip_to_binary(ip_str):
    """Convert IP address to binary representation"""
    octets = ip_str.split('.')
    binary = [format(int(octet), '08b') for octet in octets]
    return '.'.join(binary)

print(f"\n192.168.1.100 in binary: {ip_to_binary('192.168.1.100')}")
</code></pre>

                    <h3 id="address-classes">IPv4 Address Classes (Historical)</h3>

                    <p>Originally, IPv4 addresses were divided into classes. While <strong>classful addressing is obsolete</strong>, understanding it helps comprehend legacy systems and network fundamentals:</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">Historical Reference</span>
                        </div>
                        <h4>Classful Address Ranges</h4>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Class</th>
                                    <th>First Octet</th>
                                    <th>Range</th>
                                    <th>Default Mask</th>
                                    <th>Networks</th>
                                    <th>Hosts/Network</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>A</strong></td>
                                    <td>0xxxxxxx</td>
                                    <td>1.0.0.0 - 126.255.255.255</td>
                                    <td>/8 (255.0.0.0)</td>
                                    <td>126</td>
                                    <td>16,777,214</td>
                                </tr>
                                <tr>
                                    <td><strong>B</strong></td>
                                    <td>10xxxxxx</td>
                                    <td>128.0.0.0 - 191.255.255.255</td>
                                    <td>/16 (255.255.0.0)</td>
                                    <td>16,384</td>
                                    <td>65,534</td>
                                </tr>
                                <tr>
                                    <td><strong>C</strong></td>
                                    <td>110xxxxx</td>
                                    <td>192.0.0.0 - 223.255.255.255</td>
                                    <td>/24 (255.255.255.0)</td>
                                    <td>2,097,152</td>
                                    <td>254</td>
                                </tr>
                                <tr>
                                    <td><strong>D</strong></td>
                                    <td>1110xxxx</td>
                                    <td>224.0.0.0 - 239.255.255.255</td>
                                    <td>N/A</td>
                                    <td colspan="2">Multicast</td>
                                </tr>
                                <tr>
                                    <td><strong>E</strong></td>
                                    <td>1111xxxx</td>
                                    <td>240.0.0.0 - 255.255.255.255</td>
                                    <td>N/A</td>
                                    <td colspan="2">Reserved/Experimental</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>Note:</strong> Classful addressing wasted IP addresses massively. A Class A network gave you 16 million hosts even if you needed 1,000. Modern networks use <strong>CIDR (Classless Inter-Domain Routing)</strong> for flexible address allocation.
                    </div>

                    <h3 id="private-addresses">Private and Special Addresses</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">RFC 1918</span>
                        </div>
                        <h4>Private Address Ranges</h4>
                        <p>These addresses are not routable on the public internet and can be reused by any organization:</p>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Range</th>
                                    <th>CIDR</th>
                                    <th>Addresses</th>
                                    <th>Typical Use</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>10.0.0.0 - 10.255.255.255</td>
                                    <td>10.0.0.0/8</td>
                                    <td>16,777,216</td>
                                    <td>Large enterprises, cloud VPCs</td>
                                </tr>
                                <tr>
                                    <td>172.16.0.0 - 172.31.255.255</td>
                                    <td>172.16.0.0/12</td>
                                    <td>1,048,576</td>
                                    <td>Medium organizations</td>
                                </tr>
                                <tr>
                                    <td>192.168.0.0 - 192.168.255.255</td>
                                    <td>192.168.0.0/16</td>
                                    <td>65,536</td>
                                    <td>Home networks, small offices</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">Special Addresses</span>
                        </div>
                        <h4>Other Reserved Addresses</h4>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Range</th>
                                    <th>Purpose</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>127.0.0.0/8</code></td>
                                    <td><strong>Loopback</strong> - localhost (usually 127.0.0.1)</td>
                                </tr>
                                <tr>
                                    <td><code>169.254.0.0/16</code></td>
                                    <td><strong>Link-Local</strong> - Auto-assigned when DHCP fails (APIPA)</td>
                                </tr>
                                <tr>
                                    <td><code>0.0.0.0/8</code></td>
                                    <td><strong>This Network</strong> - Used during boot before IP assigned</td>
                                </tr>
                                <tr>
                                    <td><code>255.255.255.255</code></td>
                                    <td><strong>Limited Broadcast</strong> - Local network broadcast</td>
                                </tr>
                                <tr>
                                    <td><code>100.64.0.0/10</code></td>
                                    <td><strong>Carrier-Grade NAT</strong> - ISP shared address space</td>
                                </tr>
                                <tr>
                                    <td><code>192.0.2.0/24</code></td>
                                    <td><strong>Documentation</strong> - TEST-NET-1 for examples</td>
                                </tr>
                                <tr>
                                    <td><code>203.0.113.0/24</code></td>
                                    <td><strong>Documentation</strong> - TEST-NET-3 for examples</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Subnetting Section -->
                <div id="subnetting" class="blog-content mt-5">
                    <h2><i class="fas fa-project-diagram me-2 text-teal"></i>Subnetting & CIDR</h2>
                    
                    <p><strong>Subnetting</strong> divides a network into smaller, manageable pieces. <strong>CIDR (Classless Inter-Domain Routing)</strong> provides flexible allocation by specifying exactly how many bits identify the network.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">Subnet Mask</span>
                        </div>
                        <h4>Understanding Subnet Masks</h4>
                        <p>A subnet mask separates the <strong>network portion</strong> from the <strong>host portion</strong> of an IP address:</p>
<pre><code class="language-bash">IP Address:   192.168.1.100
Subnet Mask:  255.255.255.0

Binary:
IP:           11000000.10101000.00000001.01100100
Mask:         11111111.11111111.11111111.00000000
              |______Network______|___Host__|

Network bits (1s): Identify the network
Host bits (0s):    Identify devices within the network

Network Address:  192.168.1.0   (all host bits = 0)
Broadcast:        192.168.1.255 (all host bits = 1)
Usable Hosts:     192.168.1.1 - 192.168.1.254 (254 hosts)
</code></pre>
                    </div>

                    <h3 id="cidr">CIDR Notation</h3>

                    <p>CIDR notation uses a <strong>slash followed by the number of network bits</strong>:</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">CIDR Reference</span>
                        </div>
                        <h4>Common CIDR Blocks</h4>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>CIDR</th>
                                    <th>Subnet Mask</th>
                                    <th>Addresses</th>
                                    <th>Usable Hosts</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>/8</td>
                                    <td>255.0.0.0</td>
                                    <td>16,777,216</td>
                                    <td>16,777,214</td>
                                </tr>
                                <tr>
                                    <td>/16</td>
                                    <td>255.255.0.0</td>
                                    <td>65,536</td>
                                    <td>65,534</td>
                                </tr>
                                <tr>
                                    <td>/20</td>
                                    <td>255.255.240.0</td>
                                    <td>4,096</td>
                                    <td>4,094</td>
                                </tr>
                                <tr>
                                    <td>/24</td>
                                    <td>255.255.255.0</td>
                                    <td>256</td>
                                    <td>254</td>
                                </tr>
                                <tr>
                                    <td>/25</td>
                                    <td>255.255.255.128</td>
                                    <td>128</td>
                                    <td>126</td>
                                </tr>
                                <tr>
                                    <td>/26</td>
                                    <td>255.255.255.192</td>
                                    <td>64</td>
                                    <td>62</td>
                                </tr>
                                <tr>
                                    <td>/27</td>
                                    <td>255.255.255.224</td>
                                    <td>32</td>
                                    <td>30</td>
                                </tr>
                                <tr>
                                    <td>/28</td>
                                    <td>255.255.255.240</td>
                                    <td>16</td>
                                    <td>14</td>
                                </tr>
                                <tr>
                                    <td>/29</td>
                                    <td>255.255.255.248</td>
                                    <td>8</td>
                                    <td>6</td>
                                </tr>
                                <tr>
                                    <td>/30</td>
                                    <td>255.255.255.252</td>
                                    <td>4</td>
                                    <td>2</td>
                                </tr>
                                <tr>
                                    <td>/31</td>
                                    <td>255.255.255.254</td>
                                    <td>2</td>
                                    <td>2*</td>
                                </tr>
                                <tr>
                                    <td>/32</td>
                                    <td>255.255.255.255</td>
                                    <td>1</td>
                                    <td>1 (host route)</td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="mt-2 small">* /31 is special - used for point-to-point links (RFC 3021), no network/broadcast addresses needed</p>
                    </div>

                    <h3 id="subnet-calc">Subnet Calculations</h3>

<pre><code class="language-python"># Comprehensive subnet calculator in Python
import ipaddress

def analyze_network(network_str):
    """
    Analyze an IPv4 network and display all relevant information
    """
    network = ipaddress.IPv4Network(network_str, strict=False)
    
    print(f"Network Analysis: {network_str}")
    print("=" * 50)
    
    # Basic info
    print(f"Network Address:    {network.network_address}")
    print(f"Broadcast Address:  {network.broadcast_address}")
    print(f"Subnet Mask:        {network.netmask}")
    print(f"Wildcard Mask:      {network.hostmask}")
    print(f"CIDR Notation:      /{network.prefixlen}")
    
    # Address counts
    print(f"\nTotal Addresses:    {network.num_addresses}")
    print(f"Usable Hosts:       {network.num_addresses - 2 if network.num_addresses > 2 else network.num_addresses}")
    
    # Host range
    hosts = list(network.hosts())
    if hosts:
        print(f"First Usable Host:  {hosts[0]}")
        print(f"Last Usable Host:   {hosts[-1]}")
    
    # Binary representation
    print(f"\nBinary Network:     {bin(int(network.network_address))[2:].zfill(32)}")
    print(f"Binary Mask:        {bin(int(network.netmask))[2:].zfill(32)}")
    
    return network

# Example analysis
print("EXAMPLE 1: Standard /24 Network")
print("-" * 50)
analyze_network("192.168.1.0/24")

print("\n\nEXAMPLE 2: /27 Subnet")
print("-" * 50)
analyze_network("10.0.0.0/27")

print("\n\nEXAMPLE 3: Check if IP is in network")
print("-" * 50)
network = ipaddress.IPv4Network("192.168.1.0/24")
test_ips = ["192.168.1.50", "192.168.2.50", "192.168.1.255"]

for ip_str in test_ips:
    ip = ipaddress.IPv4Address(ip_str)
    in_network = ip in network
    print(f"{ip_str} in 192.168.1.0/24: {in_network}")
</code></pre>

<pre><code class="language-python"># Subnet division example
import ipaddress

def divide_network(network_str, new_prefix):
    """
    Divide a network into smaller subnets
    """
    network = ipaddress.IPv4Network(network_str)
    
    if new_prefix <= network.prefixlen:
        raise ValueError(f"New prefix must be larger than {network.prefixlen}")
    
    subnets = list(network.subnets(new_prefix=new_prefix))
    
    print(f"Dividing {network_str} into /{new_prefix} subnets:")
    print("=" * 60)
    
    for i, subnet in enumerate(subnets):
        hosts = list(subnet.hosts())
        first_host = hosts[0] if hosts else "N/A"
        last_host = hosts[-1] if hosts else "N/A"
        
        print(f"Subnet {i+1}: {subnet}")
        print(f"  Network:   {subnet.network_address}")
        print(f"  Broadcast: {subnet.broadcast_address}")
        print(f"  Range:     {first_host} - {last_host}")
        print(f"  Hosts:     {len(hosts)}")
        print()
    
    return subnets

# Divide a /24 into four /26 subnets
print("Scenario: Divide 192.168.1.0/24 into 4 departments")
print("-" * 60)
divide_network("192.168.1.0/24", 26)
</code></pre>

                    <div class="highlight-box">
                        <i class="fas fa-calculator"></i>
                        <strong>Quick Math:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Hosts per subnet = 2<sup>(32 - prefix)</sup> - 2</li>
                            <li>/24 = 2<sup>8</sup> - 2 = 254 hosts</li>
                            <li>/26 = 2<sup>6</sup> - 2 = 62 hosts</li>
                            <li>/28 = 2<sup>4</sup> - 2 = 14 hosts</li>
                            <li>Subnets when dividing = 2<sup>(new_prefix - old_prefix)</sup></li>
                        </ul>
                    </div>
                </div>

                <!-- IPv6 Section -->
                <div id="ipv6" class="blog-content mt-5">
                    <h2><i class="fas fa-globe-americas me-2 text-teal"></i>IPv6 Addressing</h2>
                    
                    <p><strong>IPv6</strong> was designed to solve IPv4 address exhaustion. With 128-bit addresses, it provides 340 undecillion addresses—enough for every atom on Earth's surface!</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">Why IPv6?</span>
                        </div>
                        <h4>IPv4 vs IPv6 Comparison</h4>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Feature</th>
                                    <th>IPv4</th>
                                    <th>IPv6</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Address Size</td>
                                    <td>32 bits (4 bytes)</td>
                                    <td>128 bits (16 bytes)</td>
                                </tr>
                                <tr>
                                    <td>Address Space</td>
                                    <td>~4.3 billion</td>
                                    <td>~340 undecillion (3.4 × 10<sup>38</sup>)</td>
                                </tr>
                                <tr>
                                    <td>Notation</td>
                                    <td>Dotted decimal (192.168.1.1)</td>
                                    <td>Hexadecimal (2001:db8::1)</td>
                                </tr>
                                <tr>
                                    <td>Header Size</td>
                                    <td>20-60 bytes (variable)</td>
                                    <td>40 bytes (fixed)</td>
                                </tr>
                                <tr>
                                    <td>Fragmentation</td>
                                    <td>Routers and hosts</td>
                                    <td>Source only (no router fragmentation)</td>
                                </tr>
                                <tr>
                                    <td>Broadcast</td>
                                    <td>Yes</td>
                                    <td>No (uses multicast instead)</td>
                                </tr>
                                <tr>
                                    <td>IPsec</td>
                                    <td>Optional</td>
                                    <td>Mandatory support</td>
                                </tr>
                                <tr>
                                    <td>Auto-configuration</td>
                                    <td>DHCP required</td>
                                    <td>SLAAC built-in</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 id="ipv6-format">IPv6 Address Format</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">Format Rules</span>
                        </div>
                        <h4>IPv6 Address Structure</h4>
<pre><code class="language-bash">Full IPv6 Address:
2001:0db8:85a3:0000:0000:8a2e:0370:7334

Structure:
- 8 groups of 4 hexadecimal digits
- Separated by colons
- Each group = 16 bits
- Total = 128 bits

Compression Rules:

1. Leading zeros in a group can be omitted:
   2001:0db8:0001:0000:0000:0000:0000:0001
   → 2001:db8:1:0:0:0:0:1

2. One sequence of consecutive all-zero groups can be replaced with ::
   2001:db8:1:0:0:0:0:1
   → 2001:db8:1::1

3. :: can only be used ONCE in an address
   (otherwise ambiguous how many zeros)

Examples:
   ::1                     = Loopback (like 127.0.0.1)
   ::                      = All zeros (unspecified)
   2001:db8::              = 2001:db8:0:0:0:0:0:0
   fe80::1                 = Link-local address
   2001:db8:85a3::8a2e:370:7334 = Typical compressed form
</code></pre>
                    </div>

<pre><code class="language-python"># Working with IPv6 in Python
import ipaddress

# Create IPv6 address objects
full_addr = ipaddress.IPv6Address('2001:0db8:85a3:0000:0000:8a2e:0370:7334')
compressed = ipaddress.IPv6Address('2001:db8:85a3::8a2e:370:7334')
loopback = ipaddress.IPv6Address('::1')

print("IPv6 Address Analysis")
print("=" * 60)

for addr in [full_addr, compressed, loopback]:
    print(f"\nAddress: {addr}")
    print(f"  Compressed:  {addr.compressed}")
    print(f"  Exploded:    {addr.exploded}")
    print(f"  Is loopback: {addr.is_loopback}")
    print(f"  Is link-local: {addr.is_link_local}")
    print(f"  Is global:   {addr.is_global}")
    print(f"  Is private:  {addr.is_private}")

# IPv6 network analysis
print("\n\nIPv6 Network Analysis")
print("=" * 60)
network = ipaddress.IPv6Network('2001:db8::/32')
print(f"Network:     {network}")
print(f"Prefix:      /{network.prefixlen}")
print(f"Num addresses: {network.num_addresses}")
print(f"First addr:  {network.network_address}")
print(f"Last addr:   {network.broadcast_address}")

# Common IPv6 prefix sizes
print("\n\nCommon IPv6 Allocations")
print("=" * 60)
allocations = [
    ("/32", "Regional Internet Registry (RIR) to ISP"),
    ("/48", "ISP to Customer site"),
    ("/56", "ISP to Residential customer"),
    ("/64", "Single subnet (standard)"),
    ("/128", "Single host (loopback, etc.)")
]
for prefix, description in allocations:
    print(f"{prefix:8} - {description}")
</code></pre>

                    <h3 id="ipv6-types">IPv6 Address Types</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">Address Types</span>
                        </div>
                        <h4>IPv6 Address Categories</h4>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Prefix</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Global Unicast</strong></td>
                                    <td>2000::/3</td>
                                    <td>Routable on the internet (like public IPv4)</td>
                                </tr>
                                <tr>
                                    <td><strong>Link-Local</strong></td>
                                    <td>fe80::/10</td>
                                    <td>Auto-configured, not routed (local network only)</td>
                                </tr>
                                <tr>
                                    <td><strong>Unique Local (ULA)</strong></td>
                                    <td>fc00::/7 (fd00::/8 used)</td>
                                    <td>Private addresses (like RFC 1918 in IPv4)</td>
                                </tr>
                                <tr>
                                    <td><strong>Multicast</strong></td>
                                    <td>ff00::/8</td>
                                    <td>One-to-many communication</td>
                                </tr>
                                <tr>
                                    <td><strong>Loopback</strong></td>
                                    <td>::1/128</td>
                                    <td>Localhost (like 127.0.0.1)</td>
                                </tr>
                                <tr>
                                    <td><strong>Unspecified</strong></td>
                                    <td>::/128</td>
                                    <td>No address assigned yet</td>
                                </tr>
                                <tr>
                                    <td><strong>Documentation</strong></td>
                                    <td>2001:db8::/32</td>
                                    <td>For examples and documentation</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="highlight-box">
                        <i class="fas fa-lightbulb"></i>
                        <strong>IPv6 in Practice:</strong> Every IPv6 interface typically has multiple addresses:
                        <ul class="mb-0 mt-2">
                            <li><strong>Link-local (fe80::)</strong> - Always present, auto-configured</li>
                            <li><strong>Global unicast (2xxx::)</strong> - For internet communication</li>
                            <li><strong>Privacy address</strong> - Temporary, rotates for privacy (SLAAC)</li>
                        </ul>
                    </div>
                </div>

                <!-- IP Header Section -->
                <div id="ip-header" class="blog-content mt-5">
                    <h2><i class="fas fa-file-code me-2 text-teal"></i>IP Packet Structure</h2>
                    
                    <p>Understanding the IP header helps you debug network issues, analyze packet captures, and understand how routing decisions are made.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">IPv4 Header</span>
                        </div>
                        <h4>IPv4 Header Format (20-60 bytes)</h4>
<pre><code class="language-bash"> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Version|  IHL  |    DSCP   |ECN|         Total Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Identification        |Flags|     Fragment Offset     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Time to Live |    Protocol   |        Header Checksum        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Source IP Address                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Destination IP Address                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Options (if IHL > 5)                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Key Fields:
- Version (4 bits): Always 4 for IPv4
- IHL (4 bits): Header length in 32-bit words (min 5 = 20 bytes)
- TTL (8 bits): Decremented by each router, prevents infinite loops
- Protocol (8 bits): 1=ICMP, 6=TCP, 17=UDP, 47=GRE, 50=ESP
- Source/Dest IP: 32-bit addresses
</code></pre>
                    </div>

<pre><code class="language-python"># Parse IPv4 header in Python
import struct

def parse_ipv4_header(data):
    """Parse IPv4 packet header"""
    # First 20 bytes are the minimum IPv4 header
    # Unpack first byte separately to extract version and IHL
    version_ihl = data[0]
    version = version_ihl >> 4
    ihl = version_ihl & 0x0F
    header_length = ihl * 4  # In bytes
    
    # Unpack rest of the header
    dscp_ecn, total_length = struct.unpack('!BH', data[1:4])
    identification, flags_frag = struct.unpack('!HH', data[4:8])
    
    flags = flags_frag >> 13
    fragment_offset = flags_frag & 0x1FFF
    
    ttl, protocol, checksum = struct.unpack('!BBH', data[8:12])
    src_ip = '.'.join(str(b) for b in data[12:16])
    dst_ip = '.'.join(str(b) for b in data[16:20])
    
    protocols = {1: 'ICMP', 6: 'TCP', 17: 'UDP', 47: 'GRE', 50: 'ESP'}
    
    return {
        'version': version,
        'header_length': header_length,
        'dscp': dscp_ecn >> 2,
        'ecn': dscp_ecn & 0x03,
        'total_length': total_length,
        'identification': identification,
        'flags': {
            'reserved': (flags >> 2) & 1,
            'dont_fragment': (flags >> 1) & 1,
            'more_fragments': flags & 1
        },
        'fragment_offset': fragment_offset,
        'ttl': ttl,
        'protocol': protocols.get(protocol, f'Unknown ({protocol})'),
        'protocol_num': protocol,
        'checksum': hex(checksum),
        'source': src_ip,
        'destination': dst_ip
    }

# Example: Parse a sample IPv4 packet header
sample_header = bytes([
    0x45,                   # Version (4) + IHL (5)
    0x00,                   # DSCP + ECN
    0x00, 0x3c,             # Total length (60)
    0x1c, 0x46,             # Identification
    0x40, 0x00,             # Flags (DF) + Fragment offset
    0x40,                   # TTL (64)
    0x06,                   # Protocol (TCP)
    0xb1, 0xe6,             # Checksum
    0xc0, 0xa8, 0x01, 0x64, # Source: 192.168.1.100
    0x8e, 0xfa, 0xc4, 0xe4  # Dest: 142.250.196.228 (Google)
])

parsed = parse_ipv4_header(sample_header)
print("IPv4 Header Analysis")
print("=" * 50)
for key, value in parsed.items():
    if isinstance(value, dict):
        print(f"{key}:")
        for k, v in value.items():
            print(f"  {k}: {v}")
    else:
        print(f"{key}: {value}")
</code></pre>

                    <h3 id="ipv6-header">IPv6 Header</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">IPv6 Header</span>
                        </div>
                        <h4>IPv6 Header Format (Fixed 40 bytes)</h4>
<pre><code class="language-bash"> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Version| Traffic Class |           Flow Label                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Payload Length        |  Next Header  |   Hop Limit   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                         Source Address                        +
|                                                               |
+                          (128 bits)                           +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                      Destination Address                      +
|                                                               |
+                          (128 bits)                           +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Key Differences from IPv4:
- Fixed 40-byte header (simpler for routers)
- No checksum (handled by upper layers)
- No fragmentation fields (source handles it)
- Flow Label for QoS
- Extension headers for optional features
</code></pre>
                    </div>

                    <h3 id="fragmentation">IP Fragmentation</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">MTU & Fragmentation</span>
                        </div>
                        <h4>Maximum Transmission Unit</h4>
                        <p><strong>MTU</strong> is the largest packet size a network link can carry. When a packet exceeds the MTU, it must be fragmented:</p>
                        <ul>
                            <li><strong>Ethernet MTU:</strong> 1500 bytes (standard)</li>
                            <li><strong>Jumbo frames:</strong> 9000 bytes (data centers)</li>
                            <li><strong>Internet minimum:</strong> 576 bytes (IPv4), 1280 bytes (IPv6)</li>
                        </ul>
                        <p><strong>IPv4:</strong> Any router can fragment packets</p>
                        <p><strong>IPv6:</strong> Only the source can fragment (Path MTU Discovery)</p>
                    </div>

<pre><code class="language-bash"># Check MTU on your system

# Linux
ip link show | grep mtu
# or
cat /sys/class/net/eth0/mtu

# Windows
netsh interface ipv4 show subinterfaces

# macOS
networksetup -getMTU en0

# Test path MTU to a destination (Linux)
tracepath google.com

# Ping with specific size (don't fragment)
# Linux
ping -M do -s 1472 google.com   # 1472 + 28 (headers) = 1500

# Windows  
ping -f -l 1472 google.com

# macOS
ping -D -s 1472 google.com
</code></pre>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>Fragmentation Problems:</strong> Fragmentation hurts performance and can cause issues:
                        <ul class="mb-0 mt-2">
                            <li>All fragments must arrive for reassembly</li>
                            <li>Loss of one fragment loses entire packet</li>
                            <li>Some firewalls block fragments (security risk)</li>
                            <li>TCP uses <strong>Path MTU Discovery</strong> to avoid fragmentation</li>
                        </ul>
                    </div>
                </div>

                <!-- ICMP Section -->
                <div id="icmp" class="blog-content mt-5">
                    <h2><i class="fas fa-heartbeat me-2 text-teal"></i>ICMP: Internet Control Message Protocol</h2>
                    
                    <p><strong>ICMP</strong> provides error reporting and diagnostic functions for IP. It's the protocol behind <code>ping</code> and <code>traceroute</code>.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">ICMP Messages</span>
                        </div>
                        <h4>Common ICMP Message Types</h4>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Name</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>0</td>
                                    <td>Echo Reply</td>
                                    <td>Response to ping (Type 8)</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>Destination Unreachable</td>
                                    <td>Packet couldn't be delivered</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>Source Quench</td>
                                    <td>Congestion control (deprecated)</td>
                                </tr>
                                <tr>
                                    <td>5</td>
                                    <td>Redirect</td>
                                    <td>Better route available</td>
                                </tr>
                                <tr>
                                    <td>8</td>
                                    <td>Echo Request</td>
                                    <td>Ping request</td>
                                </tr>
                                <tr>
                                    <td>11</td>
                                    <td>Time Exceeded</td>
                                    <td>TTL expired (used by traceroute)</td>
                                </tr>
                                <tr>
                                    <td>12</td>
                                    <td>Parameter Problem</td>
                                    <td>Bad IP header</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 id="ping">Ping and Traceroute</h3>

<pre><code class="language-bash"># Ping - Test connectivity using ICMP Echo Request/Reply

# Basic ping
ping google.com

# Ping with count
ping -c 4 google.com           # Linux/macOS
ping -n 4 google.com           # Windows

# Ping with specific TTL
ping -t 10 google.com          # Linux
ping -i 10 google.com          # macOS

# Continuous ping with timestamp
ping -D google.com             # Linux (show timestamp)


# Traceroute - Discover the path packets take

# Linux
traceroute google.com

# Windows
tracert google.com

# Using ICMP instead of UDP (Linux)
sudo traceroute -I google.com

# Show AS numbers
traceroute -A google.com

# MTR - Combined ping + traceroute (live updating)
mtr google.com
</code></pre>

<pre><code class="language-python"># Implement ping in Python (requires root/admin)
import socket
import struct
import time
import select

def calculate_checksum(data):
    """Calculate ICMP checksum"""
    if len(data) % 2:
        data += b'\x00'
    
    checksum = 0
    for i in range(0, len(data), 2):
        word = (data[i] << 8) + data[i + 1]
        checksum += word
    
    checksum = (checksum >> 16) + (checksum & 0xFFFF)
    checksum = ~checksum & 0xFFFF
    return checksum

def create_icmp_packet(icmp_id, sequence):
    """Create an ICMP Echo Request packet"""
    # Type 8 = Echo Request, Code 0
    icmp_type = 8
    icmp_code = 0
    checksum = 0
    
    # Header without checksum
    header = struct.pack('!BBHHH', icmp_type, icmp_code, checksum, icmp_id, sequence)
    
    # Data payload (timestamp)
    data = struct.pack('!d', time.time())
    
    # Calculate checksum
    checksum = calculate_checksum(header + data)
    
    # Rebuild header with checksum
    header = struct.pack('!BBHHH', icmp_type, icmp_code, checksum, icmp_id, sequence)
    
    return header + data

def ping(host, timeout=2):
    """
    Send ICMP Echo Request and measure RTT
    Note: Requires root/administrator privileges
    """
    try:
        # Resolve hostname
        dest_ip = socket.gethostbyname(host)
        
        # Create raw socket for ICMP
        icmp_socket = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_ICMP)
        icmp_socket.settimeout(timeout)
        
        # Create and send packet
        icmp_id = 1
        sequence = 1
        packet = create_icmp_packet(icmp_id, sequence)
        
        send_time = time.time()
        icmp_socket.sendto(packet, (dest_ip, 0))
        
        # Wait for reply
        ready = select.select([icmp_socket], [], [], timeout)
        
        if ready[0]:
            recv_packet, addr = icmp_socket.recvfrom(1024)
            recv_time = time.time()
            
            # Parse reply (skip IP header - 20 bytes)
            icmp_header = recv_packet[20:28]
            icmp_type, code, checksum, p_id, seq = struct.unpack('!BBHHH', icmp_header)
            
            if icmp_type == 0:  # Echo Reply
                rtt = (recv_time - send_time) * 1000
                return {
                    'success': True,
                    'host': host,
                    'ip': dest_ip,
                    'rtt_ms': round(rtt, 2),
                    'ttl': recv_packet[8]  # TTL from IP header
                }
        
        return {'success': False, 'host': host, 'error': 'Timeout'}
        
    except PermissionError:
        return {'success': False, 'error': 'Root/Admin privileges required'}
    except socket.gaierror:
        return {'success': False, 'error': f'Cannot resolve {host}'}
    except Exception as e:
        return {'success': False, 'error': str(e)}

# Example (run with sudo/admin)
print("Note: Running ping requires root/administrator privileges")
print("Example usage: sudo python script.py")
print()
print("Expected output format:")
print({
    'success': True,
    'host': 'google.com', 
    'ip': '142.250.185.46',
    'rtt_ms': 15.23,
    'ttl': 117
})
</code></pre>

                    <div class="highlight-box">
                        <i class="fas fa-info-circle"></i>
                        <strong>Traceroute Mechanism:</strong> Traceroute works by sending packets with increasing TTL values (1, 2, 3...). Each router decrements TTL and sends back ICMP "Time Exceeded" when TTL reaches 0, revealing its IP address. This maps the entire path to the destination.
                    </div>
                </div>

                <!-- Routing Section -->
                <div id="routing" class="blog-content mt-5">
                    <h2><i class="fas fa-route me-2 text-teal"></i>Routing Fundamentals</h2>
                    
                    <p><strong>Routing</strong> is the process of selecting paths for traffic in a network. Routers use routing tables to decide where to forward packets.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">Routing Basics</span>
                        </div>
                        <h4>How Routing Works</h4>
                        <ol>
                            <li>Router receives a packet</li>
                            <li>Examines destination IP address</li>
                            <li>Looks up longest matching prefix in routing table</li>
                            <li>Forwards packet to next hop or directly to destination</li>
                            <li>Decrements TTL (drops if TTL = 0)</li>
                        </ol>
                    </div>

<pre><code class="language-bash"># View routing table on different systems

# Linux
ip route show
# or
route -n
# or
netstat -rn

# Windows
route print
# or
netstat -rn

# macOS
netstat -rn

# Example Linux output:
# default via 192.168.1.1 dev eth0 proto dhcp metric 100
# 192.168.1.0/24 dev eth0 proto kernel scope link src 192.168.1.100

# Explanation:
# default         - Default route (0.0.0.0/0)
# via 192.168.1.1 - Next hop (gateway)
# dev eth0        - Outgoing interface
# metric 100      - Route preference (lower = preferred)
</code></pre>

<pre><code class="language-python"># Simulate a simple routing table lookup
class Router:
    """Simple router simulation with longest prefix matching"""
    
    def __init__(self, name):
        self.name = name
        self.routes = []  # List of (network, next_hop, interface)
    
    def add_route(self, network, next_hop, interface):
        """Add a route to the routing table"""
        import ipaddress
        net = ipaddress.IPv4Network(network)
        self.routes.append({
            'network': net,
            'prefix': network,
            'next_hop': next_hop,
            'interface': interface
        })
        # Sort by prefix length (longest first) for proper matching
        self.routes.sort(key=lambda r: r['network'].prefixlen, reverse=True)
    
    def lookup(self, destination):
        """Find the best route for a destination (longest prefix match)"""
        import ipaddress
        dest_ip = ipaddress.IPv4Address(destination)
        
        for route in self.routes:
            if dest_ip in route['network']:
                return {
                    'destination': destination,
                    'matched_route': route['prefix'],
                    'next_hop': route['next_hop'],
                    'interface': route['interface']
                }
        
        return {'destination': destination, 'result': 'No route found'}
    
    def show_routes(self):
        """Display routing table"""
        print(f"\nRouting Table for {self.name}")
        print("=" * 60)
        print(f"{'Network':<20} {'Next Hop':<16} {'Interface':<12}")
        print("-" * 60)
        for route in self.routes:
            print(f"{route['prefix']:<20} {route['next_hop']:<16} {route['interface']:<12}")

# Create a router with typical routes
router = Router("R1")

# Add routes (specific to general)
router.add_route("192.168.1.0/24", "directly_connected", "eth0")
router.add_route("192.168.2.0/24", "192.168.1.254", "eth0")
router.add_route("10.0.0.0/8", "192.168.1.253", "eth0")
router.add_route("0.0.0.0/0", "192.168.1.1", "eth0")  # Default route

router.show_routes()

# Test lookups
print("\nRoute Lookups:")
print("-" * 60)
test_destinations = [
    "192.168.1.50",   # Local network
    "192.168.2.100",  # Adjacent network
    "10.50.100.200",  # Remote private network
    "8.8.8.8",        # Internet (Google DNS)
]

for dest in test_destinations:
    result = router.lookup(dest)
    print(f"\n{dest}:")
    for key, value in result.items():
        print(f"  {key}: {value}")
</code></pre>

                    <h3 id="routing-protocols">Routing Protocols</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">Protocol Types</span>
                        </div>
                        <h4>Interior vs Exterior Gateway Protocols</h4>
                        <p><strong>IGP (Interior Gateway Protocol):</strong> Used within an organization (Autonomous System)</p>
                        <ul>
                            <li><strong>RIP (Routing Information Protocol):</strong> Simple, distance-vector, max 15 hops. Legacy.</li>
                            <li><strong>OSPF (Open Shortest Path First):</strong> Link-state, uses Dijkstra's algorithm. Most common IGP.</li>
                            <li><strong>EIGRP (Enhanced Interior Gateway Routing Protocol):</strong> Cisco proprietary, advanced distance-vector.</li>
                            <li><strong>IS-IS (Intermediate System to Intermediate System):</strong> Link-state, popular with ISPs.</li>
                        </ul>
                        <p><strong>EGP (Exterior Gateway Protocol):</strong> Used between organizations</p>
                        <ul>
                            <li><strong>BGP (Border Gateway Protocol):</strong> The protocol that routes the entire internet!</li>
                        </ul>
                    </div>

                    <h3 id="bgp">BGP: The Internet's Routing Protocol</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">BGP</span>
                        </div>
                        <h4>Border Gateway Protocol</h4>
                        <p>BGP is a <strong>path-vector protocol</strong> that exchanges routing information between <strong>Autonomous Systems (AS)</strong>—networks under single administrative control.</p>
                        <ul>
                            <li><strong>AS Numbers:</strong> Unique identifiers (e.g., Google is AS15169)</li>
                            <li><strong>BGP Peers:</strong> Routers exchange routes via TCP port 179</li>
                            <li><strong>Path Selection:</strong> Based on policies, AS path length, and other attributes</li>
                            <li><strong>Full Internet Table:</strong> ~900,000+ routes (2024)</li>
                        </ul>
                    </div>

<pre><code class="language-bash"># Explore BGP and AS information

# Look up ASN for an IP
whois -h whois.radb.net 8.8.8.8

# View BGP looking glass (web tools)
# https://bgp.he.net/
# https://www.ripe.net/analyse/internet-measurements/routing-information-service-ris

# Check your own public IP's ASN
curl ipinfo.io

# Traceroute with AS numbers
traceroute -A google.com

# Example output shows AS path:
# 1  192.168.1.1 [AS0]      0.5ms
# 2  10.0.0.1 [AS12345]     5.2ms
# 3  72.14.238.1 [AS15169]  10.1ms  # Google's AS
</code></pre>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-shield-alt"></i>
                        <strong>BGP Security:</strong> BGP was designed without security! Notable incidents:
                        <ul class="mb-0 mt-2">
                            <li><strong>BGP Hijacking:</strong> Malicious AS announces routes it doesn't own</li>
                            <li><strong>Route Leaks:</strong> Accidental propagation of internal routes</li>
                            <li><strong>Solutions:</strong> RPKI (Resource Public Key Infrastructure), BGPsec</li>
                        </ul>
                    </div>
                </div>

                <!-- NAT Section -->
                <div id="nat" class="blog-content mt-5">
                    <h2><i class="fas fa-exchange-alt me-2 text-teal"></i>NAT: Network Address Translation</h2>
                    
                    <p><strong>NAT</strong> allows multiple devices to share a single public IP address. It's what lets your entire home network access the internet through one IP from your ISP.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">How NAT Works</span>
                        </div>
                        <h4>NAT Translation Process</h4>
<pre><code class="language-bash">Outbound (Private → Public):
1. Device 192.168.1.100 sends packet to 8.8.8.8
2. Router receives packet
3. Router changes source IP: 192.168.1.100 → 203.0.113.50 (public IP)
4. Router records mapping in NAT table
5. Packet sent to internet with public source IP

Inbound (Public → Private):
1. Response arrives for 203.0.113.50
2. Router looks up NAT table
3. Router changes dest IP: 203.0.113.50 → 192.168.1.100
4. Packet forwarded to internal device

NAT Table Example:
┌─────────────────────┬──────────────────────┬───────────────┐
│ Internal            │ External             │ Destination   │
│ 192.168.1.100:54321 │ 203.0.113.50:12345   │ 8.8.8.8:53   │
│ 192.168.1.101:54322 │ 203.0.113.50:12346   │ 8.8.8.8:53   │
└─────────────────────┴──────────────────────┴───────────────┘
</code></pre>
                    </div>

                    <h3 id="nat-types">Types of NAT</h3>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">NAT Variants</span>
                        </div>
                        <h4>NAT Types Explained</h4>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Description</th>
                                    <th>Use Case</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Static NAT</strong></td>
                                    <td>1:1 mapping of private to public IP</td>
                                    <td>Servers that need consistent public IP</td>
                                </tr>
                                <tr>
                                    <td><strong>Dynamic NAT</strong></td>
                                    <td>Pool of public IPs assigned dynamically</td>
                                    <td>Organizations with multiple public IPs</td>
                                </tr>
                                <tr>
                                    <td><strong>PAT/NAPT (Overload)</strong></td>
                                    <td>Many private IPs share one public IP using ports</td>
                                    <td>Home routers, most common type</td>
                                </tr>
                                <tr>
                                    <td><strong>Port Forwarding</strong></td>
                                    <td>External port → internal IP:port</td>
                                    <td>Hosting servers behind NAT</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

<pre><code class="language-bash"># NAT configuration examples (Linux iptables)

# Enable IP forwarding
echo 1 > /proc/sys/net/ipv4/ip_forward

# Basic SNAT (Source NAT) - Masquerade
# All traffic from 192.168.1.0/24 gets NAT'd to eth0's IP
iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j MASQUERADE

# SNAT with specific public IP
iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j SNAT --to-source 203.0.113.50

# DNAT (Destination NAT) - Port forwarding
# Forward port 8080 on public IP to internal web server
iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 8080 -j DNAT --to-destination 192.168.1.100:80

# View NAT rules
iptables -t nat -L -n -v

# View active NAT connections
conntrack -L
</code></pre>

                    <div class="highlight-box">
                        <i class="fas fa-info-circle"></i>
                        <strong>NAT Drawbacks:</strong>
                        <ul class="mb-0 mt-2">
                            <li><strong>Breaks end-to-end connectivity:</strong> Devices behind NAT can't be reached directly</li>
                            <li><strong>Complicates protocols:</strong> FTP, SIP, gaming require special NAT traversal</li>
                            <li><strong>Adds latency:</strong> Translation takes time</li>
                            <li><strong>IPv6 eliminates need:</strong> Enough addresses for every device to have public IP</li>
                        </ul>
                    </div>
                </div>

                <!-- Hands-On Section -->
                <div id="hands-on" class="blog-content mt-5">
                    <h2><i class="fas fa-laptop-code me-2 text-teal"></i>Hands-On Exercises</h2>

                    <h3>Exercise 1: Network Exploration Tools</h3>

<pre><code class="language-bash"># Complete IP investigation toolkit

# 1. Find your IP configuration
# Linux
ip addr show
ip route show

# Windows
ipconfig /all

# macOS
ifconfig
netstat -rn

# 2. Test connectivity
ping -c 4 google.com
ping -c 4 8.8.8.8

# 3. Trace the path
traceroute google.com

# 4. DNS lookup
nslookup google.com
dig google.com

# 5. Check what's listening
netstat -tlnp    # Linux
netstat -an      # Windows

# 6. Check your public IP
curl ifconfig.me
curl ipinfo.io/json
</code></pre>

                    <h3 id="python-ip">Exercise 2: Python IP Tools</h3>

<pre><code class="language-python"># Comprehensive IP utility library
import ipaddress
import socket

class IPTools:
    """Collection of IP utility functions"""
    
    @staticmethod
    def get_network_info(ip_cidr):
        """Get comprehensive network information"""
        network = ipaddress.IPv4Network(ip_cidr, strict=False)
        
        return {
            'network': str(network.network_address),
            'broadcast': str(network.broadcast_address),
            'netmask': str(network.netmask),
            'wildcard': str(network.hostmask),
            'prefix_length': network.prefixlen,
            'total_hosts': network.num_addresses,
            'usable_hosts': max(0, network.num_addresses - 2),
            'first_usable': str(list(network.hosts())[0]) if list(network.hosts()) else None,
            'last_usable': str(list(network.hosts())[-1]) if list(network.hosts()) else None,
            'is_private': network.is_private
        }
    
    @staticmethod
    def ip_in_range(ip, network):
        """Check if IP is in a network range"""
        addr = ipaddress.IPv4Address(ip)
        net = ipaddress.IPv4Network(network, strict=False)
        return addr in net
    
    @staticmethod
    def get_ip_class(ip):
        """Determine classful address class (historical)"""
        first_octet = int(ip.split('.')[0])
        
        if first_octet < 128:
            return 'A'
        elif first_octet < 192:
            return 'B'
        elif first_octet < 224:
            return 'C'
        elif first_octet < 240:
            return 'D (Multicast)'
        else:
            return 'E (Reserved)'
    
    @staticmethod
    def resolve_hostname(hostname):
        """Resolve hostname to IP address"""
        try:
            ip = socket.gethostbyname(hostname)
            return {'hostname': hostname, 'ip': ip, 'success': True}
        except socket.gaierror as e:
            return {'hostname': hostname, 'error': str(e), 'success': False}
    
    @staticmethod
    def reverse_lookup(ip):
        """Reverse DNS lookup"""
        try:
            hostname = socket.gethostbyaddr(ip)[0]
            return {'ip': ip, 'hostname': hostname, 'success': True}
        except socket.herror as e:
            return {'ip': ip, 'error': str(e), 'success': False}
    
    @staticmethod
    def summarize_networks(networks):
        """Summarize multiple networks into supernets"""
        nets = [ipaddress.IPv4Network(n) for n in networks]
        return list(ipaddress.collapse_addresses(nets))

# Examples
tools = IPTools()

# Network analysis
print("Network Analysis: 192.168.1.0/24")
print("=" * 50)
info = tools.get_network_info("192.168.1.0/24")
for key, value in info.items():
    print(f"  {key}: {value}")

# IP range check
print("\n\nIP Range Checks:")
print("=" * 50)
test_ips = ["192.168.1.50", "192.168.2.50", "10.0.0.1"]
for ip in test_ips:
    in_range = tools.ip_in_range(ip, "192.168.1.0/24")
    print(f"  {ip} in 192.168.1.0/24: {in_range}")

# Hostname resolution
print("\n\nHostname Resolution:")
print("=" * 50)
hosts = ["google.com", "github.com", "invalid.hostname.test"]
for host in hosts:
    result = tools.resolve_hostname(host)
    if result['success']:
        print(f"  {host} → {result['ip']}")
    else:
        print(f"  {host} → Error: {result['error']}")

# Network summarization (route aggregation)
print("\n\nNetwork Summarization:")
print("=" * 50)
networks_to_summarize = [
    "192.168.0.0/24",
    "192.168.1.0/24", 
    "192.168.2.0/24",
    "192.168.3.0/24"
]
print(f"  Original: {networks_to_summarize}")
summarized = tools.summarize_networks(networks_to_summarize)
print(f"  Summarized: {[str(n) for n in summarized]}")
</code></pre>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-crimson text-white">Self-Assessment</span>
                        </div>
                        <h4>Quiz: Test Your Knowledge</h4>
                        <ol>
                            <li>How many bits in an IPv4 address? <em>(Answer: 32 bits)</em></li>
                            <li>What's the subnet mask for /27? <em>(Answer: 255.255.255.224)</em></li>
                            <li>How many usable hosts in a /28 network? <em>(Answer: 14)</em></li>
                            <li>What private range is 172.16.0.0 in? <em>(Answer: 172.16.0.0/12)</em></li>
                            <li>What ICMP type is Echo Reply? <em>(Answer: Type 0)</em></li>
                            <li>What protocol runs the internet's routing? <em>(Answer: BGP)</em></li>
                            <li>What's the IPv6 loopback address? <em>(Answer: ::1)</em></li>
                            <li>What does NAT stand for? <em>(Answer: Network Address Translation)</em></li>
                        </ol>
                    </div>
                </div>

                <!-- Summary Section -->
                <div id="summary" class="blog-content mt-5">
                    <h2><i class="fas fa-check-circle me-2 text-teal"></i>Summary & Next Steps</h2>
                    
                    <div class="highlight-box">
                        <i class="fas fa-graduation-cap"></i>
                        <strong>Key Takeaways:</strong>
                        <ul class="mt-2 mb-0">
                            <li><strong>IPv4</strong> uses 32-bit addresses; <strong>IPv6</strong> uses 128-bit addresses</li>
                            <li><strong>CIDR notation</strong> (/24, /16) specifies network size flexibly</li>
                            <li><strong>Subnetting</strong> divides networks; calculate hosts with 2<sup>(32-prefix)</sup>-2</li>
                            <li><strong>ICMP</strong> provides diagnostics (ping, traceroute)</li>
                            <li><strong>Routers</strong> use longest prefix match to forward packets</li>
                            <li><strong>BGP</strong> routes between autonomous systems (the internet)</li>
                            <li><strong>NAT</strong> allows private IPs to share public IPs</li>
                        </ul>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2">
                            <span class="badge bg-teal text-white">Quick Reference</span>
                        </div>
                        <h4>IP Addressing Cheat Sheet</h4>
                        <ul>
                            <li><strong>Private Ranges:</strong> 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16</li>
                            <li><strong>/24:</strong> 256 IPs, 254 hosts (most common subnet)</li>
                            <li><strong>/30:</strong> 4 IPs, 2 hosts (point-to-point links)</li>
                            <li><strong>IPv6 Prefix:</strong> /64 is standard for subnets</li>
                            <li><strong>TTL:</strong> Default 64 or 128, prevents loops</li>
                        </ul>
                    </div>

                    <div class="series-next">
                        <h4><i class="fas fa-arrow-right me-2"></i>Next in the Series</h4>
                        <p>In <a href="protocols-master-transport-layer.html"><strong>Part 4: Transport Layer</strong></a>, we'll explore TCP, UDP, and QUIC. You'll learn about the three-way handshake, flow control, congestion control, ports, sockets, and how reliable (and unreliable) data delivery works end-to-end.</p>
                    </div>
                </div>

                <!-- Related Articles Section -->
                <div id="related" class="blog-content mt-5">
                    <h2><i class="fas fa-book-reader me-2 text-teal"></i>Continue the Series</h2>

                    <!-- Related Posts -->
                    <div class="related-posts">
                        <h3><i class="fas fa-arrow-right me-2"></i>Navigation</h3>
                        <div class="related-post-item">
                            <h5>Part 2: Physical & Data Link Layers</h5>
                            <p>Review Ethernet, Wi-Fi, MAC addressing, and switches.</p>
                            <a href="protocols-master-physical-datalink.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                        <div class="related-post-item">
                            <h5>Part 4: Transport Layer</h5>
                            <p>Deep dive into TCP, UDP, QUIC, ports, and reliable delivery.</p>
                            <a href="protocols-master-transport-layer.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                        <div class="related-post-item">
                            <h5>Part 5: Session & Presentation Layers</h5>
                            <p>Explore TLS handshakes, encryption, and data serialization.</p>
                            <a href="protocols-master-session-presentation.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                    </div>
                </div>

                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="social-media" class="bg-dark text-light py-5">
        <div class="container py-5">
            <div class="row mb-4">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h5 class="fw-bold mb-3">Let's Connect</h5>
                    <p class="text-light">
                        I'm always interested in sharing content about my interests on different topics. Read disclaimer and feel free to share further.
                    </p>
                </div>
                <div class="col-lg-6">
                    <h5 class="fw-bold mb-3">Follow Me</h5>
                    <div class="social-links d-flex gap-2 flex-wrap">
                        <a href="https://www.facebook.com/wasil.zafar/" target="_blank" class="social-icon" title="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://twitter.com/wasilzafar" target="_blank" class="social-icon" title="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.linkedin.com/in/wasilzafar" target="_blank" class="social-icon" title="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://www.youtube.com/@wasilzafar" target="_blank" class="social-icon" title="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://www.instagram.com/itswzee/" target="_blank" class="social-icon" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://in.pinterest.com/wasilz/" target="_blank" class="social-icon" title="Pinterest">
                            <i class="fab fa-pinterest-p"></i>
                        </a>
                        <a href="mailto:wasil.zafar@gmail.com" class="social-icon" title="Email">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>

            <hr class="bg-secondary">

            <div class="row mt-4">
                <div class="col-md-6">
                    <p class="small">
                        <i class="fas fa-icons me-2"></i>Icons from <a href="https://www.flaticon.com/" target="_blank" class="text-light">Flaticon</a> &amp; <a href="https://fontawesome.com/" target="_blank" class="text-light">Font Awesome</a>
                    </p>
                    <p class="small mt-3">
                        <a href="/" class="text-light text-decoration-none">Home</a> | 
                        <a href="/disclaimer.html" class="text-light text-decoration-none">Disclaimer</a> | 
                        <a href="/privacy-policy.html" class="text-light text-decoration-none">Privacy Policy</a>
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small">
                        Enjoying this content? ☕ <a href="https://buymeacoffee.com/itswzee" target="_blank" class="text-light" style="text-decoration: underline;">Keep me caffeinated</a> to keep the pixels flowing!
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Scroll-to-Top Button -->
    <button id="scrollToTop" class="scroll-to-top" title="Back to Top">
        <i class="fas fa-arrow-up"></i>
    </button>
    <!-- Category Indicator -->
    <div id="categoryIndicator" class="category-indicator"></div>
    
    <!-- Cookie Consent JS -->
    <script src="../../../js/cookie-consent.js"></script>
    
    <!-- Main JS -->
    <script src="../../../js/main.js"></script>

    <!-- Prism.js Syntax Highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
</body>
</html>
