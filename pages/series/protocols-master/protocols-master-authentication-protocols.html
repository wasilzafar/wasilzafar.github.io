<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="robots" content="index, archive" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Master authentication protocols: OAuth 2.0, OpenID Connect, SAML, Kerberos, LDAP. Learn secure identity verification for modern applications." />
    <meta name="author" content="Wasil Zafar" />
    <meta name="keywords" content="OAuth 2.0, OpenID Connect, OIDC, SAML, Kerberos, LDAP, Authentication, Authorization, SSO, Identity" />
    <meta property="og:title" content="Complete Protocols Master Part 15: Authentication Protocols" />
    <meta property="og:description" content="Comprehensive guide to authentication: OAuth 2.0 flows, OIDC, SAML for enterprise SSO, Kerberos for Active Directory." />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2026-01-31" />
    <meta property="article:author" content="Wasil Zafar" />
    <meta property="article:section" content="Technology" />
    
    <title>Complete Protocols Master Part 15: Authentication Protocols - Wasil Zafar</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" id="prism-theme" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" />
    <link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon_io/favicon-32x32.png">

    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('consent', 'default', {'ad_storage': 'denied', 'analytics_storage': 'denied', 'region': ['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE']});
        gtag('consent', 'default', {'ad_storage': 'granted', 'analytics_storage': 'granted'});
    </script>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s);j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PBS8M2JR');</script>
</head>
<body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBS8M2JR" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/"><span class="gradient-text">Wasil Zafar</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#skills">Skills</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#certifications">Certifications</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#interests">Interests</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="blog-hero">
        <div class="container py-5">
            <div class="blog-header">
                <a href="/pages/categories/technology.html" class="back-link"><i class="fas fa-arrow-left me-2"></i>Back to Technology</a>
                <h1 class="display-4 fw-bold mb-3">Complete Protocols Master Part 15: Authentication Protocols</h1>
                <div class="blog-meta">
                    <span><i class="fas fa-calendar me-2"></i>January 31, 2026</span>
                    <span><i class="fas fa-user me-2"></i>Wasil Zafar</span>
                    <span class="reading-time"><i class="fas fa-clock me-1"></i>42 min read</span>
                    <button onclick="window.print()" class="print-btn"><i class="fas fa-print"></i> Print</button>
                </div>
                <p class="lead">Master identity protocols: OAuth 2.0 for authorization, OpenID Connect for identity, SAML for enterprise, and Kerberos for domain authentication.</p>
            </div>
        </div>
    </section>

    <button class="toc-toggle-btn" onclick="openNav()"><i class="fas fa-list"></i></button>
    <div id="tocSidenav" class="sidenav-toc">
        <div class="toc-header">
            <h3><i class="fas fa-list me-2"></i>Table of Contents</h3>
            <button class="closebtn" onclick="closeNav()">&times;</button>
        </div>
        <ol>
            <li><a href="#introduction" onclick="closeNav()">Introduction</a></li>
            <li><a href="#oauth2" onclick="closeNav()">OAuth 2.0</a></li>
            <li><a href="#oidc" onclick="closeNav()">OpenID Connect</a></li>
            <li><a href="#saml" onclick="closeNav()">SAML 2.0</a></li>
            <li><a href="#kerberos" onclick="closeNav()">Kerberos</a></li>
            <li><a href="#ldap" onclick="closeNav()">LDAP</a></li>
            <li><a href="#comparison" onclick="closeNav()">Comparison</a></li>
            <li><a href="#summary" onclick="closeNav()">Summary</a></li>
        </ol>
    </div>
    <div id="tocOverlay" class="sidenav-overlay" onclick="closeNav()"></div>

    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">

                <div id="introduction" class="blog-content">
                    <h2><i class="fas fa-user-shield me-2 text-teal"></i>Introduction: Authentication vs Authorization</h2>
                    
                    <p>Authentication and authorization are distinct but related concepts. <strong>Authentication</strong> verifies WHO you are. <strong>Authorization</strong> determines WHAT you can do.</p>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-sitemap me-2"></i>
                        <strong>Series Context:</strong> This is <strong>Part 15 of 20</strong> in the Complete Protocols Master series. Authentication protocols operate at the Application Layer (Layer 7).
                    </div>

                    <div class="experiment-card" id="series-nav">
                        <h4><i class="fas fa-map-signs me-2"></i>Complete Series Navigation</h4>
                        <div class="meta mb-2">
                            <span class="badge bg-teal me-2">20-Part Series</span>
                            <span class="badge bg-crimson">Protocol Mastery</span>
                        </div>
                        <div class="content">
                            <ol>
                                <li><a href="protocols-master-osi-foundations.html"><strong>Part 1:</strong> OSI Model & Protocol Foundations</a> — Network layers, encapsulation, TCP/IP model</li>
                                <li><a href="protocols-master-physical-datalink.html"><strong>Part 2:</strong> Physical & Data Link Layers</a> — Ethernet, Wi-Fi, VLANs, MAC addressing</li>
                                <li><a href="protocols-master-network-layer.html"><strong>Part 3:</strong> Network Layer & IP</a> — IPv4, IPv6, ICMP, routing protocols</li>
                                <li><a href="protocols-master-transport-layer.html"><strong>Part 4:</strong> Transport Layer</a> — TCP, UDP, QUIC, ports, sockets</li>
                                <li><a href="protocols-master-session-presentation.html"><strong>Part 5:</strong> Session & Presentation Layers</a> — TLS handshake, encryption, serialization</li>
                                <li><a href="protocols-master-web-protocols.html"><strong>Part 6:</strong> Web Protocols</a> — HTTP/1.1, HTTP/2, HTTP/3, WebSockets</li>
                                <li><a href="protocols-master-api-protocols.html"><strong>Part 7:</strong> API Protocols</a> — REST, GraphQL, gRPC, SOAP</li>
                                <li><a href="protocols-master-dns-deep-dive.html"><strong>Part 8:</strong> DNS Deep Dive</a> — DNS hierarchy, records, DNSSEC</li>
                                <li><a href="protocols-master-email-protocols.html"><strong>Part 9:</strong> Email Protocols</a> — SMTP, IMAP, POP3, SPF/DKIM/DMARC</li>
                                <li><a href="protocols-master-file-transfer.html"><strong>Part 10:</strong> File Transfer Protocols</a> — FTP, SFTP, SCP, rsync</li>
                                <li><a href="protocols-master-realtime-protocols.html"><strong>Part 11:</strong> Real-Time Protocols</a> — WebRTC, SIP, RTP, VoIP</li>
                                <li><a href="protocols-master-streaming-protocols.html"><strong>Part 12:</strong> Streaming Protocols</a> — HLS, DASH, RTMP, media delivery</li>
                                <li><a href="protocols-master-iot-protocols.html"><strong>Part 13:</strong> IoT Protocols</a> — MQTT, CoAP, Zigbee, LoRaWAN</li>
                                <li><a href="protocols-master-vpn-tunneling.html"><strong>Part 14:</strong> VPN & Tunneling</a> — IPsec, OpenVPN, WireGuard</li>
                                <li><strong>Part 15: Authentication Protocols (This Guide)</strong> — OAuth, SAML, OIDC, Kerberos</li>
                                <li><a href="protocols-master-network-management.html"><strong>Part 16:</strong> Network Management</a> — SNMP, NetFlow, Syslog</li>
                                <li><a href="protocols-master-security-protocols.html"><strong>Part 17:</strong> Security Protocols</a> — TLS/SSL, certificates, PKI</li>
                                <li><a href="protocols-master-cloud-protocols.html"><strong>Part 18:</strong> Cloud Provider Protocols</a> — AWS, Azure, GCP APIs</li>
                                <li><a href="protocols-master-emerging-protocols.html"><strong>Part 19:</strong> Emerging Protocols</a> — QUIC, HTTP/3, WebTransport</li>
                                <li><a href="protocols-master-web-security-standards.html"><strong>Part 20:</strong> Web Security Standards</a> — CORS, CSP, HSTS, SRI</li>
                            </ol>
                        </div>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Concepts</span></div>
                        <h4>Authentication vs Authorization</h4>
<pre><code class="language-bash">Authentication vs Authorization:

AUTHENTICATION (AuthN)
"Who are you?"
• Verifies identity
• Username/password
• Certificates
• Biometrics

AUTHORIZATION (AuthZ)
"What can you access?"
• Permissions
• Roles
• Access control
• Scopes

Example - Hotel:
• AuthN: Show ID at check-in (prove identity)
• AuthZ: Key card grants room access (not other rooms)

Protocol Mapping:
• OAuth 2.0: Authorization only
• OpenID Connect: Authentication (built on OAuth)
• SAML: Both (primarily AuthN)
• Kerberos: Both (tickets grant access)
• LDAP: Directory (stores identity data)
</code></pre>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">Overview</span></div>
                        <h4>Protocol Landscape</h4>
                        <table class="table table-bordered">
                            <thead><tr><th>Protocol</th><th>Type</th><th>Best For</th><th>Token Format</th></tr></thead>
                            <tbody>
                                <tr><td><strong>OAuth 2.0</strong></td><td>Authorization</td><td>API access, mobile</td><td>Opaque/JWT</td></tr>
                                <tr><td><strong>OIDC</strong></td><td>AuthN + AuthZ</td><td>Web login, SSO</td><td>JWT (ID Token)</td></tr>
                                <tr><td><strong>SAML 2.0</strong></td><td>AuthN + AuthZ</td><td>Enterprise SSO</td><td>XML Assertion</td></tr>
                                <tr><td><strong>Kerberos</strong></td><td>AuthN + AuthZ</td><td>Active Directory</td><td>Tickets</td></tr>
                                <tr><td><strong>LDAP</strong></td><td>Directory</td><td>User lookup</td><td>N/A</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="oauth2" class="blog-content mt-5">
                    <h2><i class="fas fa-key me-2 text-teal"></i>OAuth 2.0: Authorization Framework</h2>

                    <p><strong>OAuth 2.0</strong> is THE authorization standard for APIs. It lets users grant apps limited access without sharing credentials. "Log in with Google" uses OAuth.</p>

                    <div class="highlight-box">
                        <i class="fas fa-lightbulb"></i>
                        <strong>Key Insight:</strong> OAuth 2.0 is about AUTHORIZATION, not authentication. It answers "Can this app access my photos?" not "Who is this user?"
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Roles</span></div>
                        <h4>OAuth 2.0 Actors</h4>
<pre><code class="language-bash">OAuth 2.0 Roles:

1. RESOURCE OWNER
   The user who owns the data
   Example: You

2. CLIENT
   The application wanting access
   Example: Third-party photo app

3. AUTHORIZATION SERVER
   Issues tokens after user consent
   Example: Google's auth server

4. RESOURCE SERVER
   Hosts the protected data
   Example: Google Photos API

Flow:
User → "I want to use PhotoApp"
PhotoApp → "Please authorize at Google"
User → Google: "Yes, allow read-only photos"
Google → PhotoApp: "Here's an access token"
PhotoApp → Google Photos API: "Token: xyz, get photos"
API → PhotoApp: "Here are the photos"
</code></pre>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">Grant Types</span></div>
                        <h4>OAuth 2.0 Flows</h4>
<pre><code class="language-bash">OAuth 2.0 Grant Types:

1. AUTHORIZATION CODE (most secure)
   Best for: Server-side web apps
   Flow: Code exchanged for token server-side
   
2. AUTHORIZATION CODE + PKCE
   Best for: Mobile apps, SPAs
   Flow: Code + code_verifier for security
   PKCE = Proof Key for Code Exchange

3. CLIENT CREDENTIALS
   Best for: Machine-to-machine (no user)
   Flow: App authenticates directly

4. DEVICE CODE
   Best for: TVs, CLI tools (no browser)
   Flow: User authorizes on separate device

5. IMPLICIT (deprecated)
   Was for: SPAs (replaced by PKCE)
   Issue: Token in URL fragment
</code></pre>
                    </div>

<pre><code class="language-bash"># Authorization Code Flow with PKCE

# Step 1: Generate code verifier and challenge
code_verifier="random-43-to-128-character-string"
code_challenge=$(echo -n "$code_verifier" | sha256sum | cut -d' ' -f1 | xxd -r -p | base64 -w0 | tr '+/' '-_' | tr -d '=')

# Step 2: Redirect user to authorization
https://auth.example.com/authorize?
  client_id=my-app&
  response_type=code&
  redirect_uri=https://myapp.com/callback&
  scope=read:photos&
  state=random-csrf-token&
  code_challenge=$code_challenge&
  code_challenge_method=S256

# Step 3: User logs in and consents
# Redirected back with authorization code

# Step 4: Exchange code for tokens (server-side)
curl -X POST https://auth.example.com/token \
  -d "grant_type=authorization_code" \
  -d "code=AUTHORIZATION_CODE" \
  -d "redirect_uri=https://myapp.com/callback" \
  -d "client_id=my-app" \
  -d "code_verifier=$code_verifier"

# Response:
{
  "access_token": "eyJhbGciOiJSUzI1NiIs...",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "dGhpcyBpcyBhIHJlZnJlc2g..."
}
</code></pre>

<pre><code class="language-python"># OAuth 2.0 Client Credentials Flow (Python)

import requests
import base64

def client_credentials_flow():
    """Machine-to-machine authentication"""
    
    client_id = "my-service"
    client_secret = "super-secret"
    token_url = "https://auth.example.com/token"
    
    # Request access token
    response = requests.post(
        token_url,
        data={
            "grant_type": "client_credentials",
            "scope": "api:read api:write"
        },
        auth=(client_id, client_secret)
    )
    
    tokens = response.json()
    access_token = tokens["access_token"]
    
    print(f"Access Token: {access_token[:50]}...")
    print(f"Expires in: {tokens['expires_in']} seconds")
    
    # Use token to call API
    api_response = requests.get(
        "https://api.example.com/data",
        headers={"Authorization": f"Bearer {access_token}"}
    )
    
    return api_response.json()

# Token structure (JWT)
print("""
JWT Structure:
HEADER.PAYLOAD.SIGNATURE

Header: {"alg": "RS256", "typ": "JWT"}
Payload: {
  "iss": "https://auth.example.com",
  "sub": "user123",
  "aud": "api.example.com",
  "exp": 1735689600,
  "scope": "read:photos"
}
Signature: RSASHA256(header + payload, private_key)
""")
</code></pre>
                </div>

                <div id="oidc" class="blog-content mt-5">
                    <h2><i class="fas fa-id-card me-2 text-teal"></i>OpenID Connect: Identity Layer</h2>

                    <p><strong>OpenID Connect (OIDC)</strong> adds authentication to OAuth 2.0. It provides an ID Token that proves who the user is—not just what they can access.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">OIDC</span></div>
                        <h4>OIDC vs OAuth 2.0</h4>
<pre><code class="language-bash">OIDC = OAuth 2.0 + Identity

What OIDC Adds:
• ID Token (JWT proving identity)
• UserInfo endpoint
• Standard claims (name, email, picture)
• Discovery endpoint

Tokens in OIDC:
• Access Token: API authorization (same as OAuth)
• ID Token: User identity (NEW in OIDC)
• Refresh Token: Get new tokens (same as OAuth)

ID Token Claims:
{
  "iss": "https://accounts.google.com",
  "sub": "110169484474386276334",  // Unique user ID
  "aud": "my-client-id",
  "exp": 1735689600,
  "iat": 1735686000,
  "name": "Jane Doe",
  "email": "jane@example.com",
  "picture": "https://..."
}
</code></pre>
                    </div>

<pre><code class="language-bash"># OIDC Discovery Endpoint

curl https://accounts.google.com/.well-known/openid-configuration

# Returns:
{
  "issuer": "https://accounts.google.com",
  "authorization_endpoint": "https://accounts.google.com/o/oauth2/v2/auth",
  "token_endpoint": "https://oauth2.googleapis.com/token",
  "userinfo_endpoint": "https://openidconnect.googleapis.com/v1/userinfo",
  "jwks_uri": "https://www.googleapis.com/oauth2/v3/certs",
  "scopes_supported": ["openid", "email", "profile"],
  "response_types_supported": ["code", "token", "id_token"],
  "claims_supported": ["sub", "name", "email", "picture"]
}
</code></pre>

<pre><code class="language-python"># OIDC Authentication (Python with Authlib)

def oidc_example():
    """Demonstrate OIDC authentication"""
    
    print("OIDC Authentication Flow")
    print("=" * 50)
    
    print("""
    # Flask OIDC Example
    
    from authlib.integrations.flask_client import OAuth
    
    oauth = OAuth(app)
    oauth.register(
        name='google',
        client_id='your-client-id',
        client_secret='your-client-secret',
        server_metadata_url='https://accounts.google.com/.well-known/openid-configuration',
        client_kwargs={'scope': 'openid email profile'}
    )
    
    @app.route('/login')
    def login():
        redirect_uri = url_for('callback', _external=True)
        return oauth.google.authorize_redirect(redirect_uri)
    
    @app.route('/callback')
    def callback():
        token = oauth.google.authorize_access_token()
        
        # ID Token contains user identity
        id_token = token['id_token']
        userinfo = token['userinfo']
        
        # Now you know WHO the user is
        user_id = userinfo['sub']
        email = userinfo['email']
        name = userinfo['name']
        
        return f'Hello {name}!'
    """)
    
    print("\nKey OIDC Scopes:")
    print("• openid: Required, returns ID token")
    print("• profile: Name, picture, etc.")
    print("• email: Email address")
    print("• address: Physical address")
    print("• phone: Phone number")

oidc_example()
</code></pre>
                </div>

                <div id="saml" class="blog-content mt-5">
                    <h2><i class="fas fa-building me-2 text-teal"></i>SAML 2.0: Enterprise SSO</h2>

                    <p><strong>SAML</strong> (Security Assertion Markup Language) is the enterprise standard for Single Sign-On. XML-based, mature, used by most corporate identity providers.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">SAML</span></div>
                        <h4>SAML Components</h4>
<pre><code class="language-bash">SAML 2.0 Components:

1. IDENTITY PROVIDER (IdP)
   • Authenticates users
   • Issues SAML assertions
   • Examples: Okta, Azure AD, ADFS

2. SERVICE PROVIDER (SP)
   • Your application
   • Trusts the IdP
   • Consumes assertions

3. SAML ASSERTION
   • XML document proving identity
   • Contains attributes (email, groups)
   • Digitally signed by IdP

SAML Flows:
• SP-Initiated: User starts at app, redirected to IdP
• IdP-Initiated: User starts at IdP portal

SP-Initiated Flow:
User → SP: "Access app"
SP → User: "Redirect to IdP"
User → IdP: "Login page"
User → IdP: "Credentials"
IdP → User: "SAML Response (redirect to SP)"
User → SP: "Here's SAML Response"
SP → User: "Authenticated! Welcome"
</code></pre>
                    </div>

<pre><code class="language-bash"># SAML Response Structure (simplified)

&lt;samlp:Response&gt;
  &lt;Issuer&gt;https://idp.example.com&lt;/Issuer&gt;
  &lt;Status&gt;
    &lt;StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success"/&gt;
  &lt;/Status&gt;
  
  &lt;Assertion&gt;
    &lt;Issuer&gt;https://idp.example.com&lt;/Issuer&gt;
    
    &lt;Subject&gt;
      &lt;NameID&gt;user@example.com&lt;/NameID&gt;
    &lt;/Subject&gt;
    
    &lt;Conditions NotBefore="2026-01-31T00:00:00Z" 
                NotOnOrAfter="2026-01-31T00:05:00Z"&gt;
      &lt;AudienceRestriction&gt;
        &lt;Audience&gt;https://sp.example.com&lt;/Audience&gt;
      &lt;/AudienceRestriction&gt;
    &lt;/Conditions&gt;
    
    &lt;AttributeStatement&gt;
      &lt;Attribute Name="email"&gt;
        &lt;AttributeValue&gt;user@example.com&lt;/AttributeValue&gt;
      &lt;/Attribute&gt;
      &lt;Attribute Name="groups"&gt;
        &lt;AttributeValue&gt;admin&lt;/AttributeValue&gt;
        &lt;AttributeValue&gt;developers&lt;/AttributeValue&gt;
      &lt;/Attribute&gt;
    &lt;/AttributeStatement&gt;
    
    &lt;Signature&gt;...&lt;/Signature&gt;
  &lt;/Assertion&gt;
&lt;/samlp:Response&gt;
</code></pre>

<pre><code class="language-python"># SAML Service Provider (Python with python-saml)

def saml_sp_example():
    """Demonstrate SAML Service Provider"""
    
    print("SAML Service Provider Configuration")
    print("=" * 50)
    
    print("""
    # Flask SAML Example (using python3-saml)
    
    from onelogin.saml2.auth import OneLogin_Saml2_Auth
    
    @app.route('/saml/login')
    def saml_login():
        req = prepare_flask_request(request)
        auth = OneLogin_Saml2_Auth(req, custom_base_path=SAML_PATH)
        return redirect(auth.login())
    
    @app.route('/saml/acs', methods=['POST'])
    def saml_acs():
        # Assertion Consumer Service - receives SAML Response
        req = prepare_flask_request(request)
        auth = OneLogin_Saml2_Auth(req, custom_base_path=SAML_PATH)
        
        auth.process_response()
        errors = auth.get_errors()
        
        if not errors:
            # Authentication successful
            attributes = auth.get_attributes()
            name_id = auth.get_nameid()
            
            user_email = attributes.get('email', [None])[0]
            user_groups = attributes.get('groups', [])
            
            # Create session
            session['user'] = {
                'email': user_email,
                'groups': user_groups
            }
            
            return redirect('/dashboard')
        else:
            return f'SAML Error: {errors}', 400
    """)
    
    print("\nSAML Metadata Exchange:")
    print("• SP publishes metadata (entity ID, ACS URL, cert)")
    print("• IdP publishes metadata (SSO URL, signing cert)")
    print("• Both import each other's metadata")

saml_sp_example()
</code></pre>
                </div>

                <div id="kerberos" class="blog-content mt-5">
                    <h2><i class="fas fa-ticket-alt me-2 text-teal"></i>Kerberos: Network Authentication</h2>

                    <p><strong>Kerberos</strong> is the authentication backbone of Active Directory. Uses tickets instead of passwords—users authenticate once, get tickets for services.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Kerberos</span></div>
                        <h4>Kerberos Architecture</h4>
<pre><code class="language-bash">Kerberos Components:

1. KDC (Key Distribution Center)
   • Authentication Server (AS)
   • Ticket Granting Server (TGS)
   • Holds all secrets

2. TICKETS
   • TGT (Ticket Granting Ticket): Proves identity
   • Service Ticket: Grants access to specific service

3. PRINCIPALS
   • Users: user@REALM.COM
   • Services: HTTP/web.realm.com@REALM.COM

Kerberos Authentication:
User → AS: "I'm alice, want TGT"
AS → User: "Here's TGT (encrypted)"
User → TGS: "TGT, want ticket for fileserver"
TGS → User: "Here's service ticket"
User → FileServer: "Service ticket"
FileServer → User: "Access granted"

Key Concept: User password NEVER sent over network
</code></pre>
                    </div>

<pre><code class="language-bash"># Kerberos ticket management (Linux)

# Initialize (get TGT)
kinit alice@EXAMPLE.COM
# Enter password (locally hashed, not sent)

# List tickets
klist
# Ticket cache: FILE:/tmp/krb5cc_1000
# Default principal: alice@EXAMPLE.COM
# 
# Valid starting       Expires              Service principal
# 01/31/2026 09:00    01/31/2026 19:00     krbtgt/EXAMPLE.COM@EXAMPLE.COM

# Get service ticket (automatic when accessing service)
curl --negotiate -u : http://web.example.com/

# Destroy tickets (logout)
kdestroy

# Check keytab (for service accounts)
klist -k /etc/krb5.keytab
</code></pre>

<pre><code class="language-python"># Kerberos authentication in Python

def kerberos_example():
    """Kerberos authentication demonstration"""
    
    print("Kerberos in Python")
    print("=" * 50)
    
    print("""
    # Using requests-kerberos
    
    import requests
    from requests_kerberos import HTTPKerberosAuth
    
    # Auto-use cached TGT
    response = requests.get(
        'https://api.example.com/data',
        auth=HTTPKerberosAuth()
    )
    
    # For SPNEGO (HTTP Negotiate)
    from requests_kerberos import HTTPKerberosAuth, OPTIONAL
    
    response = requests.get(
        'https://api.example.com/data',
        auth=HTTPKerberosAuth(mutual_authentication=OPTIONAL)
    )
    """)
    
    print("\nKerberos vs Password Auth:")
    print("• Kerberos: Ticket-based, password never leaves client")
    print("• Password: Sent to server (even if encrypted)")
    print("• Kerberos: Mutual auth (server proves identity too)")
    print("• Kerberos: Time-limited tickets, auto-expire")

kerberos_example()
</code></pre>
                </div>

                <div id="ldap" class="blog-content mt-5">
                    <h2><i class="fas fa-database me-2 text-teal"></i>LDAP: Directory Services</h2>

                    <p><strong>LDAP</strong> (Lightweight Directory Access Protocol) stores and retrieves identity data. It's not strictly an authentication protocol—it's the database that backs authentication.</p>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">LDAP</span></div>
                        <h4>LDAP Structure</h4>
<pre><code class="language-bash">LDAP Concepts:

1. DIRECTORY TREE (DIT)
   Hierarchical structure
   dc=example,dc=com (domain)
    └── ou=People
         └── uid=alice
         └── uid=bob
    └── ou=Groups
         └── cn=developers

2. DISTINGUISHED NAME (DN)
   Unique identifier for entry
   uid=alice,ou=People,dc=example,dc=com

3. ATTRIBUTES
   cn: Common Name
   uid: User ID
   mail: Email
   userPassword: Hashed password
   memberOf: Group membership

4. OPERATIONS
   • Bind: Authenticate
   • Search: Query
   • Add/Modify/Delete: CRUD
</code></pre>
                    </div>

<pre><code class="language-bash"># LDAP queries with ldapsearch

# Anonymous search (if allowed)
ldapsearch -x -H ldap://ldap.example.com \
  -b "dc=example,dc=com" "(uid=alice)"

# Authenticated search
ldapsearch -x -H ldap://ldap.example.com \
  -D "cn=admin,dc=example,dc=com" -W \
  -b "ou=People,dc=example,dc=com" "(objectClass=person)"

# Search specific attributes
ldapsearch -x -H ldap://ldap.example.com \
  -b "dc=example,dc=com" "(uid=alice)" cn mail memberOf

# Test authentication (bind)
ldapwhoami -x -H ldap://ldap.example.com \
  -D "uid=alice,ou=People,dc=example,dc=com" -W
</code></pre>

<pre><code class="language-python"># LDAP authentication in Python

import ldap3

def ldap_auth(username, password):
    """Authenticate user against LDAP"""
    
    server = ldap3.Server('ldap://ldap.example.com', get_info=ldap3.ALL)
    user_dn = f"uid={username},ou=People,dc=example,dc=com"
    
    try:
        conn = ldap3.Connection(server, user_dn, password, auto_bind=True)
        print(f"✅ Authentication successful for {username}")
        
        # Search for user attributes
        conn.search(
            user_dn,
            '(objectClass=person)',
            attributes=['cn', 'mail', 'memberOf']
        )
        
        if conn.entries:
            user = conn.entries[0]
            print(f"   Name: {user.cn}")
            print(f"   Email: {user.mail}")
            print(f"   Groups: {user.memberOf}")
        
        conn.unbind()
        return True
        
    except ldap3.core.exceptions.LDAPBindError:
        print(f"❌ Authentication failed for {username}")
        return False

# Example
# ldap_auth('alice', 'password123')
</code></pre>
                </div>

                <div id="comparison" class="blog-content mt-5">
                    <h2><i class="fas fa-balance-scale me-2 text-teal"></i>Protocol Comparison</h2>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Decision Guide</span></div>
                        <h4>Choosing Authentication Protocol</h4>
                        <table class="table table-bordered">
                            <thead><tr><th>Scenario</th><th>Best Choice</th><th>Reason</th></tr></thead>
                            <tbody>
                                <tr><td>Modern web app</td><td>OIDC</td><td>Industry standard, JWT tokens</td></tr>
                                <tr><td>Mobile app</td><td>OAuth 2.0 + PKCE</td><td>Secure, no client secret</td></tr>
                                <tr><td>Enterprise SSO</td><td>SAML</td><td>Mature, wide support</td></tr>
                                <tr><td>Windows domain</td><td>Kerberos</td><td>Built into AD</td></tr>
                                <tr><td>API authorization</td><td>OAuth 2.0</td><td>Scoped access tokens</td></tr>
                                <tr><td>Machine-to-machine</td><td>OAuth 2.0 CC</td><td>No user involved</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-crimson text-white">OIDC vs SAML</span></div>
                        <h4>When to Use Which</h4>
<pre><code class="language-bash">OIDC vs SAML:

OIDC (Modern):
✅ JSON/JWT (lightweight)
✅ Mobile-friendly
✅ REST APIs
✅ Modern IdPs (Auth0, Okta)
✅ Easier to implement

SAML (Enterprise):
✅ Mature, battle-tested
✅ Wide enterprise support
✅ Complex attribute mapping
✅ Legacy system integration
❌ XML (verbose)
❌ Complex to implement

Choose OIDC for:
• New applications
• Mobile apps
• API-first architecture
• Consumer applications

Choose SAML for:
• Enterprise with existing SAML IdP
• Legacy system integration
• Complex attribute requirements
• Regulatory compliance
</code></pre>
                    </div>
                </div>

                <div id="summary" class="blog-content mt-5">
                    <h2><i class="fas fa-check-circle me-2 text-teal"></i>Summary & Next Steps</h2>

                    <div class="highlight-box">
                        <i class="fas fa-graduation-cap"></i>
                        <strong>Key Takeaways:</strong>
                        <ul class="mt-2 mb-0">
                            <li><strong>OAuth 2.0</strong>: Authorization framework for API access</li>
                            <li><strong>OIDC</strong>: Identity layer on OAuth, provides ID tokens</li>
                            <li><strong>SAML</strong>: Enterprise SSO with XML assertions</li>
                            <li><strong>Kerberos</strong>: Ticket-based auth for AD domains</li>
                            <li><strong>LDAP</strong>: Directory for storing identity data</li>
                        </ul>
                    </div>

                    <div class="experiment-card">
                        <div class="card-meta mb-2"><span class="badge bg-teal text-white">Quiz</span></div>
                        <h4>Test Your Knowledge</h4>
                        <ol>
                            <li>OAuth 2.0 vs OIDC? <em>(AuthZ vs AuthN)</em></li>
                            <li>What is PKCE? <em>(Proof Key for Code Exchange, mobile security)</em></li>
                            <li>SAML vs OIDC token format? <em>(XML vs JWT)</em></li>
                            <li>What's a TGT in Kerberos? <em>(Ticket Granting Ticket)</em></li>
                            <li>LDAP purpose? <em>(Directory storage, identity lookup)</em></li>
                        </ol>
                    </div>

                    <div class="series-next">
                        <h4><i class="fas fa-arrow-right me-2"></i>Next in the Series</h4>
                        <p>In <a href="protocols-master-network-management.html"><strong>Part 16: Network Management Protocols</strong></a>, we'll explore SNMP, NetFlow, and syslog for monitoring and managing networks.</p>
                    </div>
                </div>

                <div class="related-posts mt-5">
                    <h3><i class="fas fa-book me-2"></i>Related Articles</h3>
                    <div class="related-post-item">
                        <h5>Part 14: VPN & Tunneling</h5>
                        <p>IPsec, WireGuard, OpenVPN for secure tunnels.</p>
                        <a href="protocols-master-vpn-tunneling.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                    <div class="related-post-item">
                        <h5>Part 16: Network Management</h5>
                        <p>SNMP, NetFlow, syslog monitoring.</p>
                        <a href="protocols-master-network-management.html">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                    </div>
                </div>

                </div>
            </div>
        </div>
    </section>

    <footer id="social-media" class="bg-dark text-light py-5">
        <div class="container py-5">
            <div class="row mb-4">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h5 class="fw-bold mb-3">Let's Connect</h5>
                    <p class="text-light">
                        I'm always interested in sharing content about my interests on different topics. Read disclaimer and feel free to share further.
                    </p>
                </div>
                <div class="col-lg-6">
                    <h5 class="fw-bold mb-3">Follow Me</h5>
                    <div class="social-links d-flex gap-2 flex-wrap">
                        <a href="https://www.facebook.com/wasil.zafar/" target="_blank" class="social-icon" title="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://twitter.com/wasilzafar" target="_blank" class="social-icon" title="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.linkedin.com/in/wasilzafar" target="_blank" class="social-icon" title="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://www.youtube.com/@wasilzafar" target="_blank" class="social-icon" title="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://www.instagram.com/itswzee/" target="_blank" class="social-icon" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://in.pinterest.com/wasilz/" target="_blank" class="social-icon" title="Pinterest">
                            <i class="fab fa-pinterest-p"></i>
                        </a>
                        <a href="mailto:wasil.zafar@gmail.com" class="social-icon" title="Email">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>

            <hr class="bg-secondary">

            <div class="row mt-4">
                <div class="col-md-6">
                    <p class="small">
                        <i class="fas fa-icons me-2"></i>Icons from <a href="https://www.flaticon.com/" target="_blank" class="text-light">Flaticon</a> &amp; <a href="https://fontawesome.com/" target="_blank" class="text-light">Font Awesome</a>
                    </p>
                    <p class="small mt-3">
                        <a href="/" class="text-light text-decoration-none">Home</a> | 
                        <a href="/disclaimer.html" class="text-light text-decoration-none">Disclaimer</a> | 
                        <a href="/privacy-policy.html" class="text-light text-decoration-none">Privacy Policy</a>
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small">
                        Enjoying this content? ☕ <a href="https://buymeacoffee.com/itswzee" target="_blank" class="text-light" style="text-decoration: underline;">Keep me caffeinated</a> to keep the pixels flowing!
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <button id="scrollToTop" class="scroll-to-top"><i class="fas fa-arrow-up"></i></button>
    <div id="categoryIndicator" class="category-indicator"></div>
    <script src="../../../js/cookie-consent.js"></script>
    <script src="../../../js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
</body>
</html>
