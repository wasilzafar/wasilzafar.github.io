<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="robots" content="index, archive" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Build practical x86 assembly projects: memory allocator, string library, encryption routines, image processing, file I/O utilities, and mathematical functions." />
    <meta name="author" content="Wasil Zafar" />
    <meta name="keywords" content="Assembly Projects, Memory Allocator, String Library, Encryption Assembly, Image Processing, x86 Projects, Practical Assembly" />
    <meta property="og:title" content="x86 Assembly Series Part 23: Practical Projects" />
    <meta property="og:description" content="Apply your assembly skills to real-world practical projects." />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2026-02-06" />
    <meta property="article:author" content="Wasil Zafar" />
    <meta property="article:section" content="Technology" />
    
    <title>x86 Assembly Series Part 23: Practical Projects - Wasil Zafar</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" id="prism-theme" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" />
    <link rel="apple-touch-icon" sizes="180x180" href="../../../images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon_io/favicon-32x32.png">
    <link rel="manifest" href="../../../images/favicon_io/site.webmanifest">

    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('consent', 'default', { 'ad_storage': 'denied', 'ad_user_data': 'denied', 'ad_personalization': 'denied', 'analytics_storage': 'denied', 'region': ['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE'] });
        gtag('consent', 'default', { 'ad_storage': 'granted', 'ad_user_data': 'granted', 'ad_personalization': 'granted', 'analytics_storage': 'granted' });
    </script>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PBS8M2JR');</script>
</head>
<body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBS8M2JR" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/"><span class="gradient-text">Wasil Zafar</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#skills">Skills</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#certifications">Certifications</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#interests">Interests</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="blog-hero">
        <div class="container py-5">
            <div class="blog-header">
                <a href="/pages/categories/technology.html" class="back-link"><i class="fas fa-arrow-left me-2"></i>Back to Technology</a>
                <h1 class="display-4 fw-bold mb-3">x86 Assembly Series Part 23: Practical Projects</h1>
                <div class="blog-meta">
                    <span><i class="fas fa-calendar me-2"></i>February 6, 2026</span>
                    <span><i class="fas fa-user me-2"></i>Wasil Zafar</span>
                    <span class="reading-time"><i class="fas fa-clock me-1"></i>45 min read</span>
                    <button onclick="window.print()" class="print-btn"><i class="fas fa-print"></i> Print</button>
                </div>
                <p class="lead">Apply your assembly skills: build a memory allocator, string library functions, XOR encryption, image grayscale conversion, file utilities, and fast mathematical routines.</p>
            </div>
        </div>
    </section>

    <button class="toc-toggle-btn" onclick="openNav()" title="Table of Contents"><i class="fas fa-list"></i></button>

    <div id="tocSidenav" class="sidenav-toc">
        <div class="toc-header">
            <h3><i class="fas fa-list me-2"></i>Table of Contents</h3>
            <button class="closebtn" onclick="closeNav()">&times;</button>
        </div>
        <ol>
            <li><a href="#string-lib" onclick="closeNav()">String Library</a></li>
            <li><a href="#allocator" onclick="closeNav()">Memory Allocator</a></li>
            <li><a href="#crypto" onclick="closeNav()">Encryption Routines</a></li>
            <li><a href="#image" onclick="closeNav()">Image Processing</a></li>
            <li><a href="#math" onclick="closeNav()">Math Functions</a></li>
            <li><a href="#file-io" onclick="closeNav()">File I/O Utilities</a></li>
        </ol>
    </div>
    <div id="tocOverlay" class="sidenav-overlay" onclick="closeNav()"></div>

    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">

                <div id="string-lib" class="blog-content">
                    <h2><i class="fas fa-font me-2 text-teal"></i>Project 1: String Library</h2>
                    
                    <div class="highlight-box">
                        <i class="fas fa-code me-2"></i>
                        Implement optimized versions of common string functions: strlen, strcpy, strcmp, memcpy, memset using assembly.
                    </div>

                    <div class="experiment-card">
                        <h4><i class="fas fa-map-signs me-2"></i>Complete Series Navigation</h4>
                        <div class="meta mb-2">
                            <span class="badge bg-teal me-2">25-Part Series</span>
                            <span class="badge bg-crimson">x86 Assembly Mastery</span>
                        </div>
                        <div class="content">
                            <p><strong>Foundation & Environment Setup</strong></p>
                            <ol start="0">
                                <li><a href="asm-part00-environment-setup.html">Development Environment, Tooling & Workflow</a></li>
                                <li><a href="asm-part01-fundamentals.html">Assembly Language Fundamentals & Toolchain Setup</a></li>
                                <li><a href="asm-part02-cpu-architecture.html">x86 CPU Architecture Overview</a></li>
                                <li><a href="asm-part03-registers.html">Registers – Complete Deep Dive</a></li>
                                <li><a href="asm-part04-instruction-encoding.html">Instruction Encoding & Binary Layout</a></li>
                            </ol>
                            <p class="mt-3"><strong>Assemblers, Syntax & Memory</strong></p>
                            <ol start="5">
                                <li><a href="asm-part05-nasm.html">NASM Syntax, Directives & Macros</a></li>
                                <li><a href="asm-part06-masm.html">Complete Assembler Comparison</a></li>
                                <li><a href="asm-part07-memory-addressing.html">Memory Addressing Modes</a></li>
                            </ol>
                            <p class="mt-3"><strong>Control Flow, Stack & Computation</strong></p>
                            <ol start="8">
                                <li><a href="asm-part08-stack-calling.html">Stack Internals & Calling Conventions</a></li>
                                <li><a href="asm-part09-control-flow.html">Control Flow & Procedures</a></li>
                                <li><a href="asm-part10-arithmetic.html">Integer, Bitwise & Arithmetic Operations</a></li>
                            </ol>
                            <p class="mt-3"><strong>Floating Point, SIMD & Performance</strong></p>
                            <ol start="11">
                                <li><a href="asm-part11-floating-point.html">Floating Point & SIMD Foundations</a></li>
                                <li><a href="asm-part12-simd.html">SIMD, Vectorization & Performance</a></li>
                            </ol>
                            <p class="mt-3"><strong>OS Interaction & Debugging</strong></p>
                            <ol start="13">
                                <li><a href="asm-part13-syscalls-interrupts.html">System Calls, Interrupts & Privilege Transitions</a></li>
                                <li><a href="asm-part14-debugging.html">Debugging & Reverse Engineering</a></li>
                                <li><a href="asm-part15-linking.html">Linking, Relocation & Loader Behavior</a></li>
                            </ol>
                            <p class="mt-3"><strong>Advanced Architecture & Interoperability</strong></p>
                            <ol start="16">
                                <li><a href="asm-part16-long-mode.html">x86-64 Long Mode & Advanced Features</a></li>
                                <li><a href="asm-part17-c-interop.html">Assembly + C/C++ Interoperability</a></li>
                                <li><a href="asm-part18-security.html">Memory Protection & Security Concepts</a></li>
                            </ol>
                            <p class="mt-3"><strong>Bare Metal, Kernel & Virtualization</strong></p>
                            <ol start="19">
                                <li><a href="asm-part19-bootloader.html">Bootloaders & Bare-Metal Programming</a></li>
                                <li><a href="asm-part20-kernel.html">Kernel-Level Assembly</a></li>
                                <li><a href="asm-part21-qemu.html">Complete Emulator & Simulator Guide</a></li>
                            </ol>
                            <p class="mt-3"><strong>CPU Microarchitecture & Optimization</strong></p>
                            <ol start="22">
                                <li><a href="asm-part22-optimization.html">Advanced Optimization & CPU Internals</a></li>
                            </ol>
                            <p class="mt-3"><strong>Real-World Application & Mastery</strong></p>
                            <ol start="23">
                                <li><strong>Real-World Assembly Projects (This Guide)</strong></li>
                                <li><a href="asm-part24-capstone.html">Assembly Mastery Capstone</a></li>
                            </ol>
                        </div>
                    </div>

                    <pre><code class="language-nasm">; Optimized strlen using SCASB
; Input:  RDI = pointer to null-terminated string
; Output: RAX = string length
global asm_strlen
asm_strlen:
    push rdi
    xor rcx, rcx
    dec rcx                 ; RCX = -1 (max count)
    xor al, al              ; Search for null byte
    repne scasb             ; Scan until null found
    not rcx                 ; Invert to get count
    dec rcx                 ; Exclude null terminator
    mov rax, rcx
    pop rdi
    ret

; Fast memcpy using REP MOVSQ
; Input:  RDI = dest, RSI = src, RDX = byte count
global asm_memcpy
asm_memcpy:
    mov rcx, rdx
    shr rcx, 3              ; Count of 8-byte chunks
    rep movsq               ; Copy 8 bytes at a time
    mov rcx, rdx
    and rcx, 7              ; Remaining bytes
    rep movsb               ; Copy remaining
    ret</code></pre>
                </div>

                <div id="allocator" class="blog-content mt-5">
                    <h2><i class="fas fa-memory me-2 text-teal"></i>Project 2: Memory Allocator</h2>
                    
                    <p>A bump allocator is the simplest dynamic memory allocator—it just keeps incrementing a pointer. Think of it like a notepad: you keep writing at the next available line, never erasing.</p>
                    
<pre><code class="language-plaintext">Bump Allocator Concept:

Heap Start                                    Current break
     │                                              │
     ▼                                              ▼
     ┌─────────┬─────────┬─────────┬───────────┐
     │ Alloc 1 │ Alloc 2 │ Alloc 3 │ FREE ...  │
     └─────────┴─────────┴─────────┴───────────┘
                                   ↑
                               next_ptr

Syscall 12 (brk): Set/get program break (end of heap)</code></pre>

<pre><code class="language-nasm">section .data
    heap_start  dq 0        ; Initial program break
    heap_ptr    dq 0        ; Current allocation pointer

section .text

; Initialize allocator - call once at program start
global alloc_init
alloc_init:
    mov rax, 12             ; syscall: brk
    xor rdi, rdi            ; Get current break (arg=0)
    syscall
    mov [rel heap_start], rax
    mov [rel heap_ptr], rax
    ret

; void* bump_alloc(size_t size)
; Input: RDI = size in bytes
; Output: RAX = pointer to allocated memory, or 0 on failure
global bump_alloc
bump_alloc:
    ; Align size to 16 bytes
    add rdi, 15
    and rdi, ~15
    
    ; Calculate new pointer
    mov rax, [rel heap_ptr]
    mov rsi, rax            ; Save current position (return value)
    add rax, rdi            ; New heap_ptr
    
    ; Expand heap with brk syscall
    push rsi
    mov rdi, rax            ; New break address
    mov rax, 12             ; syscall: brk
    syscall
    pop rsi
    
    ; Check if brk succeeded
    cmp rax, [rel heap_ptr]
    jle .failure            ; brk returns old value on failure
    
    ; Update pointer and return
    mov [rel heap_ptr], rax
    mov rax, rsi            ; Return old pointer (allocated memory)
    ret
    
.failure:
    xor eax, eax            ; Return NULL
    ret

; void alloc_reset(void)
; Reset allocator to initial state (free all memory)
global alloc_reset
alloc_reset:
    mov rax, [rel heap_start]
    mov [rel heap_ptr], rax
    mov rdi, rax
    mov rax, 12             ; syscall: brk
    syscall                 ; Shrink heap back
    ret</code></pre>

                    <div class="highlight-box">
                        <i class="fas fa-lightbulb me-2"></i>
                        <strong>Limitation:</strong> Bump allocators can't free individual allocations. Use <code>alloc_reset()</code> to free everything at once—perfect for arena/pool-style memory management.
                    </div>
                </div>

                <div id="crypto" class="blog-content mt-5">
                    <h2><i class="fas fa-lock me-2 text-teal"></i>Project 3: XOR Encryption</h2>
                    
                    <pre><code class="language-nasm">; XOR cipher - encrypt/decrypt buffer
; Input:  RDI = buffer, RSI = length, RDX = key (single byte)
global xor_cipher
xor_cipher:
    test rsi, rsi
    jz .done
    movzx eax, dl           ; Key byte in AL
.loop:
    xor [rdi], al           ; XOR byte with key
    inc rdi
    dec rsi
    jnz .loop
.done:
    ret</code></pre>
                </div>

                <div id="image" class="blog-content mt-5">
                    <h2><i class="fas fa-image me-2 text-teal"></i>Project 4: Image Grayscale</h2>
                    
                    <p>Convert RGB images to grayscale using SIMD. The standard formula is: <code>Gray = 0.299*R + 0.587*G + 0.114*B</code></p>
                    
<pre><code class="language-plaintext">RGB Pixel Format (24-bit):
┌─────┬─────┬─────┐
│  R  │  G  │  B  │  x 4 pixels = 12 bytes
└─────┴─────┴─────┘

RGBA Pixel Format (32-bit) - easier for SIMD:
┌─────┬─────┬─────┬─────┐
│  R  │  G  │  B  │  A  │  x 4 pixels = 16 bytes = 1 XMM
└─────┴─────┴─────┴─────┘</code></pre>

<pre><code class="language-nasm">section .data
align 16
    ; Grayscale coefficients (fixed-point: value * 256)
    coeff_r:    times 16 db 77     ; 0.299 * 256 ≈ 77
    coeff_g:    times 16 db 150    ; 0.587 * 256 ≈ 150
    coeff_b:    times 16 db 29     ; 0.114 * 256 ≈ 29

section .text

; void grayscale_sse(uint8_t* pixels, int count)
; Input: RDI = RGBA pixel array, RSI = pixel count
; Output: Modifies pixels in-place (R=G=B=gray, A unchanged)
global grayscale_sse
grayscale_sse:
    shr rsi, 2              ; Process 4 pixels per iteration
    jz .done
    
    movdqa xmm4, [rel coeff_r]
    movdqa xmm5, [rel coeff_g]
    movdqa xmm6, [rel coeff_b]
    
.loop:
    ; Load 4 RGBA pixels (16 bytes)
    movdqu xmm0, [rdi]      ; [R0 G0 B0 A0 | R1 G1 B1 A1 | ...]
    
    ; Extract R, G, B channels
    movdqa xmm1, xmm0       ; Copy for R
    movdqa xmm2, xmm0       ; Copy for G  
    movdqa xmm3, xmm0       ; Copy for B
    
    ; Mask to extract each channel (every 4th byte starting at offset)
    pand xmm1, [rel mask_r] ; Keep R bytes
    pand xmm2, [rel mask_g] ; Keep G bytes
    pand xmm3, [rel mask_b] ; Keep B bytes
    
    ; Shift G and B to align with R position for calculation
    psrld xmm2, 8           ; G >> 8
    psrld xmm3, 16          ; B >> 16
    
    ; Multiply by coefficients (8-bit)
    pmullw xmm1, xmm4       ; R * 77
    pmullw xmm2, xmm5       ; G * 150
    pmullw xmm3, xmm6       ; B * 29
    
    ; Sum and divide by 256 (shift right 8)
    paddw xmm1, xmm2
    paddw xmm1, xmm3
    psrlw xmm1, 8           ; gray = (R*77 + G*150 + B*29) / 256
    
    ; Pack gray value to all RGB channels
    ; Result: [gray gray gray A0 | gray gray gray A1 | ...]
    movdqa xmm2, xmm1
    pslld xmm1, 8           ; gray << 8 (to G position)
    por xmm2, xmm1
    pslld xmm1, 8           ; gray << 16 (to B position)
    por xmm2, xmm1
    pand xmm0, [rel mask_a] ; Keep original alpha
    por xmm2, xmm0          ; Combine gray RGB + original A
    
    movdqu [rdi], xmm2      ; Store result
    
    add rdi, 16
    dec rsi
    jnz .loop
    
.done:
    ret

section .rodata
align 16
    mask_r: times 4 dd 0x000000FF
    mask_g: times 4 dd 0x0000FF00
    mask_b: times 4 dd 0x00FF0000
    mask_a: times 4 dd 0xFF000000</code></pre>
                </div>

                <div id="math" class="blog-content mt-5">
                    <h2><i class="fas fa-calculator me-2 text-teal"></i>Project 5: Math Functions</h2>
                    
                    <h3>Fast Integer Square Root</h3>
                    <p>Newton-Raphson method for integer square root—useful in graphics and game dev where floating point is too slow.</p>
                    
<pre><code class="language-nasm">; uint32_t isqrt(uint32_t n)
; Input: EDI = n
; Output: EAX = floor(sqrt(n))
global isqrt
isqrt:
    test edi, edi
    jz .zero                ; sqrt(0) = 0
    
    ; Initial guess: highest set bit / 2
    bsr eax, edi            ; Find highest set bit
    shr eax, 1              ; Divide position by 2
    mov ecx, 1
    shl ecx, cl             ; Initial guess = 2^(bit_pos/2)
    mov eax, ecx
    
.newton_loop:
    ; x_new = (x + n/x) / 2
    mov edx, edi
    xor ecx, ecx
    div eax                 ; EDX:EAX = n / x
    add eax, ecx            ; x + n/x (ECX held old x)
    shr eax, 1              ; / 2
    
    ; Check convergence
    mov ecx, eax            ; Save for next iteration
    cmp eax, edx
    ja .newton_loop         ; Keep iterating if not converged
    
    ret
    
.zero:
    xor eax, eax
    ret

; Simpler version using bit manipulation
global isqrt_bit
isqrt_bit:
    xor eax, eax            ; Result = 0
    mov ecx, 1 << 30        ; Start with highest power of 4 <= 2^30
    
.bit_loop:
    test ecx, ecx
    jz .done
    
    mov edx, eax
    add edx, ecx            ; result + bit
    cmp edi, edx
    jb .shift
    
    sub edi, edx            ; n -= (result + bit)
    shr eax, 1
    add eax, ecx            ; result = result/2 + bit
    shr ecx, 2              ; bit /= 4
    jmp .bit_loop
    
.shift:
    shr eax, 1              ; result /= 2
    shr ecx, 2              ; bit /= 4
    jmp .bit_loop
    
.done:
    ret</code></pre>

                    <h3>Factorial</h3>
<pre><code class="language-nasm">; uint64_t factorial(uint32_t n)
; Input: EDI = n (max 20 for 64-bit result)
; Output: RAX = n!
global factorial
factorial:
    mov eax, 1              ; result = 1
    test edi, edi
    jz .done                ; 0! = 1
    
    cmp edi, 20
    ja .overflow            ; 21! > 2^64
    
.loop:
    imul rax, rdi           ; result *= n
    dec edi
    jnz .loop
    
.done:
    ret
    
.overflow:
    mov rax, -1             ; Return max value on overflow
    ret

; Lookup table version (fastest for small n)
section .rodata
align 8
factorial_table:
    dq 1                    ; 0!
    dq 1                    ; 1!
    dq 2                    ; 2!
    dq 6                    ; 3!
    dq 24                   ; 4!
    dq 120                  ; 5!
    dq 720                  ; 6!
    dq 5040                 ; 7!
    dq 40320                ; 8!
    dq 362880               ; 9!
    dq 3628800              ; 10!
    ; ... up to 20!

section .text
global factorial_lookup
factorial_lookup:
    cmp edi, 20
    ja .overflow
    mov rax, [rel factorial_table + rdi*8]
    ret
.overflow:
    mov rax, -1
    ret</code></pre>
                </div>

                <div id="file-io" class="blog-content mt-5">
                    <h2><i class="fas fa-file me-2 text-teal"></i>Project 6: File I/O</h2>
                    
                    <p>Direct file operations using Linux syscalls—no libc required. Essential for standalone programs and understanding how file I/O really works.</p>
                    
                    <h3>Syscall Reference</h3>
                    <div class="table-responsive">
                        <table class="table table-bordered table-sm">
                            <thead class="table-dark">
                                <tr><th>Syscall</th><th>RAX</th><th>RDI</th><th>RSI</th><th>RDX</th><th>Returns</th></tr>
                            </thead>
                            <tbody>
                                <tr><td>open</td><td>2</td><td>filename</td><td>flags</td><td>mode</td><td>fd or -errno</td></tr>
                                <tr><td>read</td><td>0</td><td>fd</td><td>buffer</td><td>count</td><td>bytes read</td></tr>
                                <tr><td>write</td><td>1</td><td>fd</td><td>buffer</td><td>count</td><td>bytes written</td></tr>
                                <tr><td>close</td><td>3</td><td>fd</td><td>-</td><td>-</td><td>0 or -errno</td></tr>
                                <tr><td>lseek</td><td>8</td><td>fd</td><td>offset</td><td>whence</td><td>new position</td></tr>
                            </tbody>
                        </table>
                    </div>

<pre><code class="language-nasm">section .data
    filename db "test.txt", 0
    write_msg db "Hello from assembly!", 10
    write_len equ $ - write_msg

section .bss
    buffer resb 4096        ; 4KB read buffer
    fd resq 1               ; File descriptor

section .text

; Open flags (from fcntl.h)
O_RDONLY    equ 0
O_WRONLY    equ 1
O_RDWR      equ 2
O_CREAT     equ 0x40
O_TRUNC     equ 0x200
O_APPEND    equ 0x400

; int open_file(const char* path, int flags, int mode)
; Returns: fd on success, negative on error
global open_file
open_file:
    mov rax, 2              ; syscall: open
    ; RDI = path (already set)
    ; RSI = flags (already set)
    ; RDX = mode (already set)
    syscall
    ret

; ssize_t read_file(int fd, void* buf, size_t count)
global read_file
read_file:
    mov rax, 0              ; syscall: read
    syscall
    ret

; ssize_t write_file(int fd, const void* buf, size_t count)
global write_file
write_file:
    mov rax, 1              ; syscall: write
    syscall
    ret

; int close_file(int fd)
global close_file
close_file:
    mov rax, 3              ; syscall: close
    syscall
    ret

; Complete example: Copy file to stdout
global cat_file
cat_file:
    ; RDI = filename
    push rbp
    mov rbp, rsp
    sub rsp, 16
    
    ; Open file for reading
    mov rsi, O_RDONLY
    xor edx, edx            ; mode unused for reading
    call open_file
    test rax, rax
    js .error               ; Jump if negative (error)
    mov [rbp-8], rax        ; Save fd
    
.read_loop:
    ; Read chunk
    mov rdi, [rbp-8]        ; fd
    lea rsi, [rel buffer]   ; buffer
    mov rdx, 4096           ; count
    call read_file
    
    test rax, rax
    jz .done                ; EOF
    js .error               ; Error
    
    ; Write to stdout
    mov rdx, rax            ; bytes read = bytes to write
    mov rdi, 1              ; fd = stdout
    lea rsi, [rel buffer]
    call write_file
    
    jmp .read_loop
    
.done:
    ; Close file
    mov rdi, [rbp-8]
    call close_file
    xor eax, eax            ; Return 0 (success)
    jmp .exit
    
.error:
    mov eax, -1             ; Return -1 (error)
    
.exit:
    leave
    ret</code></pre>

                    <div class="experiment-card">
                        <div class="experiment-meta">
                            <span class="badge bg-primary">Exercise</span>
                        </div>
                        <div class="experiment-content">
                            <h4>Build a File Copy Utility</h4>
                            <p>Combine these functions to create <code>cp_asm src dest</code>:</p>
                            <ol>
                                <li>Open source file for reading</li>
                                <li>Create/truncate destination file (<code>O_WRONLY | O_CREAT | O_TRUNC</code>, mode 0644)</li>
                                <li>Loop: read chunk, write chunk until EOF</li>
                                <li>Close both files</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <div class="blog-content mt-5">
                    <div class="related-posts">
                        <h3><i class="fas fa-book-reader me-2"></i>Continue the Series</h3>
                        <div class="related-post-item">
                            <h5 class="mb-2">Part 22: Performance & Optimization</h5>
                            <p class="text-muted small mb-2">Techniques to make your projects faster.</p>
                            <a href="asm-part22-optimization.html" class="text-decoration-none">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                        <div class="related-post-item">
                            <h5 class="mb-2">Part 24: Capstone Project</h5>
                            <p class="text-muted small mb-2">Comprehensive capstone combining all skills.</p>
                            <a href="asm-part24-capstone.html" class="text-decoration-none">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                        <div class="related-post-item">
                            <h5 class="mb-2">Part 17: C & Assembly Interop</h5>
                            <p class="text-muted small mb-2">Integrate these projects with C applications.</p>
                            <a href="asm-part17-c-interop.html" class="text-decoration-none">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                    </div>
                </div>

                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="social-media" class="bg-dark text-light py-5">
        <div class="container py-5">
            <div class="row mb-4">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h5 class="fw-bold mb-3">Let's Connect</h5>
                    <p class="text-light">
                        I'm always interested in sharing content about my interests on different topics. Read disclaimer and feel free to share further.
                    </p>
                </div>
                <div class="col-lg-6">
                    <h5 class="fw-bold mb-3">Follow Me</h5>
                    <div class="social-links d-flex gap-2 flex-wrap">
                        <a href="https://www.facebook.com/wasil.zafar/" target="_blank" class="social-icon" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://twitter.com/wasilzafar" target="_blank" class="social-icon" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.linkedin.com/in/wasilzafar" target="_blank" class="social-icon" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@wasilzafar" target="_blank" class="social-icon" title="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://www.instagram.com/itswzee/" target="_blank" class="social-icon" title="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="https://in.pinterest.com/wasilz/" target="_blank" class="social-icon" title="Pinterest"><i class="fab fa-pinterest-p"></i></a>
                        <a href="mailto:wasil.zafar@gmail.com" class="social-icon" title="Email"><i class="fas fa-envelope"></i></a>
                    </div>
                </div>
            </div>
            <hr class="bg-secondary">
            <div class="row mt-4">
                <div class="col-md-6">
                    <p class="small"><i class="fas fa-icons me-2"></i>Icons from <a href="https://www.flaticon.com/" target="_blank" class="text-light">Flaticon</a> &amp; <a href="https://fontawesome.com/" target="_blank" class="text-light">Font Awesome</a></p>
                    <p class="small mt-3">
                        <a href="/" class="text-light text-decoration-none">Home</a> | 
                        <a href="/disclaimer.html" class="text-light text-decoration-none">Disclaimer</a> | 
                        <a href="/privacy-policy.html" class="text-light text-decoration-none">Privacy Policy</a>
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small">Enjoying this content? ☕ <a href="https://buymeacoffee.com/itswzee" target="_blank" class="text-light" style="text-decoration: underline;">Keep me caffeinated</a> to keep the pixels flowing!</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <button id="scrollToTop" class="scroll-to-top"><i class="fas fa-arrow-up"></i></button>
    <div id="categoryIndicator" class="category-indicator"></div>
    <script src="../../../js/cookie-consent.js"></script>
    <script src="../../../js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-nasm.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
</body>
</html>
