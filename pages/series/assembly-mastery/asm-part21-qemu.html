<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="robots" content="index, archive" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Complete guide to x86 emulators and simulators: QEMU, Bochs, gem5, Unicorn, Valgrind, DOSBox, and Simics. Compare accuracy, speed, and best use cases for OS development, security research, and CPU testing." />
    <meta name="author" content="Wasil Zafar" />
    <meta name="keywords" content="QEMU, Bochs, gem5, Unicorn Engine, Valgrind, DOSBox, Simics, x86 Emulator, CPU Simulator, Virtual Machine, Assembly Testing, Kernel Development" />
    <meta property="og:title" content="x86 Assembly Series Part 21: Complete Emulator & Simulator Guide (QEMU, Bochs, gem5, Unicorn, Valgrind, DOSBox, Simics)" />
    <meta property="og:description" content="Master x86 emulators and simulators for OS development, security research, and CPU analysis." />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2026-02-06" />
    <meta property="article:author" content="Wasil Zafar" />
    <meta property="article:section" content="Technology" />
    
    <title>x86 Assembly Series Part 21: Complete Emulator & Simulator Guide - Wasil Zafar</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" id="prism-theme" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" />
    <link rel="apple-touch-icon" sizes="180x180" href="../../../images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon_io/favicon-32x32.png">
    <link rel="manifest" href="../../../images/favicon_io/site.webmanifest">

    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('consent', 'default', { 'ad_storage': 'denied', 'ad_user_data': 'denied', 'ad_personalization': 'denied', 'analytics_storage': 'denied', 'region': ['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE'] });
        gtag('consent', 'default', { 'ad_storage': 'granted', 'ad_user_data': 'granted', 'ad_personalization': 'granted', 'analytics_storage': 'granted' });
    </script>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PBS8M2JR');</script>
</head>
<body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBS8M2JR" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/"><span class="gradient-text">Wasil Zafar</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#skills">Skills</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#certifications">Certifications</a></li>
                    <li class="nav-item"><a class="nav-link" href="/#interests">Interests</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="blog-hero">
        <div class="container py-5">
            <div class="blog-header">
                <a href="/pages/categories/technology.html" class="back-link"><i class="fas fa-arrow-left me-2"></i>Back to Technology</a>
                <h1 class="display-4 fw-bold mb-3">x86 Assembly Series Part 21: Complete Emulator & Simulator Guide</h1>
                <div class="blog-meta">
                    <span><i class="fas fa-calendar me-2"></i>February 6, 2026</span>
                    <span><i class="fas fa-user me-2"></i>Wasil Zafar</span>
                    <span class="reading-time"><i class="fas fa-clock me-1"></i>45 min read</span>
                    <button onclick="window.print()" class="print-btn"><i class="fas fa-print"></i> Print</button>
                </div>
                <p class="lead">Master x86 emulators and simulators for assembly development: QEMU for general OS testing, Bochs for instruction correctness, gem5 for CPU research, Unicorn for security analysis, Valgrind for memory debugging, DOSBox for real-mode, and Simics for enterprise hardware.</p>
            </div>
        </div>
    </section>

    <button class="toc-toggle-btn" onclick="openNav()" title="Table of Contents"><i class="fas fa-list"></i></button>

    <div id="tocSidenav" class="sidenav-toc">
        <div class="toc-header">
            <h3><i class="fas fa-list me-2"></i>Table of Contents</h3>
            <button class="closebtn" onclick="closeNav()">&times;</button>
        </div>
        <ol>
            <li>
                <a href="#emulator-overview" onclick="closeNav()">Emulator Overview</a>
                <ul>
                    <li><a href="#comparison-table" onclick="closeNav()">Quick Comparison</a></li>
                    <li><a href="#choosing-emulator" onclick="closeNav()">Choosing an Emulator</a></li>
                </ul>
            </li>
            <li>
                <a href="#qemu" onclick="closeNav()">QEMU</a>
                <ul>
                    <li><a href="#qemu-basics" onclick="closeNav()">Basics & Installation</a></li>
                    <li><a href="#qemu-gdb" onclick="closeNav()">GDB Remote Debugging</a></li>
                    <li><a href="#qemu-monitor" onclick="closeNav()">Monitor Commands</a></li>
                    <li><a href="#qemu-disk" onclick="closeNav()">Disk Images</a></li>
                </ul>
            </li>
            <li>
                <a href="#bochs" onclick="closeNav()">Bochs</a>
                <ul>
                    <li><a href="#bochs-setup" onclick="closeNav()">Setup & Configuration</a></li>
                    <li><a href="#bochs-debugging" onclick="closeNav()">Built-in Debugger</a></li>
                </ul>
            </li>
            <li>
                <a href="#gem5" onclick="closeNav()">gem5</a>
                <ul>
                    <li><a href="#gem5-intro" onclick="closeNav()">Architecture</a></li>
                    <li><a href="#gem5-modes" onclick="closeNav()">Simulation Modes</a></li>
                </ul>
            </li>
            <li>
                <a href="#unicorn" onclick="closeNav()">Unicorn Engine</a>
                <ul>
                    <li><a href="#unicorn-basics" onclick="closeNav()">Basics & API</a></li>
                    <li><a href="#unicorn-shellcode" onclick="closeNav()">Shellcode Analysis</a></li>
                </ul>
            </li>
            <li>
                <a href="#valgrind" onclick="closeNav()">Valgrind</a>
                <ul>
                    <li><a href="#valgrind-memcheck" onclick="closeNav()">Memcheck</a></li>
                    <li><a href="#valgrind-assembly" onclick="closeNav()">Assembly Analysis</a></li>
                </ul>
            </li>
            <li>
                <a href="#dosbox" onclick="closeNav()">DOSBox</a>
                <ul>
                    <li><a href="#dosbox-realmode" onclick="closeNav()">Real-Mode Testing</a></li>
                    <li><a href="#dosbox-debug" onclick="closeNav()">Debug Commands</a></li>
                </ul>
            </li>
            <li>
                <a href="#simics" onclick="closeNav()">Simics</a>
                <ul>
                    <li><a href="#simics-overview" onclick="closeNav()">Overview</a></li>
                    <li><a href="#simics-features" onclick="closeNav()">Enterprise Features</a></li>
                </ul>
            </li>
            <li><a href="#decision-matrix" onclick="closeNav()">Decision Matrix</a></li>
        </ol>
    </div>
    <div id="tocOverlay" class="sidenav-overlay" onclick="closeNav()"></div>

    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">

                <div id="emulator-overview" class="blog-content">
                    <h2><i class="fas fa-desktop me-2 text-teal"></i>Emulator & Simulator Overview</h2>
                    
                    <div class="highlight-box">
                        <i class="fas fa-lightbulb me-2"></i>
                        Understanding the difference: <strong>Emulators</strong> mimic hardware behavior to run software, while <strong>simulators</strong> model system behavior for analysis. Some tools (like gem5) are true simulators; others (like QEMU) are emulators that can also use hardware virtualization.
                    </div>

                    <div class="experiment-card">
                        <h4><i class="fas fa-map-signs me-2"></i>Complete Series Navigation</h4>
                        <div class="meta mb-2">
                            <span class="badge bg-teal me-2">25-Part Series</span>
                            <span class="badge bg-crimson">x86 Assembly Mastery</span>
                        </div>
                        <div class="content">
                            <p><strong>Foundation & Environment Setup</strong></p>
                            <ol start="0">
                                <li><a href="asm-part00-environment-setup.html">Development Environment, Tooling & Workflow</a></li>
                                <li><a href="asm-part01-fundamentals.html">Assembly Language Fundamentals & Toolchain Setup</a></li>
                                <li><a href="asm-part02-cpu-architecture.html">x86 CPU Architecture Overview</a></li>
                                <li><a href="asm-part03-registers.html">Registers – Complete Deep Dive</a></li>
                                <li><a href="asm-part04-instruction-encoding.html">Instruction Encoding & Binary Layout</a></li>
                            </ol>
                            <p class="mt-3"><strong>Assemblers, Syntax & Memory</strong></p>
                            <ol start="5">
                                <li><a href="asm-part05-nasm.html">NASM Syntax, Directives & Macros</a></li>
                                <li><a href="asm-part06-masm.html">Complete Assembler Comparison</a></li>
                                <li><a href="asm-part07-memory-addressing.html">Memory Addressing Modes</a></li>
                            </ol>
                            <p class="mt-3"><strong>Control Flow, Stack & Computation</strong></p>
                            <ol start="8">
                                <li><a href="asm-part08-stack-calling.html">Stack Internals & Calling Conventions</a></li>
                                <li><a href="asm-part09-control-flow.html">Control Flow & Procedures</a></li>
                                <li><a href="asm-part10-arithmetic.html">Integer, Bitwise & Arithmetic Operations</a></li>
                            </ol>
                            <p class="mt-3"><strong>Floating Point, SIMD & Performance</strong></p>
                            <ol start="11">
                                <li><a href="asm-part11-floating-point.html">Floating Point & SIMD Foundations</a></li>
                                <li><a href="asm-part12-simd.html">SIMD, Vectorization & Performance</a></li>
                            </ol>
                            <p class="mt-3"><strong>OS Interaction & Debugging</strong></p>
                            <ol start="13">
                                <li><a href="asm-part13-syscalls-interrupts.html">System Calls, Interrupts & Privilege Transitions</a></li>
                                <li><a href="asm-part14-debugging.html">Debugging & Reverse Engineering</a></li>
                                <li><a href="asm-part15-linking.html">Linking, Relocation & Loader Behavior</a></li>
                            </ol>
                            <p class="mt-3"><strong>Advanced Architecture & Interoperability</strong></p>
                            <ol start="16">
                                <li><a href="asm-part16-long-mode.html">x86-64 Long Mode & Advanced Features</a></li>
                                <li><a href="asm-part17-c-interop.html">Assembly + C/C++ Interoperability</a></li>
                                <li><a href="asm-part18-security.html">Memory Protection & Security Concepts</a></li>
                            </ol>
                            <p class="mt-3"><strong>Bare Metal, Kernel & Virtualization</strong></p>
                            <ol start="19">
                                <li><a href="asm-part19-bootloader.html">Bootloaders & Bare-Metal Programming</a></li>
                                <li><a href="asm-part20-kernel.html">Kernel-Level Assembly</a></li>
                                <li><strong>Complete Emulator & Simulator Guide (This Guide)</strong></li>
                            </ol>
                            <p class="mt-3"><strong>CPU Microarchitecture & Optimization</strong></p>
                            <ol start="22">
                                <li><a href="asm-part22-optimization.html">Advanced Optimization & CPU Internals</a></li>
                            </ol>
                            <p class="mt-3"><strong>Real-World Application & Mastery</strong></p>
                            <ol start="23">
                                <li><a href="asm-part23-projects.html">Real-World Assembly Projects</a></li>
                                <li><a href="asm-part24-capstone.html">Assembly Mastery Capstone</a></li>
                            </ol>
                        </div>
                    </div>

                    <div id="comparison-table" class="mt-4">
                        <h3>Quick Comparison Table</h3>
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Tool</th>
                                        <th>Accuracy</th>
                                        <th>Speed</th>
                                        <th>Best Use</th>
                                        <th>License</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>QEMU</strong></td>
                                        <td>Medium–High</td>
                                        <td>Fast</td>
                                        <td>General OS & kernel development</td>
                                        <td>GPL-2.0</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Bochs</strong></td>
                                        <td>Very High</td>
                                        <td>Very Slow</td>
                                        <td>Instruction correctness testing</td>
                                        <td>LGPL-2.1</td>
                                    </tr>
                                    <tr>
                                        <td><strong>gem5</strong></td>
                                        <td>Extremely High</td>
                                        <td>Very Slow</td>
                                        <td>CPU architecture research</td>
                                        <td>BSD</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Unicorn</strong></td>
                                        <td>High</td>
                                        <td>Medium</td>
                                        <td>Security & shellcode analysis</td>
                                        <td>GPL-2.0</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Valgrind</strong></td>
                                        <td>High</td>
                                        <td>Very Slow</td>
                                        <td>Memory correctness debugging</td>
                                        <td>GPL-2.0</td>
                                    </tr>
                                    <tr>
                                        <td><strong>DOSBox</strong></td>
                                        <td>Medium</td>
                                        <td>Fast</td>
                                        <td>Real-mode / BIOS / DOS programs</td>
                                        <td>GPL-2.0</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Simics</strong></td>
                                        <td>Extremely High</td>
                                        <td>Medium</td>
                                        <td>Enterprise hardware simulation</td>
                                        <td>Commercial</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div id="choosing-emulator" class="mt-4">
                        <h3>Choosing an Emulator</h3>
                        <ul>
                            <li><strong>General bootloader/kernel development</strong>: Start with <span class="bias-tag">QEMU</span> for fast iteration</li>
                            <li><strong>Debugging instruction-level bugs</strong>: Use <span class="bias-tag">Bochs</span> for cycle-accurate behavior</li>
                            <li><strong>CPU microarchitecture research</strong>: Use <span class="bias-tag">gem5</span> for detailed simulation</li>
                            <li><strong>Security research & CTF</strong>: Use <span class="bias-tag">Unicorn</span> for quick shellcode emulation</li>
                            <li><strong>Memory bug hunting</strong>: Use <span class="bias-tag">Valgrind</span> to catch leaks and invalid accesses</li>
                            <li><strong>DOS/16-bit real-mode</strong>: Use <span class="bias-tag">DOSBox</span> for legacy software</li>
                            <li><strong>Enterprise firmware development</strong>: Consider <span class="bias-tag">Simics</span> for full-system simulation</li>
                        </ul>
                    </div>
                </div>

                <!-- QEMU Section -->
                <div id="qemu" class="blog-content mt-5">
                    <h2><i class="fas fa-server me-2 text-teal"></i>QEMU — General-Purpose Emulator</h2>
                    
                    <div class="highlight-box">
                        <i class="fas fa-info-circle me-2"></i>
                        QEMU (Quick Emulator) is the most popular choice for OS development. It supports full system emulation, user-mode emulation, and can leverage KVM for near-native performance on Linux.
                    </div>

                    <h3 id="qemu-basics">Installation & Basics</h3>
                    <pre><code class="language-bash"># Install QEMU (Ubuntu/Debian)
sudo apt install qemu-system-x86 qemu-utils

# Install QEMU (Windows - use MSYS2 or official installer)
# Download from: https://www.qemu.org/download/

# Basic invocation for boot sector
qemu-system-x86_64 -drive format=raw,file=boot.bin

# With debugging enabled (-s: GDB on :1234, -S: freeze at startup)
qemu-system-x86_64 -drive format=raw,file=boot.bin -s -S

# Run 32-bit system
qemu-system-i386 -drive format=raw,file=boot.bin

# Run with floppy drive emulation
qemu-system-i386 -fda boot.bin

# Run kernel with multiboot
qemu-system-i386 -kernel kernel.bin</code></pre>

                    <h3 id="qemu-gdb">GDB Remote Debugging</h3>
                    <pre><code class="language-bash"># Terminal 1: Start QEMU with GDB stub
qemu-system-x86_64 -drive format=raw,file=boot.bin -s -S

# Terminal 2: Connect GDB
gdb
(gdb) target remote localhost:1234
(gdb) set architecture i8086    # For 16-bit real mode
(gdb) break *0x7c00             # Break at boot sector load address
(gdb) continue
(gdb) x/20i $eip                # Disassemble 20 instructions
(gdb) info registers            # View all registers
(gdb) stepi                     # Single-step instruction</code></pre>

                    <h3 id="qemu-monitor">QEMU Monitor Commands</h3>
                    <p>Press <code>Ctrl+Alt+2</code> to access the QEMU monitor (or use <code>-monitor stdio</code>):</p>
                    <pre><code class="language-bash"># Common monitor commands
info registers       # Display CPU registers
info cpus           # Show CPU state
info mem            # Show virtual memory mappings
info tlb            # Show TLB entries
xp /20xw 0x7c00     # Examine physical memory (20 words at 0x7c00)
x /20i 0x7c00       # Disassemble from address
memsave 0 0x100000 dump.bin   # Save memory to file
stop                # Pause emulation
cont                # Continue emulation
system_reset        # Reset the system
quit                # Exit QEMU</code></pre>

                    <h3 id="qemu-disk">Disk Images & Hardware Configuration</h3>
                    <pre><code class="language-bash"># Create disk images
qemu-img create -f raw disk.img 512M        # Raw format
qemu-img create -f qcow2 disk.qcow2 10G     # QCOW2 (sparse, snapshots)

# Memory and CPU configuration
qemu-system-x86_64 -m 512M -smp 2 -drive format=raw,file=boot.bin

# Enable hardware acceleration (Linux KVM)
qemu-system-x86_64 -enable-kvm -m 2G -drive format=raw,file=boot.bin

# Serial output to terminal
qemu-system-i386 -nographic -serial mon:stdio -drive format=raw,file=boot.bin

# Network configuration
qemu-system-x86_64 -netdev user,id=net0 -device e1000,netdev=net0</code></pre>
                </div>

                <!-- Bochs Section -->
                <div id="bochs" class="blog-content mt-5">
                    <h2><i class="fas fa-microscope me-2 text-teal"></i>Bochs — Instruction-Accurate Emulator</h2>
                    
                    <div class="highlight-box">
                        <i class="fas fa-info-circle me-2"></i>
                        Bochs is a highly portable x86 PC emulator focused on <strong>correctness over speed</strong>. It emulates every instruction cycle-by-cycle, making it invaluable for debugging subtle CPU bugs that QEMU might miss.
                    </div>

                    <h3 id="bochs-setup">Installation & Configuration</h3>
                    <pre><code class="language-bash"># Install Bochs (Ubuntu/Debian)
sudo apt install bochs bochs-x bochsbios

# Bochs configuration file: bochsrc.txt
megs: 32
romimage: file=/usr/share/bochs/BIOS-bochs-latest
vgaromimage: file=/usr/share/bochs/VGABIOS-lgpl-latest
floppya: 1_44=boot.bin, status=inserted
boot: floppy
log: bochs.log
mouse: enabled=0

# Run Bochs
bochs -f bochsrc.txt</code></pre>

                    <h3 id="bochs-debugging">Built-in Debugger</h3>
                    <p>Bochs has a powerful integrated debugger. Compile with <code>--enable-debugger</code> or use <code>bochs-dbg</code>:</p>
                    <pre><code class="language-bash"># Bochs debugger commands
b 0x7c00            # Set breakpoint at address
c                   # Continue execution
s                   # Single step
n                   # Step over (next)
r                   # Show registers
sreg                # Show segment registers
creg                # Show control registers
u 0x7c00 0x7c20     # Disassemble range
x /40bx 0x7c00      # Examine 40 bytes at address
xp /20 0x7c00       # Examine physical memory
trace-on            # Enable instruction trace
watch read 0x7c00   # Watch memory reads
watch write 0x7c00  # Watch memory writes
info break          # List breakpoints
del 1               # Delete breakpoint 1
q                   # Quit</code></pre>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>When to use Bochs over QEMU:</strong> Use Bochs when you suspect instruction timing issues, need to verify exact CPU flag behavior, or when debugging code that works in QEMU but fails on real hardware.
                    </div>
                </div>

                <!-- gem5 Section -->
                <div id="gem5" class="blog-content mt-5">
                    <h2><i class="fas fa-atom me-2 text-teal"></i>gem5 — CPU Research Simulator</h2>
                    
                    <div class="highlight-box">
                        <i class="fas fa-info-circle me-2"></i>
                        gem5 is a modular computer system simulator used for <strong>CPU architecture research</strong>. It models cache hierarchies, pipeline stages, and memory systems in extreme detail.
                    </div>

                    <h3 id="gem5-intro">Architecture & Installation</h3>
                    <pre><code class="language-bash"># Clone gem5 repository
git clone https://gem5.googlesource.com/public/gem5
cd gem5

# Install dependencies (Ubuntu)
sudo apt install build-essential git m4 scons zlib1g-dev \
    libprotobuf-dev protobuf-compiler libgoogle-perftools-dev

# Build gem5 for x86 (takes 30+ minutes)
scons build/X86/gem5.opt -j$(nproc)

# Run simple x86 simulation
./build/X86/gem5.opt configs/example/se.py --cmd=tests/test-progs/hello/bin/x86/linux/hello</code></pre>

                    <h3 id="gem5-modes">Simulation Modes</h3>
                    <ul>
                        <li><strong>SE (Syscall Emulation)</strong>: Run user-space binaries without OS</li>
                        <li><strong>FS (Full System)</strong>: Boot complete operating system</li>
                    </ul>
                    <pre><code class="language-python"># gem5 configuration script example
import m5
from m5.objects import *

system = System()
system.clk_domain = SrcClockDomain()
system.clk_domain.clock = '1GHz'
system.mem_mode = 'timing'
system.mem_ranges = [AddrRange('512MB')]

# Create CPU
system.cpu = TimingSimpleCPU()

# Memory system
system.membus = SystemXBar()
system.cpu.icache_port = system.membus.cpu_side_ports
system.cpu.dcache_port = system.membus.cpu_side_ports

# Run simulation
root = Root(full_system=False, system=system)
m5.instantiate()
m5.simulate()</code></pre>

                    <div class="highlight-box highlight-navy">
                        <i class="fas fa-graduation-cap me-2"></i>
                        <strong>Research Applications:</strong> gem5 is used to study branch prediction, cache replacement policies, out-of-order execution, and speculative execution vulnerabilities like Spectre.
                    </div>
                </div>

                <!-- Unicorn Section -->
                <div id="unicorn" class="blog-content mt-5">
                    <h2><i class="fas fa-shield-alt me-2 text-teal"></i>Unicorn Engine — Security Framework</h2>
                    
                    <div class="highlight-box">
                        <i class="fas fa-info-circle me-2"></i>
                        Unicorn is a lightweight CPU emulator framework based on QEMU's CPU emulation core. It provides a simple API for running arbitrary machine code, making it ideal for <strong>security research and reverse engineering</strong>.
                    </div>

                    <h3 id="unicorn-basics">Installation & Basic Usage</h3>
                    <pre><code class="language-bash"># Install Unicorn (Python bindings)
pip install unicorn

# Install Unicorn (system libraries)
sudo apt install libunicorn-dev</code></pre>

                    <pre><code class="language-python"># Python example: Emulate x86 code
from unicorn import *
from unicorn.x86_const import *

# Machine code: INC ECX; DEC EDX
X86_CODE32 = b"\x41\x4a"

# Memory address where emulation starts
ADDRESS = 0x1000000

# Initialize emulator in x86-32 mode
mu = Uc(UC_ARCH_X86, UC_MODE_32)

# Map 2MB memory for this emulation
mu.mem_map(ADDRESS, 2 * 1024 * 1024)

# Write machine code to memory
mu.mem_write(ADDRESS, X86_CODE32)

# Initialize registers
mu.reg_write(UC_X86_REG_ECX, 0x1234)
mu.reg_write(UC_X86_REG_EDX, 0x7890)

# Emulate code
mu.emu_start(ADDRESS, ADDRESS + len(X86_CODE32))

# Read registers after emulation
print("ECX = 0x%x" % mu.reg_read(UC_X86_REG_ECX))  # 0x1235
print("EDX = 0x%x" % mu.reg_read(UC_X86_REG_EDX))  # 0x788f</code></pre>

                    <h3 id="unicorn-shellcode">Shellcode Analysis</h3>
                    <pre><code class="language-python"># Emulate shellcode with hooks
from unicorn import *
from unicorn.x86_const import *

def hook_code(uc, address, size, user_data):
    print(">>> Executing at 0x%x, instruction size = %d" % (address, size))

def hook_mem_access(uc, access, address, size, value, user_data):
    if access == UC_MEM_WRITE:
        print(">>> Memory WRITE at 0x%x, size = %d, value = 0x%x" % (address, size, value))
    else:
        print(">>> Memory READ at 0x%x, size = %d" % (address, size))

# Initialize emulator in x86-64 mode
mu = Uc(UC_ARCH_X86, UC_MODE_64)
mu.mem_map(0x1000, 0x4000)

# Load shellcode
shellcode = b"\x48\x31\xc0\x48\x89\xc7\x48\x89\xc6\x48\x89\xc2"
mu.mem_write(0x1000, shellcode)

# Set up stack
mu.reg_write(UC_X86_REG_RSP, 0x3000)

# Add hooks
mu.hook_add(UC_HOOK_CODE, hook_code)
mu.hook_add(UC_HOOK_MEM_READ | UC_HOOK_MEM_WRITE, hook_mem_access)

# Emulate
try:
    mu.emu_start(0x1000, 0x1000 + len(shellcode))
except UcError as e:
    print("Error: %s" % e)</code></pre>
                </div>

                <!-- Valgrind Section -->
                <div id="valgrind" class="blog-content mt-5">
                    <h2><i class="fas fa-memory me-2 text-teal"></i>Valgrind — Memory Debugger</h2>
                    
                    <div class="highlight-box">
                        <i class="fas fa-info-circle me-2"></i>
                        Valgrind is a dynamic analysis framework that runs programs in a virtual CPU. Its <strong>Memcheck</strong> tool detects memory errors, leaks, and undefined behavior at the instruction level.
                    </div>

                    <h3 id="valgrind-memcheck">Memcheck for Assembly</h3>
                    <pre><code class="language-bash"># Install Valgrind
sudo apt install valgrind

# Run program with Memcheck
valgrind --leak-check=full ./my_asm_program

# Track origins of uninitialized values
valgrind --track-origins=yes ./my_asm_program

# Generate detailed suppressions
valgrind --gen-suppressions=all ./my_asm_program

# Check for invalid memory access
valgrind --tool=memcheck --trace-children=yes ./my_program</code></pre>

                    <h3 id="valgrind-assembly">Assembly-Specific Usage</h3>
                    <pre><code class="language-nasm">; Example: Code that Valgrind will catch
section .data
    buffer: times 10 db 0

section .text
global _start
_start:
    ; Valgrind catches: reading uninitialized memory
    mov eax, [buffer + 20]    ; Read beyond allocated buffer!
    
    ; Valgrind catches: memory leak if we exit without freeing
    mov eax, 12               ; sys_brk
    xor ebx, ebx
    int 0x80
    
    ; Exit
    mov eax, 1
    xor ebx, ebx
    int 0x80</code></pre>

                    <div class="highlight-box mt-3">
                        <h5><i class="fas fa-terminal me-2"></i>Save &amp; Compile: <code>valgrind_test.asm</code></h5>
                        <p><span class="badge bg-teal"><i class="fab fa-linux me-1"></i>Linux</span> <small class="text-muted">(32-bit ELF using <code>int 0x80</code>)</small></p>
<pre><code class="language-bash">nasm -f elf32 valgrind_test.asm -o valgrind_test.o
ld -m elf_i386 valgrind_test.o -o valgrind_test
valgrind ./valgrind_test</code></pre>
                        <p><span class="badge bg-navy"><i class="fab fa-apple me-1"></i>macOS</span> <small class="text-muted">(32-bit not supported on modern macOS — use Docker/VM)</small></p>
<pre><code class="language-bash"># macOS dropped 32-bit support in Catalina (10.15)
# Use a Linux Docker container or VM instead</code></pre>
                        <p><span class="badge bg-crimson"><i class="fab fa-windows me-1"></i>Windows</span> <small class="text-muted">(use WSL2 with Linux commands above)</small></p>
<pre><code class="language-bash"># In WSL2:
nasm -f elf32 valgrind_test.asm -o valgrind_test.o
ld -m elf_i386 valgrind_test.o -o valgrind_test</code></pre>
                    </div>

                    <pre><code class="language-bash"># Valgrind output example
==12345== Invalid read of size 4
==12345==    at 0x401000: _start (program.asm:10)
==12345==  Address 0x404014 is 0 bytes after a block of size 10 alloc'd
==12345==    at 0x401000: _start (program.asm:6)

# Other Valgrind tools
valgrind --tool=cachegrind ./program   # Cache profiling
valgrind --tool=callgrind ./program    # Call graph profiling
valgrind --tool=helgrind ./program     # Thread error detection</code></pre>
                </div>

                <!-- DOSBox Section -->
                <div id="dosbox" class="blog-content mt-5">
                    <h2><i class="fas fa-terminal me-2 text-teal"></i>DOSBox — Real-Mode & DOS Emulator</h2>
                    
                    <div class="highlight-box">
                        <i class="fas fa-info-circle me-2"></i>
                        DOSBox emulates an IBM PC compatible machine running DOS. It's perfect for testing <strong>16-bit real-mode assembly</strong>, BIOS interrupts, and legacy DOS programs.
                    </div>

                    <h3 id="dosbox-realmode">Real-Mode Testing</h3>
                    <pre><code class="language-bash"># Install DOSBox
sudo apt install dosbox

# Run DOSBox
dosbox

# Mount directory as C: drive
MOUNT C /path/to/asm/programs
C:

# Assemble and run COM file (NASM in DOSBox or pre-assembled)
program.com</code></pre>

                    <pre><code class="language-nasm">; hello.asm - 16-bit DOS COM program
org 100h

section .text
    mov ah, 09h           ; DOS print string function
    mov dx, message       ; Address of string
    int 21h               ; Call DOS interrupt
    
    mov ax, 4C00h         ; DOS exit function
    int 21h               ; Exit with code 0

section .data
    message db 'Hello from real mode!$'</code></pre>

                    <pre><code class="language-bash"># Assemble for DOS COM format (on Linux)
nasm -f bin hello.asm -o hello.com

# Copy to DOSBox directory and run
# In DOSBox: hello.com</code></pre>

                    <h3 id="dosbox-debug">DOSBox Debug Commands</h3>
                    <p>Use DOSBox-X or DOSBox with debug build for built-in debugger:</p>
                    <pre><code class="language-bash"># DOSBox debugger commands (press Alt+Pause)
bp 0100           # Breakpoint at CS:0100
bpint 21          # Break on INT 21h
r                 # Display registers
d 0100            # Dump memory at offset 0100
u 0100            # Unassemble at offset 0100
t                 # Trace (single step)
p                 # Proceed (step over INT/CALL)
g                 # Go (continue execution)
sm 0100 48        # Set memory byte at 0100 to 0x48
sr ax 1234        # Set AX register to 0x1234
log               # Toggle logging
memdump 0 FFFF    # Dump memory range</code></pre>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-history me-2"></i>
                        <strong>When to use DOSBox:</strong> Learning BIOS interrupts (INT 10h, 13h, 16h), DOS API (INT 21h), real-mode segmentation, or running vintage software and games.
                    </div>
                </div>

                <!-- Simics Section -->
                <div id="simics" class="blog-content mt-5">
                    <h2><i class="fas fa-industry me-2 text-teal"></i>Simics — Enterprise Full-System Simulator</h2>
                    
                    <div class="highlight-box">
                        <i class="fas fa-info-circle me-2"></i>
                        Intel Simics (formerly Wind River Simics) is a commercial full-system simulator used for <strong>enterprise firmware development</strong>, hardware bring-up, and complex system debugging.
                    </div>

                    <h3 id="simics-overview">Overview</h3>
                    <ul>
                        <li><strong>Full-system simulation</strong>: CPU, memory, peripherals, network</li>
                        <li><strong>Deterministic execution</strong>: Exact reproducibility of bugs</li>
                        <li><strong>Reverse debugging</strong>: Step backwards in time</li>
                        <li><strong>Checkpoint/restore</strong>: Save and reload system state</li>
                        <li><strong>Multi-core support</strong>: Simulate complex SoCs</li>
                    </ul>

                    <h3 id="simics-features">Enterprise Features</h3>
                    <pre><code class="language-python"># Simics CLI example (simplified)
# Note: Actual Simics requires commercial license

# Load target configuration
simics> run-command-file targets/x86-simple/x86-simple.simics

# Set breakpoint on memory access
simics> break-mem 0x7c00 -r -w

# Run simulation
simics> run

# Time travel debugging
simics> reverse
simics> backstep

# Create checkpoint
simics> save-persistent-state checkpoint1

# Memory inspection
simics> x 0x7c00 100

# Register inspection
simics> print-cpu-registers</code></pre>

                    <div class="highlight-box highlight-navy">
                        <i class="fas fa-building me-2"></i>
                        <strong>Enterprise Use Cases:</strong> BIOS/UEFI development, device driver testing before hardware exists, security vulnerability research on complex systems, automotive ECU simulation.
                    </div>

                    <p><strong>Alternatives for hobbyists:</strong></p>
                    <ul>
                        <li><strong>Free</strong>: QEMU + GDB provides most debugging features</li>
                        <li><strong>Academic</strong>: gem5 offers similar depth for research</li>
                        <li><strong>Commercial</strong>: Synopsys Virtualizer, Cadence Palladium</li>
                    </ul>
                </div>

                <!-- Decision Matrix -->
                <div id="decision-matrix" class="blog-content mt-5">
                    <h2><i class="fas fa-compass me-2 text-teal"></i>Decision Matrix: Which Tool to Use?</h2>
                    
                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead class="table-dark">
                                <tr>
                                    <th>Scenario</th>
                                    <th>Recommended Tool</th>
                                    <th>Reason</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Writing a bootloader</td>
                                    <td><span class="bias-tag">QEMU</span></td>
                                    <td>Fast iteration, good GDB support</td>
                                </tr>
                                <tr>
                                    <td>Instruction timing issues</td>
                                    <td><span class="bias-tag">Bochs</span></td>
                                    <td>Cycle-accurate emulation</td>
                                </tr>
                                <tr>
                                    <td>Cache behavior analysis</td>
                                    <td><span class="bias-tag">gem5</span></td>
                                    <td>Detailed cache hierarchy simulation</td>
                                </tr>
                                <tr>
                                    <td>Malware analysis</td>
                                    <td><span class="bias-tag">Unicorn</span></td>
                                    <td>Safe isolated execution with hooks</td>
                                </tr>
                                <tr>
                                    <td>Buffer overflow in assembly</td>
                                    <td><span class="bias-tag">Valgrind</span></td>
                                    <td>Catches invalid memory access</td>
                                </tr>
                                <tr>
                                    <td>Learning BIOS interrupts</td>
                                    <td><span class="bias-tag">DOSBox</span></td>
                                    <td>Authentic DOS environment</td>
                                </tr>
                                <tr>
                                    <td>Firmware pre-silicon testing</td>
                                    <td><span class="bias-tag">Simics</span></td>
                                    <td>Full-system simulation with peripherals</td>
                                </tr>
                                <tr>
                                    <td>CTF binary exploitation</td>
                                    <td><span class="bias-tag">Unicorn</span> + <span class="bias-tag">QEMU</span></td>
                                    <td>Combine for ROP gadget analysis</td>
                                </tr>
                                <tr>
                                    <td>OS development with networking</td>
                                    <td><span class="bias-tag">QEMU</span></td>
                                    <td>Easy virtual NIC configuration</td>
                                </tr>
                                <tr>
                                    <td>Verifying CPU flag behavior</td>
                                    <td><span class="bias-tag">Bochs</span></td>
                                    <td>Matches real hardware exactly</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="highlight-box mt-4">
                        <i class="fas fa-lightbulb me-2"></i>
                        <strong>Pro Tip:</strong> Many developers use QEMU for daily development (fast), then validate on Bochs when something doesn't work (accurate). For security research, pair Unicorn with radare2 or Ghidra for comprehensive analysis.
                    </div>
                </div>

                <div class="blog-content mt-5">
                    <div class="related-posts">
                        <h3><i class="fas fa-book-reader me-2"></i>Continue the Series</h3>
                        <div class="related-post-item">
                            <h5 class="mb-2">Part 20: Kernel Assembly Components</h5>
                            <p class="text-muted small mb-2">Write kernel-level assembly code.</p>
                            <a href="asm-part20-kernel.html" class="text-decoration-none">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                        <div class="related-post-item">
                            <h5 class="mb-2">Part 22: Performance & Optimization</h5>
                            <p class="text-muted small mb-2">Profile and optimize assembly code.</p>
                            <a href="asm-part22-optimization.html" class="text-decoration-none">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                        <div class="related-post-item">
                            <h5 class="mb-2">Part 19: Bootloader Development</h5>
                            <p class="text-muted small mb-2">Build bootloaders to test with QEMU.</p>
                            <a href="asm-part19-bootloader.html" class="text-decoration-none">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                    </div>
                </div>

                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="social-media" class="bg-dark text-light py-5">
        <div class="container py-5">
            <div class="row mb-4">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h5 class="fw-bold mb-3">Let's Connect</h5>
                    <p class="text-light">
                        I'm always interested in sharing content about my interests on different topics. Read disclaimer and feel free to share further.
                    </p>
                </div>
                <div class="col-lg-6">
                    <h5 class="fw-bold mb-3">Follow Me</h5>
                    <div class="social-links d-flex gap-2 flex-wrap">
                        <a href="https://www.facebook.com/wasil.zafar/" target="_blank" class="social-icon" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://twitter.com/wasilzafar" target="_blank" class="social-icon" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.linkedin.com/in/wasilzafar" target="_blank" class="social-icon" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a href="https://www.youtube.com/@wasilzafar" target="_blank" class="social-icon" title="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="https://www.instagram.com/itswzee/" target="_blank" class="social-icon" title="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="https://in.pinterest.com/wasilz/" target="_blank" class="social-icon" title="Pinterest"><i class="fab fa-pinterest-p"></i></a>
                        <a href="mailto:wasil.zafar@gmail.com" class="social-icon" title="Email"><i class="fas fa-envelope"></i></a>
                    </div>
                </div>
            </div>
            <hr class="bg-secondary">
            <div class="row mt-4">
                <div class="col-md-6">
                    <p class="small"><i class="fas fa-icons me-2"></i>Icons from <a href="https://www.flaticon.com/" target="_blank" class="text-light">Flaticon</a> &amp; <a href="https://fontawesome.com/" target="_blank" class="text-light">Font Awesome</a></p>
                    <p class="small mt-3">
                        <a href="/" class="text-light text-decoration-none">Home</a> | 
                        <a href="/disclaimer.html" class="text-light text-decoration-none">Disclaimer</a> | 
                        <a href="/privacy-policy.html" class="text-light text-decoration-none">Privacy Policy</a>
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small">Enjoying this content? ☕ <a href="https://buymeacoffee.com/itswzee" target="_blank" class="text-light" style="text-decoration: underline;">Keep me caffeinated</a> to keep the pixels flowing!</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <button id="scrollToTop" class="scroll-to-top"><i class="fas fa-arrow-up"></i></button>
    <div id="categoryIndicator" class="category-indicator"></div>
    <script src="../../../js/cookie-consent.js"></script>
    <script src="../../../js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
</body>
</html>
