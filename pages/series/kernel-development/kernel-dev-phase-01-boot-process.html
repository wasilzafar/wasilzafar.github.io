<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="robots" content="index, archive" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Understand how a computer boots from power-on to kernel execution. Learn CPU reset state, BIOS vs UEFI, and set up your OS development environment with cross-compilers and emulators." />
    <meta name="author" content="Wasil Zafar" />
    <meta name="keywords" content="Boot Process, BIOS, UEFI, CPU Reset, Bootloader, Cross Compiler, QEMU, OS Development, Kernel Development, Systems Programming" />
    <meta property="og:title" content="Kernel Development Series Phase 1: How a Computer Starts" />
    <meta property="og:description" content="Understand how a computer boots from power-on to kernel execution. Learn CPU reset state, BIOS vs UEFI, and set up your development environment." />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2026-02-06" />
    <meta property="article:author" content="Wasil Zafar" />
    <meta property="article:section" content="Technology" />
    
    <title>Kernel Development Series Phase 1: How a Computer Starts - Wasil Zafar</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet" />

    <!-- Custom Styles -->
    <link rel="stylesheet" href="../../../css/main.css" type="text/css" />

    <!-- Prism.js Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" id="prism-theme" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" id="prism-default" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-dark.min.css" id="prism-dark" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-twilight.min.css" id="prism-twilight" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" id="prism-okaidia" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-solarizedlight.min.css" id="prism-solarizedlight" disabled />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css" />

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="../../../images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../images/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../images/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="../../../images/favicon_io/site.webmanifest">

    <!-- Google Consent Mode v2 -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied',
            'region': ['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','HU','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE']
        });
        
        gtag('consent', 'default', {
            'ad_storage': 'granted',
            'ad_user_data': 'granted',
            'ad_personalization': 'granted',
            'analytics_storage': 'granted'
        });
        
        gtag('set', 'url_passthrough', true);
    </script>

    <!-- Google Tag Manager -->
    <script>
        (function(w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-PBS8M2JR');
    </script>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBS8M2JR" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>

    <!-- GDPR Cookie Consent Banner -->
    <div id="cookieBanner" class="light display-bottom" style="display: none;">
        <div id="closeIcon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                <path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"></path>
            </svg>
        </div>
        
        <div class="content-wrap">
            <div class="msg-wrap">
                <div class="title-wrap">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="20" height="20">
                        <path fill="#3B9797" d="M510.52 255.82c-69.97-.85-126.47-57.69-126.47-127.86-70.17 0-127-56.49-127.86-126.45-27.26-4.14-55.13.3-79.72 12.82l-69.13 35.22a132.221 132.221 0 0 0-57.79 57.81l-35.1 68.88a132.645 132.645 0 0 0-12.82 80.95l12.08 76.27a132.521 132.521 0 0 0 37.16 70.37l54.64 54.64a132.036 132.036 0 0 0 70.37 37.16l76.27 12.15c27.51 4.36 55.7-.11 80.95-12.8l68.88-35.08a132.166 132.166 0 0 0 57.79-57.81l35.1-68.88c12.56-24.64 17.01-52.58 12.91-79.91zM176 368c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm32-160c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm160 128c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z"></path>
                    </svg>
                    <h4 style="margin: 0; font-size: 18px; color: var(--color-navy); font-weight: 700;">Cookie Consent</h4>
                </div>
                <p style="font-size: 14px; line-height: 1.6; color: var(--color-navy); margin-bottom: 15px;">
                    We use cookies to enhance your browsing experience, serve personalized content, and analyze our traffic. 
                    By clicking "Accept All", you consent to our use of cookies. See our 
                    <a href="/privacy-policy.html" style="color: var(--color-teal); border-bottom: 1px dotted var(--color-teal);">Privacy Policy</a> 
                    for more information.
                </p>
                
                <div id="cookieSettings" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="14" height="14">
                        <path fill="currentColor" d="M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"></path>
                    </svg>
                    <span style="margin-left: 5px; font-size: 12px; font-weight: 600; color: var(--color-navy);">Customize Settings</span>
                </div>
                
                <div id="cookieTypes" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(59, 151, 151, 0.2);">
                    <h5 style="font-size: 12px; font-weight: 700; color: var(--color-navy); margin-bottom: 10px; text-transform: uppercase;">Cookie Preferences</h5>
                    
                    <div style="margin-bottom: 12px;">
                        <label style="display: flex; align-items: start; cursor: pointer;">
                            <input type="checkbox" checked disabled style="margin-top: 2px; margin-right: 8px; cursor: not-allowed;">
                            <div>
                                <strong style="font-size: 13px; color: var(--color-navy); display: block; margin-bottom: 2px;">Essential Cookies (Required)</strong>
                                <span style="font-size: 12px; color: #666;">Necessary for the website to function properly.</span>
                            </div>
                        </label>
                    </div>
                    
                    <div style="margin-bottom: 12px;">
                        <label style="display: flex; align-items: start; cursor: pointer;">
                            <input type="checkbox" id="analyticsCookies" checked style="margin-top: 2px; margin-right: 8px;">
                            <div>
                                <strong style="font-size: 13px; color: var(--color-navy); display: block; margin-bottom: 2px;">Analytics Cookies</strong>
                                <span style="font-size: 12px; color: #666;">Help us understand how you interact with the website.</span>
                            </div>
                        </label>
                    </div>
                    
                    <div style="margin-bottom: 12px;">
                        <label style="display: flex; align-items: start; cursor: pointer;">
                            <input type="checkbox" id="marketingCookies" style="margin-top: 2px; margin-right: 8px;">
                            <div>
                                <strong style="font-size: 13px; color: var(--color-navy); display: block; margin-bottom: 2px;">Marketing Cookies</strong>
                                <span style="font-size: 12px; color: #666;">Used to deliver relevant advertisements.</span>
                            </div>
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="btn-wrap">
                <button id="cookieAccept" style="background: var(--color-teal); color: white; font-weight: 600;">Accept All</button>
                <button id="cookieReject" style="background: transparent; color: var(--color-navy); border: 2px solid var(--color-teal); font-weight: 600;">Reject All</button>
                <button id="cookieSave" style="background: var(--color-blue); color: white; font-weight: 600; display: none;">Save Preferences</button>
            </div>
        </div>
    </div>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="/">
                <span class="gradient-text">Wasil Zafar</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/#about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/#skills">Skills</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/#certifications">Certifications</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/#interests">Interests</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="blog-hero">
        <div class="container py-5">
            <div class="blog-header">
                <a href="/pages/categories/technology.html" class="back-link">
                    <i class="fas fa-arrow-left me-2"></i>Back to Technology
                </a>
                <h1 class="display-4 fw-bold mb-3">Kernel Development Series Phase 1: How a Computer Starts</h1>
                <div class="blog-meta">
                    <span><i class="fas fa-calendar me-2"></i>February 6, 2026</span>
                    <span><i class="fas fa-user me-2"></i>Wasil Zafar</span>
                    <span class="reading-time"><i class="fas fa-clock me-1"></i>25 min read</span>
                    <button onclick="window.print()" class="print-btn" title="Print this article">
                        <i class="fas fa-print"></i> Print
                    </button>
                </div>
                <p class="lead">Understand how a computer boots from power-on to kernel execution. Learn about CPU reset state, BIOS vs UEFI boot processes, and set up your complete OS development environment with cross-compilers and emulators.</p>
            </div>
        </div>
    </section>

    <!-- Table of Contents Toggle Button -->
    <button class="toc-toggle-btn" onclick="openNav()" title="Table of Contents" aria-label="Open Table of Contents">
        <i class="fas fa-list"></i>
    </button>

    <!-- Side Navigation Overlay -->
    <div id="tocSidenav" class="sidenav-toc">
        <div class="toc-header">
            <h3><i class="fas fa-list me-2"></i>Table of Contents</h3>
            <button class="closebtn" onclick="closeNav()" aria-label="Close Table of Contents">&times;</button>
        </div>
        <ol>
            <li>
                <a href="#introduction" onclick="closeNav()">Introduction</a>
                <ul>
                    <li><a href="#introduction" onclick="closeNav()">The Boot Journey</a></li>
                    <li><a href="#cpu-reset" onclick="closeNav()">CPU Reset State</a></li>
                    <li><a href="#first-instruction" onclick="closeNav()">First Instruction Execution</a></li>
                </ul>
            </li>
            <li>
                <a href="#bios-uefi" onclick="closeNav()">BIOS vs UEFI</a>
                <ul>
                    <li><a href="#bios" onclick="closeNav()">Legacy BIOS</a></li>
                    <li><a href="#uefi" onclick="closeNav()">Modern UEFI</a></li>
                    <li><a href="#comparison" onclick="closeNav()">Comparison & Trade-offs</a></li>
                </ul>
            </li>
            <li>
                <a href="#memory-layout" onclick="closeNav()">Early Memory Layout</a>
                <ul>
                    <li><a href="#memory-map" onclick="closeNav()">Memory Map</a></li>
                    <li><a href="#hardware-init" onclick="closeNav()">Hardware Initialization</a></li>
                    <li><a href="#kernel-loading" onclick="closeNav()">Kernel Loading Sequence</a></li>
                </ul>
            </li>
            <li>
                <a href="#dev-environment" onclick="closeNav()">Development Environment</a>
                <ul>
                    <li><a href="#cross-compiler" onclick="closeNav()">Cross-Compilers</a></li>
                    <li><a href="#emulators" onclick="closeNav()">Emulators (QEMU, Bochs)</a></li>
                    <li><a href="#debuggers" onclick="closeNav()">Debuggers (GDB)</a></li>
                </ul>
            </li>
            <li><a href="#build" onclick="closeNav()">What You Can Build</a></li>
            <li><a href="#next-steps" onclick="closeNav()">Next Steps</a></li>
        </ol>
    </div>

    <!-- Overlay Backdrop -->
    <div id="tocOverlay" class="sidenav-overlay" onclick="closeNav()"></div>

    <!-- Main Content -->
    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">

                <!-- Introduction -->
                <div id="introduction" class="blog-content">
                    <h2><i class="fas fa-power-off me-2 text-teal"></i>Introduction: The Boot Journey</h2>
                    
                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-cogs me-2"></i>
                        <strong>Phase 1 Goals:</strong> By the end of this phase, you'll understand exactly what happens from the moment you press the power button until your kernel starts executing. You'll also have a working development environment ready to build your own OS.
                    </div>
                    
                    <p>You press the power button. A few seconds later, you see a login screen or hear the familiar startup chime. But what actually happens in those crucial seconds? This phase reveals the mystery of the boot process - a carefully orchestrated sequence that transforms dead silicon into a running operating system.</p>

                    <p>Think of booting a computer like waking up in the morning. When you wake up, you don't immediately start solving complex problems. Instead:</p>

                    <div class="experiment-card">
                        <h4><i class="fas fa-bed me-2"></i>The Wake-Up Analogy</h4>
                        <div class="content">
                            <ol>
                                <li><strong>Physical startup</strong> - Eyes open, body initializes (= power on, CPU starts)</li>
                                <li><strong>Basic check</strong> - Am I in my bed? Body feels okay? (= POST self-test)</li>
                                <li><strong>Find instructions</strong> - Check phone for today's schedule (= find bootloader)</li>
                                <li><strong>Load knowledge</strong> - Remember who you are, what you do (= load operating system)</li>
                                <li><strong>Start work</strong> - Go to your job and be productive (= run applications)</li>
                            </ol>
                        </div>
                    </div>

                    <div class="highlight-box">
                        <i class="fas fa-lightbulb"></i>
                        <strong>Key Insight:</strong> The boot process is deterministic and predictable. Every x86 computer follows the same fundamental sequence from power-on to kernel execution. Once you understand this sequence, you control the machine from its very first instruction.
                    </div>

                    <div class="experiment-card">
                        <h4><i class="fas fa-map-signs me-2"></i>Complete Series Navigation</h4>
                        <div class="meta mb-2">
                            <span class="badge bg-teal me-2">18-Part Series</span>
                            <span class="badge bg-crimson">OS Development Mastery</span>
                        </div>
                        <div class="content">
                            <ol>
                                <li><a href="kernel-dev-phase-00-orientation.html">Phase 0: Orientation & Big Picture</a> - OS fundamentals, kernel architectures, learning path</li>
                                <li><strong>Phase 1: How a Computer Starts (This Guide)</strong> - BIOS/UEFI, boot sequence, dev environment</li>
                                <li><a href="kernel-dev-phase-02-real-mode.html">Phase 2: Real Mode - First Steps</a> - Real mode, bootloader, BIOS interrupts</li>
                                <li><a href="kernel-dev-phase-03-protected-mode.html">Phase 3: Entering Protected Mode</a> - GDT, 32-bit mode, C code execution</li>
                                <li><a href="kernel-dev-phase-04-display-input.html">Phase 4: Display, Input & Output</a> - VGA text mode, keyboard handling</li>
                                <li><a href="kernel-dev-phase-05-interrupts.html">Phase 5: Interrupts & CPU Control</a> - IDT, ISRs, PIC programming</li>
                                <li><a href="kernel-dev-phase-06-memory.html">Phase 6: Memory Management</a> - Paging, virtual memory, heap allocator</li>
                                <li><a href="kernel-dev-phase-07-filesystem.html">Phase 7: Disk Access & Filesystems</a> - Block devices, FAT, VFS layer</li>
                                <li><a href="kernel-dev-phase-08-processes.html">Phase 8: Processes & User Mode</a> - Task switching, system calls, user space</li>
                                <li><a href="kernel-dev-phase-09-elf.html">Phase 9: ELF Loading & Executables</a> - ELF format, program loading</li>
                                <li><a href="kernel-dev-phase-10-stdlib-shell.html">Phase 10: Standard Library & Shell</a> - C library, command-line shell</li>
                                <li><a href="kernel-dev-phase-11-long-mode.html">Phase 11: 64-Bit Long Mode</a> - x86-64, 64-bit paging, modern architecture</li>
                                <li><a href="kernel-dev-phase-12-uefi.html">Phase 12: Modern Booting with UEFI</a> - UEFI boot services, memory maps</li>
                                <li><a href="kernel-dev-phase-13-graphics.html">Phase 13: Graphics & GUI Systems</a> - Framebuffer, windowing, drawing</li>
                                <li><a href="kernel-dev-phase-14-input-timing.html">Phase 14: Advanced Input & Timing</a> - Mouse, high-precision timers</li>
                                <li><a href="kernel-dev-phase-15-hardware-drivers.html">Phase 15: Hardware Discovery & Drivers</a> - PCI, device drivers, NVMe</li>
                                <li><a href="kernel-dev-phase-16-performance.html">Phase 16: Performance & Optimization</a> - Caching, scheduler tuning</li>
                                <li><a href="kernel-dev-phase-17-security.html">Phase 17: Stability, Security & Finishing</a> - Debugging, hardening, completion</li>
                            </ol>
                        </div>
                    </div>

                    <h3>The Complete Boot Timeline</h3>

                    <p>Here's what happens in the first seconds after you press power:</p>

<pre><code class="language-plaintext">TIME        EVENT                               DURATION
═════════════════════════════════════════════════════════════════
0.000s      Power button pressed                 -
0.001s      PSU sends "Power Good" signal       ~100ms
0.100s      CPU reset vector executed            -
0.101s      BIOS/UEFI firmware runs             2-5s
            - POST (Power-On Self-Test)
            - Hardware initialization
            - Boot device search
3.000s      Bootloader loaded (512 bytes)       <100ms
3.100s      Bootloader runs
            - Displays boot menu (optional)
            - Loads kernel into memory
            - Prepares CPU mode transition
4.000s      Kernel starts executing             ~500ms
            - Initializes core systems
            - Mounts root filesystem
            - Starts init process
5.000s      Init/systemd runs                   2-10s
            - Starts system services
            - Brings up networking
            - Starts display manager
10.000s     Login screen appears                 -
═════════════════════════════════════════════════════════════════</code></pre>
                </div>

                <!-- CPU Reset Section -->
                <div id="cpu-reset" class="blog-content mt-5">
                    <h2><i class="fas fa-microchip me-2 text-teal"></i>CPU Reset State & First Instruction</h2>
                    
                    <p>When power is applied to an x86 CPU, it enters a predictable <strong>reset state</strong>. Understanding this state is crucial because this is exactly where our kernel development begins.</p>

                    <h3>What Happens at Power On</h3>

                    <p>When power stabilizes, the CPU performs a hardware reset:</p>

<pre><code class="language-plaintext">CPU RESET STATE (x86/x86-64)
════════════════════════════════════════════════════════════════

REGISTERS AFTER RESET:
┌──────────────────────────────────────────────────────────────┐
│  EIP/RIP = 0xFFFFFFF0  (Reset Vector - near top of 4GB)     │
│  CS.base = 0xFFFF0000  (Code Segment base)                  │
│  CS.limit = 0xFFFF     (64KB segment)                       │
│                                                              │
│  EAX = 0x00000000      EFLAGS = 0x00000002 (bit 1 always 1)│
│  EBX = 0x00000000      ESP = 0x00000000                     │
│  ECX = 0x00000000      EBP = 0x00000000                     │
│  EDX = 0x00000600      (CPU identification)                 │
│                                                              │
│  CR0 = 0x60000010      (Protected mode OFF, cache OFF)      │
│  CR2 = 0x00000000      CR3 = 0x00000000                     │
│  CR4 = 0x00000000                                           │
└──────────────────────────────────────────────────────────────┘

MODE: Real Mode (16-bit addressing, 1MB accessible)
═════════════════════════════════════════════════════════════════</code></pre>

                    <div class="highlight-box highlight-navy">
                        <i class="fas fa-university me-2"></i>
                        <strong>Real Mode:</strong> The CPU always starts in "real mode" - a 16-bit operating mode dating back to the original 8086 (1978). In real mode, you can only access the first 1MB of memory, there's no memory protection, and all code runs at the highest privilege level.
                    </div>
                    
                    <h3 id="first-instruction">First Instruction Execution</h3>

                    <p>The magic number is <code>0xFFFFFFF0</code> - the <strong>reset vector</strong>. This address is "wired" to point to firmware (BIOS/UEFI) stored on a ROM chip on your motherboard.</p>

<pre><code class="language-plaintext">MEMORY ADDRESS SPACE AT BOOT
════════════════════════════════════════════════════════════════

     4GB ┌────────────────────────────────┐
         │                                │
         │         (Unmapped)             │
         │                                │
         ├────────────────────────────────┤
0xFFFFFFFF│▓▓▓▓▓ BIOS ROM (mapped) ▓▓▓▓▓▓│← Reset vector
0xFFFF0000│▓▓▓▓▓▓ (64KB - 256KB) ▓▓▓▓▓▓▓│  0xFFFFFFF0
         ├────────────────────────────────┤
         │                                │
         │      (PCI device memory)       │
         │                                │
         ├────────────────────────────────┤
0x100000  │                                │← Extended Memory (above 1MB)
         ├────────────────────────────────┤
0x0FFFFF  │▓▓▓ Upper Memory (384KB) ▓▓▓▓▓│← BIOS, Video RAM, ROM
0x0A0000  ├────────────────────────────────┤
         │▓▓ Conventional Memory (640KB) ▓│← Free for bootloader/OS
0x007C00  │▓▓▓▓ Boot Sector loaded here ▓▓│← BIOS loads boot sector
0x000500  ├────────────────────────────────┤
         │▓▓▓▓ BIOS Data Area ▓▓▓▓▓▓▓▓▓▓▓│
0x000400  ├────────────────────────────────┤
         │▓▓▓ Interrupt Vector Table ▓▓▓▓│← 256 interrupt handlers
     0x0 └────────────────────────────────┘

═════════════════════════════════════════════════════════════════</code></pre>

                    <p>The first instruction the CPU executes is typically a far jump:</p>

<pre><code class="language-nasm">; This is literally the first instruction executed on x86
; Located at physical address 0xFFFFFFF0
jmp 0xF000:0xE05B    ; Jump to BIOS entry point
; The BIOS begins its initialization routine here</code></pre>

                    <div class="experiment-card">
                        <h4><i class="fas fa-flask me-2"></i>Why 0xFFFFFFF0?</h4>
                        <div class="content">
                            <p>You might wonder: "If the CPU is in 16-bit real mode, how can it access address 0xFFFFFFF0 (a 32-bit address)?"</p>
                            <p>The answer is a hardware trick. At reset, the CPU sets a hidden "high address bits" flag that points to the top of the 4GB address space. The first far jump clears this flag and drops the CPU into normal real mode addressing within the first 1MB.</p>
                            <p class="mb-0">This design ensures backward compatibility with the original PC while allowing modern firmware to be larger and more sophisticated.</p>
                        </div>
                    </div>
                </div>

                <!-- BIOS vs UEFI Section -->
                <div id="bios-uefi" class="blog-content mt-5">
                    <h2><i class="fas fa-server me-2 text-teal"></i>BIOS vs UEFI Boot Process</h2>
                    
                    <p>There are two firmware standards for booting x86 computers. Understanding both is essential because your OS may need to support either.</p>

                    <h3 id="bios">Legacy BIOS Boot Process</h3>

                    <p>BIOS (Basic Input/Output System) dates back to the original IBM PC in 1981. Despite its age, it's still widely used and is simpler to develop for.</p>

<pre><code class="language-plaintext">LEGACY BIOS BOOT SEQUENCE
═══════════════════════════════════════════════════════════════

1. POWER-ON SELF-TEST (POST)
   ├─→ Test CPU
   ├─→ Test first 64KB RAM
   ├─→ Initialize chipset
   ├─→ Detect video card, initialize display
   └─→ Beep codes indicate errors

2. HARDWARE DETECTION
   ├─→ Enumerate PCI devices
   ├─→ Detect drives (IDE, SATA)
   ├─→ Initialize USB controllers
   └─→ Build equipment list in BIOS Data Area

3. BOOT DEVICE SEARCH
   ├─→ Check boot order (CMOS settings)
   ├─→ For each device in order:
   │   ├─→ Read first sector (512 bytes)
   │   ├─→ Check for boot signature (0xAA55 at offset 510)
   │   └─→ If found: load to 0x7C00 and execute
   └─→ If no bootable device: display error

4. BOOTLOADER EXECUTION
   └─→ CPU begins executing at 0x0000:0x7C00
       (Your code runs here!)
═══════════════════════════════════════════════════════════════</code></pre>

                    <div class="highlight-box">
                        <i class="fas fa-magic"></i>
                        <strong>The Magic Number 0x7C00:</strong> Why this specific address? IBM engineers chose it in 1981 to leave room for the interrupt vector table (0-0x400) and BIOS data area (0x400-0x500), while providing about 30KB of space before the boot sector for stack and data.
                    </div>

                    <p><strong>BIOS Boot Sector Structure (MBR):</strong></p>

<pre><code class="language-plaintext">MASTER BOOT RECORD (512 bytes)
═══════════════════════════════════════════════════════════════
Offset   Size    Description
──────────────────────────────────────────────────────────────
0x000    446     Bootloader code (your code lives here!)
0x1BE    16      Partition entry #1
0x1CE    16      Partition entry #2
0x1DE    16      Partition entry #3
0x1EE    16      Partition entry #4
0x1FE    2       Boot signature: 0x55, 0xAA
═══════════════════════════════════════════════════════════════</code></pre>

                    <p><strong>BIOS Interrupts:</strong> BIOS provides services via software interrupts. Your bootloader can call these:</p>

<pre><code class="language-nasm">; Example: Print character using BIOS interrupt
mov ah, 0x0E        ; BIOS teletype function
mov al, 'H'         ; Character to print
int 0x10            ; Call BIOS video interrupt

; Example: Read sector from disk
mov ah, 0x02        ; BIOS read sectors function
mov al, 1           ; Number of sectors to read
mov ch, 0           ; Cylinder number
mov cl, 2           ; Sector number (starts at 1)
mov dh, 0           ; Head number
mov dl, 0x80        ; Drive number (0x80 = first hard disk)
mov bx, 0x1000      ; Destination: ES:BX
int 0x13            ; Call BIOS disk interrupt</code></pre>
                    
                    <h3 id="uefi">Modern UEFI Boot Process</h3>

                    <p>UEFI (Unified Extensible Firmware Interface) is the modern replacement for BIOS, developed primarily by Intel starting in the late 1990s.</p>

<pre><code class="language-plaintext">UEFI BOOT SEQUENCE
═══════════════════════════════════════════════════════════════

1. SEC (Security Phase)
   └─→ Minimal code, verifies integrity of firmware

2. PEI (Pre-EFI Initialization)
   ├─→ Initialize CPU
   ├─→ Initialize memory controller
   ├─→ Discover and initialize chipset
   └─→ Create HOBs (Hand-Off Blocks) for DXE

3. DXE (Driver Execution Environment)
   ├─→ Load and execute EFI drivers
   ├─→ Initialize all hardware
   ├─→ Build system tables (ACPI, SMBIOS)
   └─→ Establish UEFI services (boot/runtime)

4. BDS (Boot Device Selection)
   ├─→ Load EFI boot manager
   ├─→ Process boot options
   ├─→ Find EFI System Partition (ESP)
   │   └─→ Usually /EFI/BOOT/BOOTX64.EFI
   └─→ Load and execute EFI application (bootloader/kernel)

5. TSL (Transient System Load)
   └─→ Call ExitBootServices()
       └─→ UEFI hands control to OS, becomes runtime-only
═══════════════════════════════════════════════════════════════</code></pre>

                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="highlight-box highlight-navy">
                                <h5><i class="fas fa-folder me-2"></i>EFI System Partition (ESP)</h5>
                                <p class="mb-2">UEFI uses a dedicated FAT32 partition to store bootloaders:</p>
<pre class="mb-0"><code class="language-plaintext">/ESP
├── /EFI
│   ├── /BOOT
│   │   └── BOOTX64.EFI  (fallback)
│   ├── /Microsoft
│   │   └── /Boot
│   │       └── bootmgfw.efi
│   └── /ubuntu
│       └── grubx64.efi</code></pre>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="highlight-box highlight-navy">
                                <h5><i class="fas fa-code me-2"></i>UEFI Application (PE/COFF)</h5>
                                <p class="mb-2">UEFI bootloaders are PE executables:</p>
<pre class="mb-0"><code class="language-c">// Minimal UEFI application
#include &lt;efi.h&gt;
#include &lt;efilib.h&gt;

EFI_STATUS
EFIAPI
efi_main (EFI_HANDLE img,
          EFI_SYSTEM_TABLE *st)
{
    st->ConOut->OutputString(
        st->ConOut, L"Hello UEFI!\r\n");
    return EFI_SUCCESS;
}</code></pre>
                            </div>
                        </div>
                    </div>
                    
                    <h3 id="comparison">Comparison & Trade-offs</h3>

                    <table class="table table-bordered mt-4">
                        <thead class="table-dark">
                            <tr>
                                <th>Feature</th>
                                <th>Legacy BIOS</th>
                                <th>UEFI</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Boot Mode</strong></td>
                                <td>16-bit Real Mode</td>
                                <td>32-bit or 64-bit</td>
                            </tr>
                            <tr>
                                <td><strong>Bootloader Size</strong></td>
                                <td>446 bytes (MBR)</td>
                                <td>Effectively unlimited</td>
                            </tr>
                            <tr>
                                <td><strong>Partition Scheme</strong></td>
                                <td>MBR (4 partitions, 2TB max)</td>
                                <td>GPT (128+ partitions, 9ZB max)</td>
                            </tr>
                            <tr>
                                <td><strong>Memory Access</strong></td>
                                <td>1MB directly</td>
                                <td>Full RAM</td>
                            </tr>
                            <tr>
                                <td><strong>Graphics Support</strong></td>
                                <td>VGA text/graphics</td>
                                <td>GOP (native framebuffer)</td>
                            </tr>
                            <tr>
                                <td><strong>Network Boot</strong></td>
                                <td>PXE (limited)</td>
                                <td>Native HTTP/PXE</td>
                            </tr>
                            <tr>
                                <td><strong>Security</strong></td>
                                <td>None built-in</td>
                                <td>Secure Boot</td>
                            </tr>
                            <tr>
                                <td><strong>Complexity</strong></td>
                                <td>Simple, well-documented</td>
                                <td>Complex, extensive spec</td>
                            </tr>
                            <tr>
                                <td><strong>Best For Learning</strong></td>
                                <td>✓ Recommended start</td>
                                <td>Phase 12 of this series</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="highlight-box">
                        <i class="fas fa-road me-2"></i>
                        <strong>Our Approach:</strong> We'll start with BIOS boot (Phases 2-10) because it's simpler and teaches fundamental concepts. In Phase 12, we'll implement UEFI boot for modern systems. Many real-world bootloaders (like GRUB) support both.
                    </div>
                </div>

                <!-- Memory Layout Section -->
                <div id="memory-layout" class="blog-content mt-5">
                    <h2><i class="fas fa-memory me-2 text-teal"></i>Early Memory Layout</h2>
                    
                    <h3 id="memory-map">Memory Map at Boot Time</h3>

                    <p>When BIOS loads your bootloader, memory is in a specific state. Understanding this layout is critical for writing working boot code:</p>

<pre><code class="language-plaintext">REAL MODE MEMORY MAP (First 1MB)
═══════════════════════════════════════════════════════════════

        ┌────────────────────────────────────────┐
0x100000│ Extended Memory (requires mode switch) │← We'll use this later
        ├────────────────────────────────────────┤
0x0FFFFF│                                        │
        │    HIGH MEMORY AREA (HMA)              │
        │    (accessible with A20 gate enabled)  │
0x0FFFF0├────────────────────────────────────────┤
        │                                        │
        │    BIOS ROM Shadow (usually)           │
        │                                        │
0x0F0000├────────────────────────────────────────┤
        │                                        │
        │    Device ROMs (Video BIOS, etc.)      │
        │                                        │
0x0C8000├────────────────────────────────────────┤
        │    Video BIOS                          │
0x0C0000├────────────────────────────────────────┤
        │                                        │
        │    VIDEO MEMORY                        │
        │    B8000-BFFFF: Text mode              │← Write here to display text!
        │    A0000-AFFFF: Graphics mode          │
        │                                        │
0x0A0000├────────────────────────────────────────┤
        │                                        │
        │                                        │
        │    FREE CONVENTIONAL MEMORY            │
        │    (Approximately 638KB)               │← Load kernel here
        │                                        │
        │                                        │
0x007E00├────────────────────────────────────────┤
        │    YOUR BOOT SECTOR (512 bytes)        │← BIOS loads you here
0x007C00├────────────────────────────────────────┤
        │    Usually free for stack              │
0x000500├────────────────────────────────────────┤
        │    BIOS Data Area (256 bytes)          │← System info, do not overwrite!
0x000400├────────────────────────────────────────┤
        │    Interrupt Vector Table (1KB)        │← 256 interrupt handlers
0x000000└────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════</code></pre>
                    
                    <h3 id="hardware-init">Hardware Initialization by BIOS</h3>

                    <p>Before your code runs, BIOS has already initialized essential hardware:</p>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="experiment-card">
                                <h5><i class="fas fa-check-circle me-2 text-teal"></i>Already Initialized</h5>
                                <div class="content">
                                    <ul class="mb-0">
                                        <li>CPU and basic chipset</li>
                                        <li>RAM (memory controller configured)</li>
                                        <li>Interrupt controller (8259 PIC)</li>
                                        <li>Keyboard controller (8042)</li>
                                        <li>Basic video (VGA text mode)</li>
                                        <li>Timer (8253/8254 PIT)</li>
                                        <li>Real-time clock (RTC)</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="experiment-card">
                                <h5><i class="fas fa-exclamation-circle me-2 text-crimson"></i>Your Responsibility</h5>
                                <div class="content">
                                    <ul class="mb-0">
                                        <li>Enable A20 line (for >1MB access)</li>
                                        <li>Set up GDT (for protected mode)</li>
                                        <li>Switch CPU modes</li>
                                        <li>Initialize your own IDT</li>
                                        <li>Set up paging</li>
                                        <li>Initialize additional devices</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <h3 id="kernel-loading">Kernel Loading Sequence</h3>

                    <p>A typical boot sequence for a BIOS-based bootloader:</p>

<pre><code class="language-nasm">; TYPICAL BIOS BOOT SEQUENCE
; ══════════════════════════════════════════════════════════════

; Stage 1: Boot Sector (first 512 bytes)
; ────────────────────────────────────────
boot_sector_start:
    ; 1. Set up segments and stack
    xor ax, ax
    mov ds, ax
    mov es, ax
    mov ss, ax
    mov sp, 0x7C00      ; Stack grows down from boot sector

    ; 2. Display loading message
    mov si, msg_loading
    call print_string

    ; 3. Load more sectors from disk (Stage 2)
    mov ah, 0x02        ; BIOS read sectors
    mov al, 10          ; Read 10 sectors
    mov ch, 0           ; Cylinder 0
    mov cl, 2           ; Start from sector 2
    mov dh, 0           ; Head 0
    mov bx, 0x1000      ; Load to 0x0000:0x1000
    int 0x13
    jc disk_error

    ; 4. Jump to Stage 2
    jmp 0x0000:0x1000

; Stage 2: Extended Bootloader
; ────────────────────────────────────────
stage2_start:
    ; 5. Enable A20 line
    call enable_a20

    ; 6. Load GDT
    lgdt [gdt_descriptor]

    ; 7. Switch to Protected Mode
    mov eax, cr0
    or eax, 1
    mov cr0, eax

    ; 8. Far jump to 32-bit code
    jmp 0x08:protected_mode_start

[BITS 32]
protected_mode_start:
    ; 9. Set up 32-bit segments
    mov ax, 0x10
    mov ds, ax
    mov es, ax
    mov ss, ax
    mov esp, 0x90000    ; New stack in extended memory

    ; 10. Load kernel from disk (using our own driver now)
    call load_kernel

    ; 11. Jump to kernel entry point
    jmp KERNEL_ENTRY_POINT</code></pre>

                    <div class="highlight-box highlight-navy">
                        <i class="fas fa-graduation-cap me-2"></i>
                        <strong>We'll Implement This:</strong> Don't worry if this looks complex. In Phase 2 and 3, we'll write this code step by step, explaining every instruction. You'll understand exactly why each line is necessary.
                    </div>
                </div>

                <!-- Dev Environment Section -->
                <div id="dev-environment" class="blog-content mt-5">
                    <h2><i class="fas fa-tools me-2 text-teal"></i>Setting Up Your Development Environment</h2>
                    
                    <p>Before writing any OS code, you need the right tools. Operating system development has three special requirements:</p>

                    <ol>
                        <li><strong>Cross-compiler</strong> - A compiler that generates code for a different target</li>
                        <li><strong>Emulator</strong> - Run your OS without rebooting real hardware</li>
                        <li><strong>Debugger</strong> - Step through code instruction by instruction</li>
                    </ol>

                    <h3 id="cross-compiler">Cross-Compilers: Building for Bare Metal</h3>

                    <p>Your normal compiler (like <code>gcc</code> on Linux) produces executables for your host OS. But your kernel IS the OS - it can't depend on Linux libraries or system calls. You need a <strong>cross-compiler</strong> that targets "bare metal" x86.</p>

                    <div class="highlight-box">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Why Not Use System GCC?</strong> Your system's GCC is configured to link against libc, use your OS's calling conventions, and may add extra code (like stack protectors) that won't work without an OS. A cross-compiler avoids all these problems.
                    </div>

                    <p><strong>Building a GCC Cross-Compiler:</strong></p>

<pre><code class="language-bash"># Prerequisites (Ubuntu/Debian)
sudo apt update
sudo apt install build-essential bison flex libgmp3-dev libmpc-dev \
                 libmpfr-dev texinfo wget

# Create working directory
export PREFIX="$HOME/opt/cross"
export TARGET=i686-elf
export PATH="$PREFIX/bin:$PATH"
mkdir -p $HOME/src && cd $HOME/src

# Download sources
wget https://ftp.gnu.org/gnu/binutils/binutils-2.41.tar.xz
wget https://ftp.gnu.org/gnu/gcc/gcc-13.2.0/gcc-13.2.0.tar.xz
tar xf binutils-2.41.tar.xz
tar xf gcc-13.2.0.tar.xz

# Build Binutils
mkdir build-binutils && cd build-binutils
../binutils-2.41/configure --target=$TARGET --prefix="$PREFIX" \
    --with-sysroot --disable-nls --disable-werror
make -j$(nproc)
make install
cd ..

# Build GCC
mkdir build-gcc && cd build-gcc
../gcc-13.2.0/configure --target=$TARGET --prefix="$PREFIX" \
    --disable-nls --enable-languages=c,c++ --without-headers
make -j$(nproc) all-gcc all-target-libgcc
make install-gcc install-target-libgcc
cd ..

# Verify installation
i686-elf-gcc --version
# Should output: i686-elf-gcc (GCC) 13.2.0</code></pre>

                    <div class="experiment-card">
                        <h4><i class="fab fa-windows me-2"></i>Windows Users: WSL2 Recommended</h4>
                        <div class="content">
                            <p>The easiest way to develop on Windows is using WSL2 (Windows Subsystem for Linux):</p>
<pre><code class="language-bash"># Install WSL2 with Ubuntu (PowerShell as Admin)
wsl --install -d Ubuntu

# After restart, open Ubuntu and follow Linux instructions above</code></pre>
                            <p class="mb-0">Alternatively, use a pre-built cross-compiler from the <a href="https://wiki.osdev.org/GCC_Cross-Compiler" target="_blank">OSDev Wiki</a>.</p>
                        </div>
                    </div>
                    
                    <h3 id="emulators">Emulators (QEMU, Bochs)</h3>

                    <p>Testing an OS on real hardware requires rebooting, which takes time and risks corrupting your development machine. Emulators solve this by running a virtual PC inside your operating system.</p>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="experiment-card">
                                <h5><i class="fas fa-rocket me-2 text-teal"></i>QEMU (Recommended)</h5>
                                <div class="content">
                                    <p><strong>Pros:</strong> Fast, accurate, great GDB integration, supports many architectures</p>
                                    <p><strong>Cons:</strong> Errors can be cryptic</p>
<pre><code class="language-bash"># Install on Ubuntu/Debian
sudo apt install qemu-system-x86

# Run your OS image
qemu-system-i386 -fda myos.img

# With debugging enabled
qemu-system-i386 -fda myos.img \
    -s -S    # -s = GDB on port 1234
             # -S = freeze at startup</code></pre>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="experiment-card">
                                <h5><i class="fas fa-bug me-2 text-blue"></i>Bochs</h5>
                                <div class="content">
                                    <p><strong>Pros:</strong> Built-in debugger, very detailed logging, catches subtle bugs</p>
                                    <p><strong>Cons:</strong> Slower than QEMU</p>
<pre><code class="language-bash"># Install on Ubuntu/Debian
sudo apt install bochs bochs-x

# Bochs requires a config file (bochsrc.txt)
# Example config:
megs: 32
romimage: file=/usr/share/bochs/BIOS-bochs-latest
vgaromimage: file=/usr/share/bochs/VGABIOS-lgpl-latest
floppya: 1_44=myos.img, status=inserted
boot: floppy</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <h3 id="debuggers">Debuggers (GDB)</h3>

                    <p>When your kernel triple-faults and the screen goes blank, you need a debugger. GDB can connect to QEMU and let you step through your kernel instruction by instruction.</p>

<pre><code class="language-bash"># Terminal 1: Start QEMU with debugging
qemu-system-i386 -fda myos.img -s -S

# Terminal 2: Connect GDB
gdb
(gdb) target remote localhost:1234
(gdb) symbol-file kernel.elf          # Load debug symbols
(gdb) break kmain                      # Set breakpoint at kernel entry
(gdb) continue                         # Start execution
(gdb) layout asm                       # Show assembly view
(gdb) stepi                            # Step one instruction
(gdb) info registers                   # View all registers
(gdb) x/20x 0x7C00                    # Examine memory</code></pre>

                    <div class="highlight-box highlight-crimson">
                        <i class="fas fa-heart me-2"></i>
                        <strong>Essential GDB Commands for OS Development:</strong>
                        <ul class="mb-0 mt-2">
                            <li><code>target remote localhost:1234</code> - Connect to QEMU</li>
                            <li><code>set architecture i386</code> - Tell GDB we're in 32-bit mode</li>
                            <li><code>stepi</code> / <code>nexti</code> - Step one instruction</li>
                            <li><code>x/10i $eip</code> - Disassemble next 10 instructions</li>
                            <li><code>info registers</code> - Show all register values</li>
                            <li><code>watch *0xB8000</code> - Break when video memory changes</li>
                        </ul>
                    </div>

                    <h3>Complete Environment Installation Script</h3>

                    <p>Here's a script that sets up everything on Ubuntu/Debian:</p>

<pre><code class="language-bash">#!/bin/bash
# setup-osdev.sh - Complete OS Development Environment Setup

set -e  # Exit on error

echo "=== Installing OS Development Tools ==="

# Install packages
sudo apt update
sudo apt install -y \
    build-essential \
    nasm \
    qemu-system-x86 \
    gdb \
    xorriso \
    mtools \
    grub-pc-bin \
    grub-common

# Create project structure
mkdir -p ~/osdev/{src,build,iso}
cd ~/osdev

# Create a simple Makefile template
cat > Makefile << 'EOF'
ASM=nasm
CC=i686-elf-gcc
LD=i686-elf-ld

ASMFLAGS=-f elf32
CFLAGS=-ffreestanding -nostdlib -nostdinc -fno-builtin -fno-stack-protector -m32

all: myos.img

boot.o: src/boot.asm
	$(ASM) -f bin src/boot.asm -o build/boot.bin

kernel.o: src/kernel.c
	$(CC) $(CFLAGS) -c src/kernel.c -o build/kernel.o

myos.img: boot.o kernel.o
	# Create simple bootable image
	cat build/boot.bin build/kernel.o > build/myos.img
	# Pad to floppy size
	truncate -s 1440K build/myos.img

run: myos.img
	qemu-system-i386 -fda build/myos.img

debug: myos.img
	qemu-system-i386 -fda build/myos.img -s -S &
	gdb -ex "target remote localhost:1234"

clean:
	rm -rf build/*
EOF

echo "=== Setup Complete ==="
echo "Project directory: ~/osdev"
echo "Next: Build the cross-compiler (see instructions above)"
echo "Then: Run 'make' to build and 'make run' to test"</code></pre>
                </div>

                <!-- What You Can Build Section -->
                <div id="build" class="blog-content mt-5">
                    <h2><i class="fas fa-hammer me-2 text-teal"></i>Exercises & What You Can Build</h2>
                    
                    <div class="experiment-card">
                        <div class="meta mb-2">
                            <span class="badge bg-teal text-white">Hands-On Project</span>
                        </div>
                        <h4>Phase 1 Deliverables</h4>
                        <ul>
                            <li>A working OS development environment (cross-compiler + QEMU + GDB)</li>
                            <li>Understanding of the complete boot flow from power-on to kernel</li>
                            <li>Knowledge of BIOS vs UEFI differences</li>
                            <li>Debugging skills for code that runs before an OS exists</li>
                        </ul>
                    </div>

                    <div class="experiment-card">
                        <h4><i class="fas fa-pencil-alt me-2"></i>Exercise 1: Environment Verification</h4>
                        <div class="content">
                            <p>Verify your setup by creating this test:</p>
<pre><code class="language-nasm">; test.asm - Minimal boot sector that displays 'X'
[BITS 16]
[ORG 0x7C00]

start:
    mov ah, 0x0E    ; BIOS teletype
    mov al, 'X'     ; Character to print
    int 0x10        ; Call BIOS

    jmp $           ; Infinite loop

times 510-($-$$) db 0   ; Pad to 510 bytes
dw 0xAA55               ; Boot signature</code></pre>
<pre><code class="language-bash"># Assemble and run
nasm -f bin test.asm -o test.img
qemu-system-i386 -fda test.img
# You should see 'X' in the top-left corner!</code></pre>
                        </div>
                    </div>

                    <div class="experiment-card">
                        <h4><i class="fas fa-pencil-alt me-2"></i>Exercise 2: Explore BIOS Data Area</h4>
                        <div class="content">
                            <p>Modify the test to read and display information from the BIOS Data Area:</p>
<pre><code class="language-nasm">; Read equipment word from BDA
mov ax, 0x0040      ; BDA segment
mov ds, ax
mov ax, [0x0010]    ; Equipment word at 0040:0010
; Bits 0-1: Number of floppy drives
; Bit 2: Pointing device installed
; Bits 4-5: Initial video mode
; etc.</code></pre>
                            <p class="mb-0"><strong>Challenge:</strong> Display the number of floppy drives and video mode from the BDA.</p>
                        </div>
                    </div>

                    <div class="experiment-card">
                        <h4><i class="fas fa-pencil-alt me-2"></i>Exercise 3: GDB Practice</h4>
                        <div class="content">
                            <p>Using the test boot sector, practice with GDB:</p>
                            <ol class="mb-0">
                                <li>Set a breakpoint at 0x7C00 and verify execution starts there</li>
                                <li>Single-step through each instruction</li>
                                <li>Examine the registers before and after the BIOS interrupt</li>
                                <li>Look at video memory (0xB8000) to see the 'X' character</li>
                            </ol>
<pre><code class="language-bash">(gdb) target remote localhost:1234
(gdb) break *0x7C00
(gdb) continue
(gdb) x/5i $pc          # Show next 5 instructions
(gdb) stepi              # Execute one instruction
(gdb) x/2b 0xB8000      # Look at video memory ('X' = 0x58)</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Next Steps Section -->
                <div id="next-steps" class="blog-content mt-5">
                    <h2><i class="fas fa-arrow-right me-2 text-teal"></i>Next Steps</h2>
                    
                    <p>You now understand:</p>
                    <ul>
                        <li>The complete boot sequence from power button to kernel</li>
                        <li>CPU reset state and where execution begins</li>
                        <li>BIOS vs UEFI boot processes and their trade-offs</li>
                        <li>Real mode memory layout and the 0x7C00 convention</li>
                        <li>How to set up a complete OS development environment</li>
                    </ul>

                    <div class="highlight-box highlight-navy">
                        <i class="fas fa-forward me-2"></i>
                        <strong>Coming Up in Phase 2:</strong> We'll write our first real bootloader! You'll learn real mode programming, 16-bit assembly, BIOS interrupts for screen and disk I/O, and how to load additional code beyond the 512-byte boot sector limit. By the end, you'll have a working bootloader that displays a message and loads a second-stage loader.
                    </div>

                    <!-- Related Posts -->
                    <div class="related-posts">
                        <h3><i class="fas fa-book-reader me-2"></i>Continue the Series</h3>
                        <div class="related-post-item">
                            <h5 class="mb-2">Phase 0: Orientation & Big Picture</h5>
                            <p class="text-muted small mb-2">Review the fundamentals of operating systems, kernel architectures, and the complete series learning path.</p>
                            <a href="kernel-dev-phase-00-orientation.html" class="text-decoration-none">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                        <div class="related-post-item">
                            <h5 class="mb-2">Phase 2: Real Mode - First Steps Near Hardware</h5>
                            <p class="text-muted small mb-2">Write your first bootloader, understand real mode memory addressing, and interact with BIOS interrupts.</p>
                            <a href="kernel-dev-phase-02-real-mode.html" class="text-decoration-none">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                        <div class="related-post-item">
                            <h5 class="mb-2">Phase 3: Entering Protected Mode</h5>
                            <p class="text-muted small mb-2">Transition to 32-bit protected mode, set up the GDT, and start running C code in your kernel.</p>
                            <a href="kernel-dev-phase-03-protected-mode.html" class="text-decoration-none">Read Article <i class="fas fa-arrow-right ms-1"></i></a>
                        </div>
                    </div>
                </div>

                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="social-media" class="bg-dark text-light py-5">
        <div class="container py-5">
            <div class="row mb-4">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h5 class="fw-bold mb-3">Let's Connect</h5>
                    <p class="text-light">
                        I'm always interested in sharing content about my interests on different topics. Read disclaimer and feel free to share further.
                    </p>
                </div>
                <div class="col-lg-6">
                    <h5 class="fw-bold mb-3">Follow Me</h5>
                    <div class="social-links d-flex gap-2 flex-wrap">
                        <a href="https://www.facebook.com/wasil.zafar/" target="_blank" class="social-icon" title="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://twitter.com/wasilzafar" target="_blank" class="social-icon" title="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://www.linkedin.com/in/wasilzafar" target="_blank" class="social-icon" title="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://www.youtube.com/@wasilzafar" target="_blank" class="social-icon" title="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="https://www.instagram.com/itswzee/" target="_blank" class="social-icon" title="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://in.pinterest.com/wasilz/" target="_blank" class="social-icon" title="Pinterest">
                            <i class="fab fa-pinterest-p"></i>
                        </a>
                        <a href="mailto:wasil.zafar@gmail.com" class="social-icon" title="Email">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>

            <hr class="bg-secondary">

            <div class="row mt-4">
                <div class="col-md-6">
                    <p class="small">
                        <i class="fas fa-icons me-2"></i>Icons from <a href="https://www.flaticon.com/" target="_blank" class="text-light">Flaticon</a> &amp; <a href="https://fontawesome.com/" target="_blank" class="text-light">Font Awesome</a>
                    </p>
                    <p class="small mt-3">
                        <a href="/" class="text-light text-decoration-none">Home</a> | 
                        <a href="/disclaimer.html" class="text-light text-decoration-none">Disclaimer</a> | 
                        <a href="/privacy-policy.html" class="text-light text-decoration-none">Privacy Policy</a>
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small">
                        Enjoying this content? ☕ <a href="https://buymeacoffee.com/itswzee" target="_blank" class="text-light" style="text-decoration: underline;">Keep me caffeinated</a> to keep the pixels flowing!
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Scroll-to-Top Button -->
    <button id="scrollToTop" class="scroll-to-top" title="Back to Top">
        <i class="fas fa-arrow-up"></i>
    </button>
    <!-- Category Indicator -->
    <div id="categoryIndicator" class="category-indicator" title="Current Section">
        <i class="fas fa-tag"></i><span id="categoryText">Technology</span>
    </div>
    
    <!-- Cookie Consent JS -->
    <script src="../../../js/cookie-consent.js"></script>
    
    <!-- Main JS -->
    <script src="../../../js/main.js"></script>

    <!-- Prism.js Syntax Highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-nasm.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
</body>
</html>
